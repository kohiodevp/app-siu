import{a as Et,b as Dt}from"./chunk-RHXYTOW7.js";import{a as Ft,b as kt,c as Tt,d as zt,e as Rt,f as At,g as Gt,h as Lt,i as Nt,j as Vt,l as Ht}from"./chunk-SFZAX3ZK.js";import{a as Bt}from"./chunk-Q6MIBXXU.js";import{i as Ot}from"./chunk-474YFGF3.js";import{b as wt,f as It}from"./chunk-QVMFGACW.js";import{c as mt}from"./chunk-JBX6OC6U.js";import{a as dt}from"./chunk-V6MGZ35S.js";import{j as ue}from"./chunk-DEKAXLAX.js";import"./chunk-MXRZJWAE.js";import"./chunk-3FMCGYQ4.js";import{a as Pt}from"./chunk-ISPOGFK5.js";import{a as St}from"./chunk-NQ5JYPMZ.js";import{a as bt,b as Mt}from"./chunk-FJY5KO7T.js";import{b as yt,e as xt,f as Ct}from"./chunk-L64YGAYQ.js";import{a as Ze,b as We,c as Xe,d as Ye,f as et,h as tt}from"./chunk-HFRGPHGK.js";import{e as Je,t as Ke}from"./chunk-M2VBT7VT.js";import{a as fe,b as he}from"./chunk-STMJJCCP.js";import{$ as vt,A as lt,C as pt,Q as ct,T as ut,V as ft,W as ht,X as _t,Y as gt,a as Ue,b as me,e as it,g as nt,k as rt,m as ot,n as at,z as st}from"./chunk-ZNVG5ZVS.js";import{c as je}from"./chunk-LMV7XNWS.js";import"./chunk-FBCHPQNP.js";import{i as be,p as qe}from"./chunk-YGREV7VD.js";import{$ as ze,$b as J,Aa as W,Ac as Ce,Ba as X,Bb as ee,Cb as h,Db as _,Ec as ce,Fb as se,Gb as N,Hb as V,Ib as m,Ic as Qe,Jb as a,Kb as s,Lb as A,Mc as de,Pb as H,Q as L,Qb as B,Qc as U,R as ke,Rb as D,Rc as $e,S as T,Sb as j,Wb as x,Xa as l,Y as Te,Yb as d,Z as oe,Zb as te,_b as ie,a as Ee,ac as le,ba as u,bc as b,cb as q,cc as M,e as re,eb as Ge,ga as g,gc as I,ha as v,hb as Le,hc as K,ic as F,jc as pe,kc as p,l as De,lb as z,lc as O,mb as ae,mc as S,nb as R,nc as Ve,oa as $,p as Fe,pa as Re,qb as Y,rb as P,rc as He,sa as y,sb as Ne,sc as xe,uc as ne,vc as Be,xa as Ae,ya as ye}from"./chunk-E7AQ6X4Y.js";import{f as k}from"./chunk-EQDQRRRY.js";var Yt=["*"];function ei(i,n){i&1&&ie(0)}var Me=(()=>{class i{_elementRef=u(W);constructor(){}focus(){this._elementRef.nativeElement.focus()}static \u0275fac=function(t){return new(t||i)};static \u0275dir=R({type:i,selectors:[["","cdkStepHeader",""]],hostAttrs:["role","tab"]})}return i})(),Se=(()=>{class i{template=u(q);constructor(){}static \u0275fac=function(t){return new(t||i)};static \u0275dir=R({type:i,selectors:[["","cdkStepLabel",""]]})}return i})();var Q={NUMBER:"number",EDIT:"edit",DONE:"done",ERROR:"error"},ti=new ze("STEPPER_GLOBAL_OPTIONS"),_e=(()=>{class i{_stepperOptions;_stepper=u(ge);_displayDefaultIndicatorType;stepLabel;_childForms;content;stepControl;get interacted(){return this._interacted()}set interacted(e){this._interacted.set(e)}_interacted=y(!1);interactedStream=new $;label;errorMessage;ariaLabel;ariaLabelledby;get state(){return this._state()}set state(e){this._state.set(e)}_state=y(void 0);get editable(){return this._editable()}set editable(e){this._editable.set(e)}_editable=y(!0);optional=!1;get completed(){let e=this._completedOverride(),t=this._interacted();return e??(t&&(!this.stepControl||this.stepControl.valid))}set completed(e){this._completedOverride.set(e)}_completedOverride=y(null);index=y(-1);isSelected=ce(()=>this._stepper.selectedIndex===this.index());indicatorType=ce(()=>{let e=this.isSelected(),t=this.completed,r=this._state()??Q.NUMBER,o=this._editable();return this._showError()&&this.hasError&&!e?Q.ERROR:this._displayDefaultIndicatorType?!t||e?Q.NUMBER:o?Q.EDIT:Q.DONE:t&&!e?Q.DONE:t&&e?r:o&&e?Q.EDIT:r});isNavigable=ce(()=>{let e=this.isSelected();return this.completed||e||!this._stepper.linear});get hasError(){let e=this._customError();return e??this._getDefaultError()}set hasError(e){this._customError.set(e)}_customError=y(null);_getDefaultError(){return this.interacted&&!!this.stepControl?.invalid}constructor(){let e=u(ti,{optional:!0});this._stepperOptions=e||{},this._displayDefaultIndicatorType=this._stepperOptions.displayDefaultIndicatorType!==!1}select(){this._stepper.selected=this}reset(){this._interacted.set(!1),this._completedOverride()!=null&&this._completedOverride.set(!1),this._customError()!=null&&this._customError.set(!1),this.stepControl&&(this._childForms?.forEach(e=>e.resetForm?.()),this.stepControl.reset())}ngOnChanges(){this._stepper._stateChanged()}_markAsInteracted(){this._interacted()||(this._interacted.set(!0),this.interactedStream.emit(this))}_showError(){return this._stepperOptions.showError??this._customError()!=null}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=z({type:i,selectors:[["cdk-step"]],contentQueries:function(t,r,o){if(t&1&&J(o,Se,5)(o,Je,5),t&2){let c;b(c=M())&&(r.stepLabel=c.first),b(c=M())&&(r._childForms=c)}},viewQuery:function(t,r){if(t&1&&le(q,7),t&2){let o;b(o=M())&&(r.content=o.first)}},inputs:{stepControl:"stepControl",label:"label",errorMessage:"errorMessage",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],state:"state",editable:[2,"editable","editable",U],optional:[2,"optional","optional",U],completed:[2,"completed","completed",U],hasError:[2,"hasError","hasError",U]},outputs:{interactedStream:"interacted"},exportAs:["cdkStep"],features:[Ae],ngContentSelectors:Yt,decls:1,vars:0,template:function(t,r){t&1&&(te(),Ne(0,ei,1,0,"ng-template"))},encapsulation:2,changeDetection:0})}return i})(),ge=(()=>{class i{_dir=u(Ue,{optional:!0});_changeDetectorRef=u(de);_elementRef=u(W);_destroyed=new re;_keyManager;_steps;steps=new X;_stepHeader;_sortedHeaders=new X;linear=!1;get selectedIndex(){return this._selectedIndex()}set selectedIndex(e){this._steps?(this._isValidIndex(e),this.selectedIndex!==e&&(this.selected?._markAsInteracted(),!this._anyControlsInvalidOrPending(e)&&(e>=this.selectedIndex||this.steps.toArray()[e].editable)&&this._updateSelectedItemIndex(e))):this._selectedIndex.set(e)}_selectedIndex=y(0);get selected(){return this.steps?this.steps.toArray()[this.selectedIndex]:void 0}set selected(e){this.selectedIndex=e&&this.steps?this.steps.toArray().indexOf(e):-1}selectionChange=new $;selectedIndexChange=new $;_groupId=u(st).getId("cdk-stepper-");get orientation(){return this._orientation}set orientation(e){this._orientation=e,this._keyManager&&this._keyManager.withVerticalOrientation(e==="vertical")}_orientation="horizontal";constructor(){}ngAfterContentInit(){this._steps.changes.pipe(L(this._steps),T(this._destroyed)).subscribe(e=>{this.steps.reset(e.filter(t=>t._stepper===this)),this.steps.forEach((t,r)=>t.index.set(r)),this.steps.notifyOnChanges()})}ngAfterViewInit(){if(this._stepHeader.changes.pipe(L(this._stepHeader),T(this._destroyed)).subscribe(e=>{this._sortedHeaders.reset(e.toArray().sort((t,r)=>t._elementRef.nativeElement.compareDocumentPosition(r._elementRef.nativeElement)&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)),this._sortedHeaders.notifyOnChanges()}),this._keyManager=new pt(this._sortedHeaders).withWrap().withHomeAndEnd().withVerticalOrientation(this._orientation==="vertical"),this._keyManager.updateActiveItem(this.selectedIndex),(this._dir?this._dir.change:De()).pipe(L(this._layoutDirection()),T(this._destroyed)).subscribe(e=>this._keyManager?.withHorizontalOrientation(e)),this._keyManager.updateActiveItem(this.selectedIndex),this.steps.changes.subscribe(()=>{this.selected||this._selectedIndex.set(Math.max(this.selectedIndex-1,0))}),this._isValidIndex(this.selectedIndex)||this._selectedIndex.set(0),this.linear&&this.selectedIndex>0){let e=this.steps.toArray().slice(0,this._selectedIndex());for(let t of e)t._markAsInteracted()}}ngOnDestroy(){this._keyManager?.destroy(),this.steps.destroy(),this._sortedHeaders.destroy(),this._destroyed.next(),this._destroyed.complete()}next(){this.selectedIndex=Math.min(this._selectedIndex()+1,this.steps.length-1)}previous(){this.selectedIndex=Math.max(this._selectedIndex()-1,0)}reset(){this._updateSelectedItemIndex(0),this.steps.forEach(e=>e.reset()),this._stateChanged()}_getStepLabelId(e){return`${this._groupId}-label-${e}`}_getStepContentId(e){return`${this._groupId}-content-${e}`}_stateChanged(){this._changeDetectorRef.markForCheck()}_getAnimationDirection(e){let t=e-this._selectedIndex();return t<0?this._layoutDirection()==="rtl"?"next":"previous":t>0?this._layoutDirection()==="rtl"?"previous":"next":"current"}_getFocusIndex(){return this._keyManager?this._keyManager.activeItemIndex:this._selectedIndex()}_updateSelectedItemIndex(e){let t=this.steps.toArray(),r=this._selectedIndex();this.selectionChange.emit({selectedIndex:e,previouslySelectedIndex:r,selectedStep:t[e],previouslySelectedStep:t[r]}),this._keyManager&&(this._containsFocus()?this._keyManager.setActiveItem(e):this._keyManager.updateActiveItem(e)),this._selectedIndex.set(e),this.selectedIndexChange.emit(e),this._stateChanged()}_onKeydown(e){let t=lt(e),r=e.keyCode,o=this._keyManager;o?.activeItemIndex!=null&&!t&&(r===32||r===13)?(this.selectedIndex=o.activeItemIndex,e.preventDefault()):o?.setFocusOrigin("keyboard").onKeydown(e)}_anyControlsInvalidOrPending(e){return this.linear&&e>=0?this.steps.toArray().slice(0,e).some(t=>{let r=t.stepControl;return(r?r.invalid||r.pending||!t.interacted:!t.completed)&&!t.optional&&!t._completedOverride()}):!1}_layoutDirection(){return this._dir&&this._dir.value==="rtl"?"rtl":"ltr"}_containsFocus(){let e=this._elementRef.nativeElement,t=it();return e===t||e.contains(t)}_isValidIndex(e){return e>-1&&(!this.steps||e<this.steps.length)}static \u0275fac=function(t){return new(t||i)};static \u0275dir=R({type:i,selectors:[["","cdkStepper",""]],contentQueries:function(t,r,o){if(t&1&&J(o,_e,5)(o,Me,5),t&2){let c;b(c=M())&&(r._steps=c),b(c=M())&&(r._stepHeader=c)}},inputs:{linear:[2,"linear","linear",U],selectedIndex:[2,"selectedIndex","selectedIndex",$e],selected:"selected",orientation:"orientation"},outputs:{selectionChange:"selectionChange",selectedIndexChange:"selectedIndexChange"},exportAs:["cdkStepper"]})}return i})();var $t=(()=>{class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=ae({type:i});static \u0275inj=oe({imports:[me]})}return i})();var ii=(i,n,e)=>({index:i,active:n,optional:e});function ni(i,n){if(i&1&&D(0,2),i&2){let e=d();m("ngTemplateOutlet",e.iconOverrides[e.state])("ngTemplateOutletContext",Be(2,ii,e.index,e.active,e.optional))}}function ri(i,n){if(i&1&&(a(0,"span",7),p(1),s()),i&2){let e=d(2);l(),O(e._getDefaultTextForState(e.state))}}function oi(i,n){if(i&1&&(a(0,"span",8),p(1),s()),i&2){let e=d(3);l(),O(e._intl.completedLabel)}}function ai(i,n){if(i&1&&(a(0,"span",8),p(1),s()),i&2){let e=d(3);l(),O(e._intl.editableLabel)}}function si(i,n){if(i&1&&(h(0,oi,2,1,"span",8)(1,ai,2,1,"span",8),a(2,"mat-icon",7),p(3),s()),i&2){let e=d(2);_(e.state==="done"?0:e.state==="edit"?1:-1),l(3),O(e._getDefaultTextForState(e.state))}}function li(i,n){if(i&1&&h(0,ri,2,1,"span",7)(1,si,4,2),i&2){let e,t=d();_((e=t.state)==="number"?0:1)}}function pi(i,n){i&1&&(a(0,"div",4),D(1,9),s()),i&2&&(l(),m("ngTemplateOutlet",n.template))}function ci(i,n){if(i&1&&(a(0,"div",4),p(1),s()),i&2){let e=d();l(),O(e.label)}}function di(i,n){if(i&1&&(a(0,"div",5),p(1),s()),i&2){let e=d();l(),O(e._intl.optionalLabel)}}function mi(i,n){if(i&1&&(a(0,"div",6),p(1),s()),i&2){let e=d();l(),O(e.errorMessage)}}var qt=["*"];function ui(i,n){}function fi(i,n){if(i&1&&(ie(0),P(1,ui,0,0,"ng-template",0)),i&2){let e=d();l(),m("cdkPortalOutlet",e._portal)}}var hi=["animatedContainer"],jt=i=>({steps:i}),Jt=i=>({step:i});function _i(i,n){i&1&&ie(0)}function gi(i,n){if(i&1&&(a(0,"div",5),D(1,9)(2,6),s()),i&2){let e=d(2),t=I(6);l(),m("ngTemplateOutlet",e.headerPrefix()),l(),m("ngTemplateOutlet",t)("ngTemplateOutletContext",ne(3,jt,e.steps))}}function vi(i,n){if(i&1&&D(0,6),i&2){let e=d(2),t=I(6);m("ngTemplateOutlet",t)("ngTemplateOutletContext",ne(2,jt,e.steps))}}function yi(i,n){if(i&1&&(a(0,"div",10,2),D(2,9),s()),i&2){let e=n.$implicit,t=n.$index,r=d(2);pe("mat-horizontal-stepper-content-"+r._getAnimationDirection(t)),m("id",r._getStepContentId(t)),ee("aria-labelledby",r._getStepLabelId(t))("inert",r.selectedIndex===t?null:""),l(2),m("ngTemplateOutlet",e.content)}}function xi(i,n){if(i&1&&(a(0,"div",3),h(1,gi,3,5,"div",5)(2,vi,1,4,"ng-container",6),a(3,"div",7),N(4,yi,3,6,"div",8,se),s()()),i&2){let e=d();l(),_(e.headerPrefix()?1:2),l(3),V(e.steps)}}function Ci(i,n){if(i&1&&D(0,9),i&2){let e=d(2);m("ngTemplateOutlet",e.headerPrefix())}}function bi(i,n){if(i&1&&(a(0,"div",11),D(1,6),a(2,"div",12,2)(4,"div",13)(5,"div",14),D(6,9),s()()()()),i&2){let e=n.$implicit,t=n.$index,r=n.$index,o=n.$count,c=d(2),w=I(4);l(),m("ngTemplateOutlet",w)("ngTemplateOutletContext",ne(10,Jt,e)),l(),F("mat-stepper-vertical-line",r!==o-1)("mat-vertical-content-container-active",c.selectedIndex===t),ee("inert",c.selectedIndex===t?null:""),l(2),m("id",c._getStepContentId(t)),ee("aria-labelledby",c._getStepLabelId(t)),l(2),m("ngTemplateOutlet",e.content)}}function Mi(i,n){if(i&1&&(a(0,"div",4),h(1,Ci,1,1,"ng-container",9),N(2,bi,7,12,"div",11,se),s()),i&2){let e=d();l(),_(e.headerPrefix()?1:-1),l(),V(e.steps)}}function Si(i,n){if(i&1){let e=j();a(0,"mat-step-header",15),x("click",function(){let r=g(e).step;return v(r.select())})("keydown",function(r){g(e);let o=d();return v(o._onKeydown(r))}),s()}if(i&2){let e=n.step,t=d();F("mat-horizontal-stepper-header",t.orientation==="horizontal")("mat-vertical-stepper-header",t.orientation==="vertical"),m("tabIndex",t._getFocusIndex()===e.index()?0:-1)("id",t._getStepLabelId(e.index()))("index",e.index())("state",e.indicatorType())("label",e.stepLabel||e.label)("selected",e.isSelected())("active",e.isNavigable())("optional",e.optional)("errorMessage",e.errorMessage)("iconOverrides",t._iconOverrides)("disableRipple",t.disableRipple||!e.isNavigable())("color",e.color||t.color),ee("role",t.orientation==="horizontal"?"tab":"button")("aria-posinset",t.orientation==="horizontal"?e.index()+1:null)("aria-setsize",t.orientation==="horizontal"?t.steps.length:null)("aria-selected",t.orientation==="horizontal"?e.isSelected():null)("aria-current",t.orientation==="vertical"&&e.isSelected()?"step":null)("aria-disabled",t.orientation==="vertical"&&e.isSelected()?"true":null)("aria-expanded",t.orientation==="vertical"?e.isSelected():null)("aria-controls",t._getStepContentId(e.index()))("aria-label",e.ariaLabel||null)("aria-labelledby",!e.ariaLabel&&e.ariaLabelledby?e.ariaLabelledby:null)("aria-disabled",e.isNavigable()?null:!0)}}function Pi(i,n){i&1&&A(0,"div",17)}function Oi(i,n){if(i&1&&(D(0,6),h(1,Pi,1,0,"div",17)),i&2){let e=n.$implicit,t=n.$index,r=n.$count;d(2);let o=I(4);m("ngTemplateOutlet",o)("ngTemplateOutletContext",ne(3,Jt,e)),l(),_(t!==r-1?1:-1)}}function wi(i,n){if(i&1&&(a(0,"div",16),N(1,Oi,2,5,null,null,se),s()),i&2){let e=n.steps;l(),V(e)}}var Pe=(()=>{class i extends Se{static \u0275fac=(()=>{let e;return function(r){return(e||(e=ye(i)))(r||i)}})();static \u0275dir=R({type:i,selectors:[["","matStepLabel",""]],features:[Y]})}return i})(),Ii=(()=>{class i{changes=new re;optionalLabel="Optional";completedLabel="Completed";editableLabel="Editable";static \u0275fac=function(t){return new(t||i)};static \u0275prov=Te({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),Oe=(()=>{class i extends Me{_intl=u(Ii);_focusMonitor=u(rt);_intlSubscription;state;label;errorMessage;iconOverrides;index;selected=!1;active=!1;optional=!1;disableRipple=!1;color;constructor(){super();let e=u(ot);e.load(ft),e.load(at);let t=u(de);this._intlSubscription=this._intl.changes.subscribe(()=>t.markForCheck())}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._intlSubscription.unsubscribe(),this._focusMonitor.stopMonitoring(this._elementRef)}focus(e,t){e?this._focusMonitor.focusVia(this._elementRef,e,t):this._elementRef.nativeElement.focus(t)}_stringLabel(){return this.label instanceof Pe?null:this.label}_templateLabel(){return this.label instanceof Pe?this.label:null}_getHostElement(){return this._elementRef.nativeElement}_getDefaultTextForState(e){return e=="number"?`${this.index+1}`:e=="edit"?"create":e=="error"?"warning":e}_hasEmptyLabel(){return!this._stringLabel()&&!this._templateLabel()&&!this._hasOptionalLabel()&&!this._hasErrorLabel()}_hasOptionalLabel(){return this.optional&&this.state!=="error"}_hasErrorLabel(){return this.state==="error"}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=z({type:i,selectors:[["mat-step-header"]],hostAttrs:["role","",1,"mat-step-header"],hostVars:4,hostBindings:function(t,r){t&2&&(pe("mat-"+(r.color||"primary")),F("mat-step-header-empty-label",r._hasEmptyLabel()))},inputs:{state:"state",label:"label",errorMessage:"errorMessage",iconOverrides:"iconOverrides",index:"index",selected:"selected",active:"active",optional:"optional",disableRipple:"disableRipple",color:"color"},features:[Y],decls:10,vars:17,consts:[["matRipple","",1,"mat-step-header-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-step-icon-content"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"mat-step-label"],[1,"mat-step-text-label"],[1,"mat-step-optional"],[1,"mat-step-sub-label-error"],["aria-hidden","true"],[1,"cdk-visually-hidden"],[3,"ngTemplateOutlet"]],template:function(t,r){if(t&1&&(A(0,"div",0),a(1,"div")(2,"div",1),h(3,ni,1,6,"ng-container",2)(4,li,2,1),s()(),a(5,"div",3),h(6,pi,2,1,"div",4)(7,ci,2,1,"div",4),h(8,di,2,1,"div",5),h(9,mi,2,1,"div",6),s()),t&2){let o;m("matRippleTrigger",r._getHostElement())("matRippleDisabled",r.disableRipple),l(),pe(He("mat-step-icon-state-",r.state," mat-step-icon")),F("mat-step-icon-selected",r.selected),l(2),_(r.iconOverrides&&r.iconOverrides[r.state]?3:4),l(2),F("mat-step-label-active",r.active)("mat-step-label-selected",r.selected)("mat-step-label-error",r.state=="error"),l(),_((o=r._templateLabel())?6:r._stringLabel()?7:-1,o),l(2),_(r._hasOptionalLabel()?8:-1),l(),_(r._hasErrorLabel()?9:-1)}},dependencies:[ut,be,fe],styles:[`.mat-step-header{overflow:hidden;outline:none;cursor:pointer;position:relative;box-sizing:content-box;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-step-header:focus-visible .mat-focus-indicator::before{content:""}.mat-step-header:hover[aria-disabled=true]{cursor:default}.mat-step-header:hover:not([aria-disabled]),.mat-step-header:hover[aria-disabled=false]{background-color:var(--mat-stepper-header-hover-state-layer-color, color-mix(in srgb, var(--mat-sys-on-surface) calc(var(--mat-sys-hover-state-layer-opacity) * 100%), transparent));border-radius:var(--mat-stepper-header-hover-state-layer-shape, var(--mat-sys-corner-medium))}.mat-step-header.cdk-keyboard-focused,.mat-step-header.cdk-program-focused{background-color:var(--mat-stepper-header-focus-state-layer-color, color-mix(in srgb, var(--mat-sys-on-surface) calc(var(--mat-sys-focus-state-layer-opacity) * 100%), transparent));border-radius:var(--mat-stepper-header-focus-state-layer-shape, var(--mat-sys-corner-medium))}@media(hover: none){.mat-step-header:hover{background:none}}@media(forced-colors: active){.mat-step-header{outline:solid 1px}.mat-step-header[aria-selected=true] .mat-step-label{text-decoration:underline}.mat-step-header[aria-disabled=true]{outline-color:GrayText}.mat-step-header[aria-disabled=true] .mat-step-label,.mat-step-header[aria-disabled=true] .mat-step-icon,.mat-step-header[aria-disabled=true] .mat-step-optional{color:GrayText}}.mat-step-optional{font-size:12px;color:var(--mat-stepper-header-optional-label-text-color, var(--mat-sys-on-surface-variant))}.mat-step-sub-label-error{font-size:12px;font-weight:normal}.mat-step-icon{border-radius:50%;height:24px;width:24px;flex-shrink:0;position:relative;color:var(--mat-stepper-header-icon-foreground-color, var(--mat-sys-surface));background-color:var(--mat-stepper-header-icon-background-color, var(--mat-sys-on-surface-variant))}.mat-step-icon-content{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);display:flex}.mat-step-icon .mat-icon{font-size:16px;height:16px;width:16px}.mat-step-icon-state-error{background-color:var(--mat-stepper-header-error-state-icon-background-color, transparent);color:var(--mat-stepper-header-error-state-icon-foreground-color, var(--mat-sys-error))}.mat-step-icon-state-error .mat-icon{font-size:24px;height:24px;width:24px}.mat-step-label{display:inline-block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;min-width:50px;vertical-align:middle;font-family:var(--mat-stepper-header-label-text-font, var(--mat-sys-title-small-font));font-size:var(--mat-stepper-header-label-text-size, var(--mat-sys-title-small-size));font-weight:var(--mat-stepper-header-label-text-weight, var(--mat-sys-title-small-weight));color:var(--mat-stepper-header-label-text-color, var(--mat-sys-on-surface-variant))}.mat-step-label.mat-step-label-active{color:var(--mat-stepper-header-selected-state-label-text-color, var(--mat-sys-on-surface-variant))}.mat-step-label.mat-step-label-error{color:var(--mat-stepper-header-error-state-label-text-color, var(--mat-sys-error));font-size:var(--mat-stepper-header-error-state-label-text-size, var(--mat-sys-title-small-size))}.mat-step-label.mat-step-label-selected{font-size:var(--mat-stepper-header-selected-state-label-text-size, var(--mat-sys-title-small-size));font-weight:var(--mat-stepper-header-selected-state-label-text-weight, var(--mat-sys-title-small-weight))}.mat-step-header-empty-label .mat-step-label{min-width:0}.mat-step-text-label{text-overflow:ellipsis;overflow:hidden}.mat-step-header .mat-step-header-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-step-icon-selected{background-color:var(--mat-stepper-header-selected-state-icon-background-color, var(--mat-sys-primary));color:var(--mat-stepper-header-selected-state-icon-foreground-color, var(--mat-sys-on-primary))}.mat-step-icon-state-done{background-color:var(--mat-stepper-header-done-state-icon-background-color, var(--mat-sys-primary));color:var(--mat-stepper-header-done-state-icon-foreground-color, var(--mat-sys-on-primary))}.mat-step-icon-state-edit{background-color:var(--mat-stepper-header-edit-state-icon-background-color, var(--mat-sys-primary));color:var(--mat-stepper-header-edit-state-icon-foreground-color, var(--mat-sys-on-primary))}
`],encapsulation:2,changeDetection:0})}return i})(),Ei=(()=>{class i{templateRef=u(q);name;constructor(){}static \u0275fac=function(t){return new(t||i)};static \u0275dir=R({type:i,selectors:[["ng-template","matStepperIcon",""]],inputs:{name:[0,"matStepperIcon","name"]}})}return i})(),Di=(()=>{class i{_template=u(q);constructor(){}static \u0275fac=function(t){return new(t||i)};static \u0275dir=R({type:i,selectors:[["ng-template","matStepContent",""]]})}return i})(),we=(()=>{class i extends _e{_errorStateMatcher=u(ue,{skipSelf:!0});_viewContainerRef=u(Le);_isSelected=Ee.EMPTY;stepLabel=void 0;color;_lazyContent;_portal;ngAfterContentInit(){this._isSelected=this._stepper.steps.changes.pipe(ke(()=>this._stepper.selectionChange.pipe(Fe(e=>e.selectedStep===this),L(this._stepper.selected===this)))).subscribe(e=>{e&&this._lazyContent&&!this._portal&&(this._portal=new yt(this._lazyContent._template,this._viewContainerRef))})}ngOnDestroy(){this._isSelected.unsubscribe()}isErrorState(e,t){let r=this._errorStateMatcher.isErrorState(e,t),o=!!(e&&e.invalid&&this.interacted);return r||o}static \u0275fac=(()=>{let e;return function(r){return(e||(e=ye(i)))(r||i)}})();static \u0275cmp=z({type:i,selectors:[["mat-step"]],contentQueries:function(t,r,o){if(t&1&&J(o,Pe,5)(o,Di,5),t&2){let c;b(c=M())&&(r.stepLabel=c.first),b(c=M())&&(r._lazyContent=c.first)}},hostAttrs:["hidden",""],inputs:{color:"color"},exportAs:["matStep"],features:[xe([{provide:ue,useExisting:i},{provide:_e,useExisting:i}]),Y],ngContentSelectors:qt,decls:1,vars:0,consts:[[3,"cdkPortalOutlet"]],template:function(t,r){t&1&&(te(),P(0,fi,2,1,"ng-template"))},dependencies:[xt],encapsulation:2,changeDetection:0})}return i})(),Ie=(()=>{class i extends ge{_ngZone=u(Re);_renderer=u(Ge);_animationsDisabled=ct();_cleanupTransition;_isAnimating=y(!1);_stepHeader=void 0;_animatedContainers;_steps=void 0;steps=new X;_icons;animationDone=new $;disableRipple=!1;color;labelPosition="end";headerPosition="top";headerPrefix=Qe(null);_iconOverrides={};get animationDuration(){return this._animationDuration}set animationDuration(e){this._animationDuration=/^\d+$/.test(e)?e+"ms":e}_animationDuration="";_isServer=!u(nt).isBrowser;constructor(){super();let t=u(W).nativeElement.nodeName.toLowerCase();this.orientation=t==="mat-vertical-stepper"?"vertical":"horizontal"}ngAfterContentInit(){super.ngAfterContentInit(),this._icons.forEach(({name:e,templateRef:t})=>this._iconOverrides[e]=t),this.steps.changes.pipe(T(this._destroyed)).subscribe(()=>this._stateChanged()),this.selectedIndexChange.pipe(T(this._destroyed)).subscribe(()=>{let e=this._getAnimationDuration();e==="0ms"||e==="0s"?this._onAnimationDone():this._isAnimating.set(!0)}),this._ngZone.runOutsideAngular(()=>{this._animationsDisabled||setTimeout(()=>{this._elementRef.nativeElement.classList.add("mat-stepper-animations-enabled"),this._cleanupTransition=this._renderer.listen(this._elementRef.nativeElement,"transitionend",this._handleTransitionend)},200)})}ngAfterViewInit(){if(super.ngAfterViewInit(),typeof queueMicrotask=="function"){let e=!1;this._animatedContainers.changes.pipe(L(null),T(this._destroyed)).subscribe(()=>queueMicrotask(()=>{e||(e=!0,this.animationDone.emit()),this._stateChanged()}))}}ngOnDestroy(){super.ngOnDestroy(),this._cleanupTransition?.()}_getAnimationDuration(){return this._animationsDisabled?"0ms":this.animationDuration?this.animationDuration:this.orientation==="horizontal"?"500ms":"225ms"}_handleTransitionend=e=>{let t=e.target;if(!t)return;let r=this.orientation==="horizontal"&&e.propertyName==="transform"&&t.classList.contains("mat-horizontal-stepper-content-current"),o=this.orientation==="vertical"&&e.propertyName==="grid-template-rows"&&t.classList.contains("mat-vertical-content-container-active");(r||o)&&this._animatedContainers.find(w=>w.nativeElement===t)&&this._onAnimationDone()};_onAnimationDone(){this._isAnimating.set(!1),this.animationDone.emit()}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=z({type:i,selectors:[["mat-stepper"],["mat-vertical-stepper"],["mat-horizontal-stepper"],["","matStepper",""]],contentQueries:function(t,r,o){if(t&1&&J(o,we,5)(o,Ei,5),t&2){let c;b(c=M())&&(r._steps=c),b(c=M())&&(r._icons=c)}},viewQuery:function(t,r){if(t&1&&le(Oe,5)(hi,5),t&2){let o;b(o=M())&&(r._stepHeader=o),b(o=M())&&(r._animatedContainers=o)}},hostVars:14,hostBindings:function(t,r){t&2&&(K("--mat-stepper-animation-duration",r._getAnimationDuration()),F("mat-stepper-horizontal",r.orientation==="horizontal")("mat-stepper-vertical",r.orientation==="vertical")("mat-stepper-label-position-end",r.orientation==="horizontal"&&r.labelPosition=="end")("mat-stepper-label-position-bottom",r.orientation==="horizontal"&&r.labelPosition=="bottom")("mat-stepper-header-position-bottom",r.headerPosition==="bottom")("mat-stepper-animating",r._isAnimating()))},inputs:{disableRipple:"disableRipple",color:"color",labelPosition:"labelPosition",headerPosition:"headerPosition",headerPrefix:[1,"headerPrefix"],animationDuration:"animationDuration"},outputs:{animationDone:"animationDone"},exportAs:["matStepper","matVerticalStepper","matHorizontalStepper"],features:[xe([{provide:ge,useExisting:i}]),Y],ngContentSelectors:qt,decls:7,vars:2,consts:[["stepTemplate",""],["horizontalStepsTemplate",""],["animatedContainer",""],[1,"mat-horizontal-stepper-wrapper"],[1,"mat-vertical-stepper-wrapper"],[1,"mat-horizontal-stepper-header-wrapper"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"mat-horizontal-content-container"],["role","tabpanel",1,"mat-horizontal-stepper-content",3,"id","class"],[3,"ngTemplateOutlet"],["role","tabpanel",1,"mat-horizontal-stepper-content",3,"id"],[1,"mat-step"],[1,"mat-vertical-content-container"],["role","region",1,"mat-vertical-stepper-content",3,"id"],[1,"mat-vertical-content"],[3,"click","keydown","tabIndex","id","index","state","label","selected","active","optional","errorMessage","iconOverrides","disableRipple","color"],["aria-orientation","horizontal","role","tablist",1,"mat-horizontal-stepper-header-container"],[1,"mat-stepper-horizontal-line"]],template:function(t,r){if(t&1&&(te(),h(0,_i,1,0),h(1,xi,6,1,"div",3)(2,Mi,4,1,"div",4),P(3,Si,1,27,"ng-template",null,0,Ce)(5,wi,3,0,"ng-template",null,1,Ce)),t&2){let o;_(r._isServer?0:-1),l(),_((o=r.orientation)==="horizontal"?1:o==="vertical"?2:-1)}},dependencies:[be,Oe],styles:[`.mat-stepper-vertical,.mat-stepper-horizontal{display:block;font-family:var(--mat-stepper-container-text-font, var(--mat-sys-body-medium-font));background:var(--mat-stepper-container-color, var(--mat-sys-surface))}.mat-horizontal-stepper-header-wrapper{align-items:center;display:flex}.mat-horizontal-stepper-header-container{white-space:nowrap;display:flex;align-items:center;flex-grow:1}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header-container{align-items:flex-start}.mat-stepper-header-position-bottom .mat-horizontal-stepper-header-container{order:1}.mat-stepper-horizontal-line{border-top-width:1px;border-top-style:solid;flex:auto;height:0;margin:0 -16px;min-width:32px;border-top-color:var(--mat-stepper-line-color, var(--mat-sys-outline))}.mat-stepper-label-position-bottom .mat-stepper-horizontal-line{margin:0;min-width:0;position:relative;top:calc(calc((var(--mat-stepper-header-height, 72px) - 24px) / 2) + 12px)}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:first-child)::before,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:last-child)::before,.mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:last-child)::after,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:first-child)::after{border-top-width:1px;border-top-style:solid;content:"";display:inline-block;height:0;position:absolute;width:calc(50% - 20px)}.mat-horizontal-stepper-header{display:flex;overflow:hidden;align-items:center;padding:0 24px;height:var(--mat-stepper-header-height, 72px)}.mat-horizontal-stepper-header .mat-step-icon{margin-right:8px;flex:none}[dir=rtl] .mat-horizontal-stepper-header .mat-step-icon{margin-right:0;margin-left:8px}.mat-horizontal-stepper-header.mat-step-header-empty-label .mat-step-icon{margin:0}.mat-horizontal-stepper-header::before,.mat-horizontal-stepper-header::after{border-top-color:var(--mat-stepper-line-color, var(--mat-sys-outline))}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header{padding:calc((var(--mat-stepper-header-height, 72px) - 24px) / 2) 24px}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header::before,.mat-stepper-label-position-bottom .mat-horizontal-stepper-header::after{top:calc(calc((var(--mat-stepper-header-height, 72px) - 24px) / 2) + 12px)}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header{box-sizing:border-box;flex-direction:column;height:auto}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:last-child)::after,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:first-child)::after{right:0}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:first-child)::before,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:last-child)::before{left:0}[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:last-child::before,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:first-child::after{display:none}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header .mat-step-icon{margin-right:0;margin-left:0}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header .mat-step-label{padding:16px 0 0 0;text-align:center;width:100%}.mat-vertical-stepper-header{display:flex;align-items:center;height:24px;padding:calc((var(--mat-stepper-header-height, 72px) - 24px) / 2) 24px}.mat-vertical-stepper-header .mat-step-icon{margin-right:12px}[dir=rtl] .mat-vertical-stepper-header .mat-step-icon{margin-right:0;margin-left:12px}.mat-horizontal-stepper-wrapper{display:flex;flex-direction:column}.mat-horizontal-stepper-content{visibility:hidden;overflow:hidden;outline:0;height:0}.mat-stepper-animations-enabled .mat-horizontal-stepper-content{transition:transform var(--mat-stepper-animation-duration, 0) cubic-bezier(0.35, 0, 0.25, 1)}.mat-horizontal-stepper-content.mat-horizontal-stepper-content-previous{transform:translate3d(-100%, 0, 0)}.mat-horizontal-stepper-content.mat-horizontal-stepper-content-next{transform:translate3d(100%, 0, 0)}.mat-horizontal-stepper-content.mat-horizontal-stepper-content-current{visibility:visible;transform:none;height:auto}.mat-stepper-horizontal:not(.mat-stepper-animating) .mat-horizontal-stepper-content.mat-horizontal-stepper-content-current{overflow:visible}.mat-horizontal-content-container{overflow:hidden;padding:0 24px 24px 24px}@media(forced-colors: active){.mat-horizontal-content-container{outline:solid 1px}}.mat-stepper-header-position-bottom .mat-horizontal-content-container{padding:24px 24px 0 24px}.mat-vertical-content-container{display:grid;grid-template-rows:0fr;grid-template-columns:100%;margin-left:36px;border:0;position:relative}.mat-stepper-animations-enabled .mat-vertical-content-container{transition:grid-template-rows var(--mat-stepper-animation-duration, 0) cubic-bezier(0.4, 0, 0.2, 1)}.mat-vertical-content-container.mat-vertical-content-container-active{grid-template-rows:1fr}.mat-step:last-child .mat-vertical-content-container{border:none}@media(forced-colors: active){.mat-vertical-content-container{outline:solid 1px}}[dir=rtl] .mat-vertical-content-container{margin-left:0;margin-right:36px}@supports not (grid-template-rows: 0fr){.mat-vertical-content-container{height:0}.mat-vertical-content-container.mat-vertical-content-container-active{height:auto}}.mat-stepper-vertical-line::before{content:"";position:absolute;left:0;border-left-width:1px;border-left-style:solid;border-left-color:var(--mat-stepper-line-color, var(--mat-sys-outline));top:calc(8px - calc((var(--mat-stepper-header-height, 72px) - 24px) / 2));bottom:calc(8px - calc((var(--mat-stepper-header-height, 72px) - 24px) / 2))}[dir=rtl] .mat-stepper-vertical-line::before{left:auto;right:0}.mat-vertical-stepper-content{overflow:hidden;outline:0;visibility:hidden}.mat-stepper-animations-enabled .mat-vertical-stepper-content{transition:visibility var(--mat-stepper-animation-duration, 0) linear}.mat-vertical-content-container-active>.mat-vertical-stepper-content{visibility:visible}.mat-vertical-content{padding:0 24px 24px 24px}
`],encapsulation:2,changeDetection:0})}return i})();var Kt=(()=>{class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=ae({type:i});static \u0275inj=oe({providers:[ue],imports:[Ct,$t,he,_t,Ie,Oe,me]})}return i})();var ki=(i,n)=>n.type,Ti=(i,n)=>n.file.name;function zi(i,n){if(i&1&&(a(0,"mat-chip")(1,"mat-icon"),p(2),s(),p(3),s()),i&2){let e=n.$implicit;K("background-color",e.color),l(2),O(e.icon),l(),S(" ",e.label," ")}}function Ri(i,n){i&1&&(a(0,"mat-icon",46),p(1,"schedule"),s())}function Ai(i,n){i&1&&(a(0,"mat-icon",47),p(1,"hourglass_empty"),s())}function Gi(i,n){i&1&&(a(0,"mat-icon",48),p(1,"check_circle"),s())}function Li(i,n){if(i&1&&(a(0,"mat-icon",49),p(1,"error"),s()),i&2){let e=d().$implicit;m("matTooltip",e.error||"")}}function Ni(i,n){if(i&1){let e=j();a(0,"div",40)(1,"div",41)(2,"mat-icon"),p(3),s(),a(4,"div",42)(5,"span",43),p(6),s(),a(7,"span",44),p(8),s()()(),a(9,"div",45),h(10,Ri,2,0,"mat-icon",46)(11,Ai,2,0,"mat-icon",47)(12,Gi,2,0,"mat-icon",48)(13,Li,2,1,"mat-icon",49),a(14,"button",50),x("click",function(){let r=g(e).$implicit,o=d(2);return v(o.removeFile(r))}),a(15,"mat-icon"),p(16,"close"),s()()()()}if(i&2){let e,t=n.$implicit,r=d(2);F("error",t.status==="error"),l(2),K("color",r.getFormatColor(t.type)),l(),S(" ",r.getFormatIcon(t.type)," "),l(3),O(t.file.name),l(2),O(r.formatFileSize(t.size)),l(2),_((e=t.status)==="pending"?10:e==="processing"?11:e==="parsed"?12:e==="error"?13:-1)}}function Vi(i,n){if(i&1&&(a(0,"div",13)(1,"h3"),p(2),s(),N(3,Ni,17,8,"div",39,Ti),s()),i&2){let e=d();l(2),S("Fichiers s\xE9lectionn\xE9s (",e.files().length,")"),l(),V(e.files())}}function Hi(i,n){i&1&&A(0,"mat-progress-bar",14)}function Bi(i,n){i&1&&(a(0,"th",51),p(1,"S\xE9lection"),s())}function Qi(i,n){if(i&1){let e=j();a(0,"td",52)(1,"mat-icon",53),x("click",function(){let r=g(e).$implicit,o=d();return v(o.toggleFeature(r))}),p(2),s()()}if(i&2){let e=n.$implicit;l(),K("color",e.selected?"primary":"gray"),l(),S(" ",e.selected?"check_box":"check_box_outline_blank"," ")}}function $i(i,n){i&1&&(a(0,"th",51),p(1,"R\xE9f\xE9rence"),s())}function qi(i,n){if(i&1&&(a(0,"td",52),p(1),s()),i&2){let e=n.$implicit;l(),S(" ",e.properties.reference||e.properties.ref||e.properties.id||"N/A"," ")}}function ji(i,n){i&1&&(a(0,"th",51),p(1,"Adresse"),s())}function Ji(i,n){if(i&1&&(a(0,"td",52),p(1),s()),i&2){let e=n.$implicit;l(),S(" ",e.properties.address||e.properties.addr||e.properties.location||"N/A"," ")}}function Ki(i,n){i&1&&(a(0,"th",51),p(1,"Surface (m\xB2)"),s())}function Ui(i,n){if(i&1&&(a(0,"td",52),p(1),s()),i&2){let e=n.$implicit;l(),S(" ",e.properties.area||e.properties.surface||"N/A"," ")}}function Zi(i,n){i&1&&(a(0,"th",51),p(1,"Zone"),s())}function Wi(i,n){if(i&1&&(a(0,"td",52),p(1),s()),i&2){let e=n.$implicit;l(),S(" ",e.properties.zone||e.properties.sector||"N/A"," ")}}function Xi(i,n){i&1&&(a(0,"th",51),p(1,"G\xE9om\xE9trie"),s())}function Yi(i,n){if(i&1&&(a(0,"td",52)(1,"mat-icon",54),p(2),s(),p(3),s()),i&2){let e=n.$implicit,t=d();l(),m("matTooltip",e.geometry.type),l(),S(" ",t.getGeometryIcon(e.geometry)," "),l(),S(" ",e.geometry.type," ")}}function en(i,n){i&1&&A(0,"tr",55)}function tn(i,n){if(i&1&&A(0,"tr",56),i&2){let e=n.$implicit;F("selected",e.selected)}}function nn(i,n){if(i&1&&(a(0,"div",37)(1,"h4"),p(2,"Import en cours..."),s(),A(3,"mat-progress-bar",57),a(4,"p",58),p(5),s()()),i&2){let e=d();l(3),m("value",e.importProgress()),l(2),S("",e.importProgress().toFixed(0),"%")}}var Ut=class i{constructor(){this.parcelService=u(Bt);this.snackBar=u(bt);this.router=u(je);this.files=y([]);this.parsedFeatures=y([]);this.loading=y(!1);this.currentStep=y(0);this.importProgress=y(0);this.csvConfig={latColumn:"latitude",lngColumn:"longitude",referenceColumn:"reference",addressColumn:"address",areaColumn:"area",zoneColumn:"zone"};this.supportedFormats=[{type:"shp",label:"Shapefile (.shp)",icon:"layers",color:"#4CAF50"},{type:"gpx",label:"GPS Exchange (.gpx)",icon:"navigation",color:"#2196F3"},{type:"geojson",label:"GeoJSON (.geojson)",icon:"code",color:"#FF9800"},{type:"csv",label:"CSV with coordinates (.csv)",icon:"table_chart",color:"#9C27B0"},{type:"qgs",label:"QGIS Project (.qgs)",icon:"map",color:"#795548"},{type:"qgz",label:"QGIS Compressed (.qgz)",icon:"folder_zip",color:"#795548"}];this.displayedColumns=["select","reference","address","area","zone","geometry"]}onFileSelect(n){let e=n.target;if(!e.files||e.files.length===0)return;let t=Array.from(e.files).map(r=>({file:r,type:this.detectFileType(r),size:r.size,status:"pending"}));this.files.set([...this.files(),...t]),this.parseFiles()}detectFileType(n){switch(n.name.split(".").pop()?.toLowerCase()){case"shp":return"shp";case"gpx":return"gpx";case"geojson":case"json":return"geojson";case"csv":return"csv";case"qgs":return"qgs";case"qgz":return"qgz";default:return"unknown"}}parseFiles(){return k(this,null,function*(){this.loading.set(!0);let n=this.files();for(let e of n)if(e.status==="pending"){try{e.status="processing",this.files.set([...n]);let t=yield this.parseFile(e);e.data=t,e.status="parsed",this.extractFeatures(t,e.type)}catch(t){e.status="error",e.error=t.message||"Erreur de parsing",console.error("Error parsing file:",t)}this.files.set([...n])}this.loading.set(!1),this.parsedFeatures().length>0&&this.currentStep.set(1)})}parseFile(n){return k(this,null,function*(){switch(n.type){case"geojson":return this.parseGeoJSON(n.file);case"csv":return this.parseCSV(n.file);case"gpx":return this.parseGPX(n.file);case"shp":return this.snackBar.open("Shapefile: Veuillez uploader aussi les fichiers .shx, .dbf, .prj associ\xE9s","OK",{duration:5e3}),this.parseShapefile(n.file);case"qgs":case"qgz":return this.parseQGIS(n.file);default:throw new Error("Format de fichier non support\xE9")}})}parseGeoJSON(n){return k(this,null,function*(){let e=yield n.text(),t=JSON.parse(e);if(!t.type||t.type!=="FeatureCollection"&&t.type!=="Feature")throw new Error("Format GeoJSON invalide");return t})}parseCSV(n){return k(this,null,function*(){let t=(yield n.text()).split(`
`).filter(c=>c.trim());if(t.length<2)throw new Error("CSV vide ou invalide");let r=t[0].split(",").map(c=>c.trim()),o=[];for(let c=1;c<t.length;c++){let w=t[c].split(",").map(E=>E.trim()),f={};r.forEach((E,Z)=>{f[E]=w[Z]});let C=parseFloat(f[this.csvConfig.latColumn]||f.lat||f.latitude),G=parseFloat(f[this.csvConfig.lngColumn]||f.lng||f.longitude);if(isNaN(C)||isNaN(G)){console.warn(`Ligne ${c+1}: Coordonn\xE9es invalides`,f);continue}o.push({type:"Feature",geometry:{type:"Point",coordinates:[G,C]},properties:f})}return{type:"FeatureCollection",features:o}})}parseGPX(n){return k(this,null,function*(){let e=yield n.text(),r=new DOMParser().parseFromString(e,"text/xml"),o=[];return r.querySelectorAll("wpt").forEach(f=>{let C=parseFloat(f.getAttribute("lat")||"0"),G=parseFloat(f.getAttribute("lon")||"0"),E=f.querySelector("name")?.textContent||"";o.push({type:"Feature",geometry:{type:"Point",coordinates:[G,C]},properties:{name:E}})}),r.querySelectorAll("trk").forEach(f=>{let C=[];f.querySelectorAll("trkpt").forEach(E=>{let Z=parseFloat(E.getAttribute("lat")||"0"),ve=parseFloat(E.getAttribute("lon")||"0");C.push([ve,Z])}),C.length>0&&o.push({type:"Feature",geometry:{type:"LineString",coordinates:C},properties:{name:f.querySelector("name")?.textContent||"Track"}})}),{type:"FeatureCollection",features:o}})}parseShapefile(n){return k(this,null,function*(){try{let e=yield import("./chunk-V54ZWV6J.js"),t=yield n.arrayBuffer(),r=yield e.default(t);if(r.type==="FeatureCollection")return r;if(typeof r=="object"&&!r.type){let o=Object.values(r)[0];if(o&&o.type==="FeatureCollection")return o}throw new Error("Format Shapefile non reconnu")}catch(e){throw console.error("Error parsing shapefile:",e),new Error(`Erreur lors du parsing du Shapefile: ${e instanceof Error?e.message:"Erreur inconnue"}`)}})}parseQGIS(n){return k(this,null,function*(){try{let e=yield n.text(),r=new DOMParser().parseFromString(e,"text/xml");if(r.querySelector("parsererror"))throw new Error("Fichier QGS invalide: erreur de parsing XML");let c=r.querySelector("qgis > title")?.textContent||"Projet QGIS",w=[];return r.querySelectorAll("projectlayers > maplayer").forEach((C,G)=>{let E=C.querySelector("layername")?.textContent||`Couche ${G+1}`,Z=C.getAttribute("type")||"unknown",ve=C.getAttribute("geometry")||"",Zt=C.querySelector("provider")?.textContent||"",Wt=C.querySelector("datasource")?.textContent||"";w.push({name:E,type:Z,geometryType:ve,provider:Zt,datasource:Wt})}),{type:"QGISProject",projectTitle:c,layers:w,layerCount:w.length,message:`Projet QGIS d\xE9tect\xE9 avec ${w.length} couche(s). Pour importer les donn\xE9es, veuillez exporter les couches en GeoJSON depuis QGIS.`}}catch(e){throw console.error("Error parsing QGIS project:",e),new Error(`Erreur lors du parsing du projet QGIS: ${e instanceof Error?e.message:"Erreur inconnue"}`)}})}extractFeatures(n,e){let t=[];n.type==="FeatureCollection"&&Array.isArray(n.features)?n.features.forEach(r=>{t.push({geometry:r.geometry,properties:r.properties||{},selected:!0})}):n.type==="Feature"&&t.push({geometry:n.geometry,properties:n.properties||{},selected:!0}),this.parsedFeatures.set([...this.parsedFeatures(),...t])}toggleFeature(n){n.selected=!n.selected,this.parsedFeatures.set([...this.parsedFeatures()])}toggleAll(n){let e=this.parsedFeatures();e.forEach(t=>t.selected=n),this.parsedFeatures.set([...e])}importSelected(){return k(this,null,function*(){let n=this.parsedFeatures().filter(r=>r.selected);if(n.length===0){this.snackBar.open("Aucune parcelle s\xE9lectionn\xE9e","Fermer",{duration:3e3});return}this.loading.set(!0),this.importProgress.set(0);let e=0,t=0;for(let r=0;r<n.length;r++){try{let o=n[r],c=this.featureToParcel(o);yield this.parcelService.createParcel(c).toPromise(),e++}catch(o){console.error("Error importing feature:",o),t++}this.importProgress.set((r+1)/n.length*100)}this.loading.set(!1),this.snackBar.open(`Import termin\xE9: ${e} parcelles import\xE9es, ${t} erreurs`,"Fermer",{duration:5e3}),e>0&&setTimeout(()=>{this.router.navigate(["/parcels"])},2e3)})}featureToParcel(n){let e=n.properties,t,r,o;if(n.geometry.type==="Point")[r,t]=n.geometry.coordinates;else if(n.geometry.type==="Polygon"&&(o=n.geometry.coordinates[0],o)){let c=this.calculateCentroid(o);t=c[1],r=c[0]}return{reference_cadastrale:e.reference||e.ref||e.id||`IMP-${Date.now()}`,address:e.address||e.addr||e.location||"Adresse \xE0 compl\xE9ter",area:parseFloat(e.area||e.surface||e.size||"0"),zone:e.zone||e.sector||"Zone A",status:"available",latitude:t,longitude:r,geometry:o}}calculateCentroid(n){let e=0,t=0;return n.forEach(r=>{e+=r[0],t+=r[1]}),[e/n.length,t/n.length]}removeFile(n){let e=this.files().filter(t=>t!==n);this.files.set(e)}reset(){this.files.set([]),this.parsedFeatures.set([]),this.currentStep.set(0),this.importProgress.set(0)}formatFileSize(n){return n<1024?n+" B":n<1024*1024?(n/1024).toFixed(1)+" KB":(n/(1024*1024)).toFixed(1)+" MB"}getGeometryIcon(n){if(!n)return"help";switch(n.type){case"Point":return"place";case"LineString":return"timeline";case"Polygon":return"crop_square";case"MultiPoint":return"scatter_plot";case"MultiLineString":return"polyline";case"MultiPolygon":return"layers";default:return"help"}}getFormatColor(n){return this.supportedFormats.find(t=>t.type===n)?.color||"#666"}getFormatIcon(n){return this.supportedFormats.find(t=>t.type===n)?.icon||"insert_drive_file"}getSelectedCount(){return this.parsedFeatures().filter(n=>n.selected).length}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275cmp=z({type:i,selectors:[["app-import-geospatial"]],decls:95,vars:15,consts:[["stepper",""],["fileInput",""],[1,"import-container"],[1,"import-card"],[3,"linear","selectedIndex"],["label","S\xE9lection des fichiers"],[1,"step-content"],[1,"supported-formats"],[1,"format-chips"],[3,"background-color"],[1,"upload-zone",3,"click"],[1,"upload-icon"],["type","file","multiple","","accept",".shp,.gpx,.geojson,.json,.csv,.qgs,.qgz",2,"display","none",3,"change"],[1,"files-list"],["mode","indeterminate"],[1,"step-actions"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click","disabled"],["label","Pr\xE9visualisation"],[1,"preview-header"],[1,"selection-actions"],[1,"preview-table"],["mat-table","",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","reference"],["matColumnDef","address"],["matColumnDef","area"],["matColumnDef","zone"],["matColumnDef","geometry"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"selected",4,"matRowDef","matRowDefColumns"],["label","Import"],[1,"import-summary"],[1,"summary-icon"],[1,"summary-text"],[1,"import-progress"],["mat-button","",3,"click","disabled"],[1,"file-item",3,"error"],[1,"file-item"],[1,"file-info"],[1,"file-details"],[1,"file-name"],[1,"file-size"],[1,"file-status"],[1,"status-icon","pending"],[1,"status-icon","processing"],[1,"status-icon","success"],[1,"status-icon","error",3,"matTooltip"],["mat-icon-button","",3,"click"],["mat-header-cell",""],["mat-cell",""],[1,"select-icon",3,"click"],[3,"matTooltip"],["mat-header-row",""],["mat-row",""],["mode","determinate",3,"value"],[1,"progress-text"]],template:function(e,t){if(e&1){let r=j();a(0,"div",2)(1,"mat-card",3)(2,"mat-card-header")(3,"mat-card-title")(4,"mat-icon"),p(5,"upload_file"),s(),p(6," Import de Fichiers G\xE9ospatiaux "),s(),a(7,"mat-card-subtitle"),p(8," Importez des parcelles depuis des fichiers SHP, GPX, GeoJSON, CSV, QGS ou QGZ "),s()(),a(9,"mat-card-content")(10,"mat-stepper",4,0)(12,"mat-step",5)(13,"div",6)(14,"div",7)(15,"h3"),p(16,"Formats support\xE9s :"),s(),a(17,"div",8),N(18,zi,4,4,"mat-chip",9,ki),s()(),a(20,"div",10),x("click",function(){g(r);let c=I(28);return v(c.click())}),a(21,"mat-icon",11),p(22,"cloud_upload"),s(),a(23,"h3"),p(24,"Glissez-d\xE9posez vos fichiers ici"),s(),a(25,"p"),p(26,"ou cliquez pour s\xE9lectionner"),s(),a(27,"input",12,1),x("change",function(c){return g(r),v(t.onFileSelect(c))}),s()(),h(29,Vi,5,1,"div",13),h(30,Hi,1,0,"mat-progress-bar",14),a(31,"div",15)(32,"button",16),x("click",function(){return g(r),v(t.reset())}),p(33,"R\xE9initialiser"),s(),a(34,"button",17),x("click",function(){g(r);let c=I(11);return v(c.next())}),p(35," Suivant "),s()()()(),a(36,"mat-step",18)(37,"div",6)(38,"div",19)(39,"h3"),p(40),s(),a(41,"div",20)(42,"button",16),x("click",function(){return g(r),v(t.toggleAll(!0))}),a(43,"mat-icon"),p(44,"check_box"),s(),p(45," Tout s\xE9lectionner "),s(),a(46,"button",16),x("click",function(){return g(r),v(t.toggleAll(!1))}),a(47,"mat-icon"),p(48,"check_box_outline_blank"),s(),p(49," Tout d\xE9s\xE9lectionner "),s()()(),a(50,"div",21)(51,"table",22),H(52,23),P(53,Bi,2,0,"th",24)(54,Qi,3,3,"td",25),B(),H(55,26),P(56,$i,2,0,"th",24)(57,qi,2,1,"td",25),B(),H(58,27),P(59,ji,2,0,"th",24)(60,Ji,2,1,"td",25),B(),H(61,28),P(62,Ki,2,0,"th",24)(63,Ui,2,1,"td",25),B(),H(64,29),P(65,Zi,2,0,"th",24)(66,Wi,2,1,"td",25),B(),H(67,30),P(68,Xi,2,0,"th",24)(69,Yi,4,3,"td",25),B(),P(70,en,1,0,"tr",31)(71,tn,1,2,"tr",32),s()(),a(72,"div",15)(73,"button",16),x("click",function(){g(r);let c=I(11);return v(c.previous())}),p(74,"Pr\xE9c\xE9dent"),s(),a(75,"button",17),x("click",function(){g(r);let c=I(11);return v(c.next())}),p(76," Suivant "),s()()()(),a(77,"mat-step",33)(78,"div",6)(79,"div",34)(80,"mat-icon",35),p(81,"info"),s(),a(82,"div",36)(83,"h3"),p(84,"Pr\xEAt \xE0 importer"),s(),a(85,"p"),p(86),s()()(),h(87,nn,6,2,"div",37),a(88,"div",15)(89,"button",38),x("click",function(){g(r);let c=I(11);return v(c.previous())}),p(90," Pr\xE9c\xE9dent "),s(),a(91,"button",17),x("click",function(){return g(r),v(t.importSelected())}),a(92,"mat-icon"),p(93,"cloud_upload"),s(),p(94," Lancer l'import "),s()()()()()()()()}e&2&&(l(10),m("linear",!0)("selectedIndex",t.currentStep()),l(8),V(t.supportedFormats),l(11),_(t.files().length>0?29:-1),l(),_(t.loading()?30:-1),l(4),m("disabled",t.files().length===0||t.loading()||t.parsedFeatures().length===0),l(6),S("",t.parsedFeatures().length," parcelle(s) d\xE9tect\xE9e(s)"),l(11),m("dataSource",t.parsedFeatures()),l(19),m("matHeaderRowDef",t.displayedColumns),l(),m("matRowDefColumns",t.displayedColumns),l(4),m("disabled",t.getSelectedCount()===0),l(11),Ve(" ",t.getSelectedCount()," parcelle(s) s\xE9lectionn\xE9e(s) sur ",t.parsedFeatures().length," "),l(),_(t.loading()?87:-1),l(2),m("disabled",t.loading()),l(2),m("disabled",t.loading()))},dependencies:[qe,Ke,tt,Ze,Xe,et,Ye,We,vt,gt,ht,he,fe,Dt,Et,Kt,we,Ie,Ot,dt,mt,Ht,Ft,Tt,Gt,zt,kt,Lt,Rt,At,Nt,Vt,It,wt,Mt,Pt,St],styles:[".import-container[_ngcontent-%COMP%]{padding:24px;max-width:1400px;margin:0 auto}.import-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;font-size:24px;font-weight:500}.import-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:32px;width:32px;height:32px}.step-content[_ngcontent-%COMP%]{padding:24px 0;min-height:400px}.supported-formats[_ngcontent-%COMP%]{margin-bottom:24px}.supported-formats[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:12px;font-size:16px;font-weight:500}.supported-formats[_ngcontent-%COMP%]   .format-chips[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px}.supported-formats[_ngcontent-%COMP%]   .format-chips[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]{color:#fff;font-weight:500}.supported-formats[_ngcontent-%COMP%]   .format-chips[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#fff;margin-right:4px}.upload-zone[_ngcontent-%COMP%]{border:2px dashed #ccc;border-radius:8px;padding:48px;text-align:center;cursor:pointer;transition:all .3s ease;background-color:#fafafa;margin-bottom:24px}.upload-zone[_ngcontent-%COMP%]:hover{border-color:var(--primary-color, #009688);background-color:#f0f8f7}.upload-zone[_ngcontent-%COMP%]   .upload-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;color:#009688;margin-bottom:16px}.upload-zone[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;font-size:18px;font-weight:500}.upload-zone[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#666}.files-list[_ngcontent-%COMP%]{margin-bottom:24px}.files-list[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:12px;font-size:16px;font-weight:500}.files-list[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;border:1px solid #e0e0e0;border-radius:4px;margin-bottom:8px;background-color:#fff;transition:background-color .2s}.files-list[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]:hover{background-color:#f5f5f5}.files-list[_ngcontent-%COMP%]   .file-item.error[_ngcontent-%COMP%]{border-color:#f44336;background-color:#ffebee}.files-list[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .file-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;flex:1}.files-list[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .file-info[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px}.files-list[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .file-info[_ngcontent-%COMP%]   .file-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.files-list[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .file-info[_ngcontent-%COMP%]   .file-details[_ngcontent-%COMP%]   .file-name[_ngcontent-%COMP%]{font-weight:500}.files-list[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .file-info[_ngcontent-%COMP%]   .file-details[_ngcontent-%COMP%]   .file-size[_ngcontent-%COMP%]{font-size:12px;color:#666}.files-list[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .file-status[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.files-list[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .file-status[_ngcontent-%COMP%]   .status-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.files-list[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .file-status[_ngcontent-%COMP%]   .status-icon.pending[_ngcontent-%COMP%]{color:#ff9800}.files-list[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .file-status[_ngcontent-%COMP%]   .status-icon.processing[_ngcontent-%COMP%]{color:#2196f3;animation:_ngcontent-%COMP%_spin 2s linear infinite}.files-list[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .file-status[_ngcontent-%COMP%]   .status-icon.success[_ngcontent-%COMP%]{color:#4caf50}.files-list[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .file-status[_ngcontent-%COMP%]   .status-icon.error[_ngcontent-%COMP%]{color:#f44336}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.preview-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;padding-bottom:16px;border-bottom:1px solid #e0e0e0}.preview-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:500}.preview-header[_ngcontent-%COMP%]   .selection-actions[_ngcontent-%COMP%]{display:flex;gap:8px}.preview-table[_ngcontent-%COMP%]{overflow-x:auto;margin-bottom:24px}.preview-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%}.preview-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:500;color:#666}.preview-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background-color:#e8f5e9}.preview-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .select-icon[_ngcontent-%COMP%]{cursor:pointer;transition:color .2s}.preview-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .select-icon[_ngcontent-%COMP%]:hover{color:var(--primary-color, #009688)!important}.import-summary[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:16px;padding:24px;background-color:#e3f2fd;border-radius:8px;margin-bottom:24px}.import-summary[_ngcontent-%COMP%]   .summary-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;color:#2196f3}.import-summary[_ngcontent-%COMP%]   .summary-text[_ngcontent-%COMP%]{flex:1}.import-summary[_ngcontent-%COMP%]   .summary-text[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;font-size:18px;font-weight:500}.import-summary[_ngcontent-%COMP%]   .summary-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#666}.import-progress[_ngcontent-%COMP%]{margin-bottom:24px}.import-progress[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 12px;font-size:16px;font-weight:500}.import-progress[_ngcontent-%COMP%]   mat-progress-bar[_ngcontent-%COMP%]{height:8px;border-radius:4px}.import-progress[_ngcontent-%COMP%]   .progress-text[_ngcontent-%COMP%]{margin:8px 0 0;text-align:center;font-weight:500;color:#666}.step-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:12px;margin-top:24px;padding-top:24px;border-top:1px solid #e0e0e0}@media(max-width:768px){.import-container[_ngcontent-%COMP%]{padding:16px}.upload-zone[_ngcontent-%COMP%]{padding:32px 16px}.upload-zone[_ngcontent-%COMP%]   .upload-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px}.preview-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:12px}.preview-header[_ngcontent-%COMP%]   .selection-actions[_ngcontent-%COMP%]{width:100%;justify-content:space-between}.preview-table[_ngcontent-%COMP%]{font-size:14px}.step-actions[_ngcontent-%COMP%]{flex-direction:column}.step-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}}"],changeDetection:0})}};export{Ut as ImportGeospatialComponent};
