import{a as U,b as $,d as J,e as R,f as K,g as q}from"./chunk-MR57I2Q4.js";import{a as B,b as N}from"./chunk-UUJ2B6HP.js";import{$ as L,Y as I}from"./chunk-AQZ5PN4T.js";import{p as A}from"./chunk-3AYM6UTQ.js";import{Cb as C,Db as b,Eb as f,Fb as P,Gb as p,Hb as v,Ib as D,Jb as _,Kb as h,Mb as c,Nb as d,Ob as r,Wb as F,Xa as s,Y as O,Yb as m,ba as E,f as w,hc as M,jc as T,kc as S,lb as k,lc as j,mc as y,tc as u}from"./chunk-E7AQ6X4Y.js";import{a as l,b as g}from"./chunk-EQDQRRRY.js";var z=class n{constructor(){this.favoritesSubject=new w([]);this.favorites$=this.favoritesSubject.asObservable();this.savedSearchesSubject=new w([]);this.savedSearches$=this.savedSearchesSubject.asObservable();this.storageKey="siu_favorites";this.searchStorageKey="siu_saved_searches";this.loadFavorites(),this.loadSavedSearches()}loadFavorites(){let e=localStorage.getItem(this.storageKey);if(e)try{let o=JSON.parse(e).map(i=>g(l({},i),{createdAt:new Date(i.createdAt),lastAccessed:i.lastAccessed?new Date(i.lastAccessed):void 0}));this.favoritesSubject.next(o)}catch(t){console.error("Erreur lors du chargement des favoris:",t),this.favoritesSubject.next([])}}loadSavedSearches(){let e=localStorage.getItem(this.searchStorageKey);if(e)try{let o=JSON.parse(e).map(i=>g(l({},i),{createdAt:new Date(i.createdAt),lastUsed:i.lastUsed?new Date(i.lastUsed):void 0}));this.savedSearchesSubject.next(o)}catch(t){console.error("Erreur lors du chargement des recherches sauvegard\xE9es:",t),this.savedSearchesSubject.next([])}}saveFavorites(){let e=this.favoritesSubject.value;localStorage.setItem(this.storageKey,JSON.stringify(e))}saveSearches(){let e=this.savedSearchesSubject.value;localStorage.setItem(this.searchStorageKey,JSON.stringify(e))}addFavorite(e){let t=g(l({},e),{id:`fav_${Date.now()}`,createdAt:new Date}),o=this.favoritesSubject.value;if(!o.some(a=>a.latitude===e.latitude&&a.longitude===e.longitude)){let a=[...o,t];this.favoritesSubject.next(a),this.saveFavorites()}return t}removeFavorite(e){let o=this.favoritesSubject.value.filter(i=>i.id!==e);this.favoritesSubject.next(o),this.saveFavorites()}updateFavorite(e,t){let i=this.favoritesSubject.value.map(a=>a.id===e?g(l(l({},a),t),{lastAccessed:new Date}):a);this.favoritesSubject.next(i),this.saveFavorites()}getFavoriteById(e){return this.favoritesSubject.value.find(t=>t.id===e)}accessFavorite(e){this.getFavoriteById(e)&&this.updateFavorite(e,{lastAccessed:new Date})}addSavedSearch(e){let t=g(l({},e),{id:`search_${Date.now()}`,createdAt:new Date}),o=this.savedSearchesSubject.value;if(!o.some(a=>a.query===e.query&&JSON.stringify(a.filters)===JSON.stringify(e.filters))){let a=[...o,t];this.savedSearchesSubject.next(a),this.saveSearches()}return t}removeSavedSearch(e){let o=this.savedSearchesSubject.value.filter(i=>i.id!==e);this.savedSearchesSubject.next(o),this.saveSearches()}updateSavedSearch(e,t){let i=this.savedSearchesSubject.value.map(a=>a.id===e?g(l(l({},a),t),{lastUsed:new Date}):a);this.savedSearchesSubject.next(i),this.saveSearches()}getSavedSearchById(e){return this.savedSearchesSubject.value.find(t=>t.id===e)}useSavedSearch(e){this.getSavedSearchById(e)&&this.updateSavedSearch(e,{lastUsed:new Date})}getFavoritesByCategory(e){let t=this.favoritesSubject.value;return e?t.filter(o=>o.category===e):t}getRecentSavedSearches(e=5){return[...this.savedSearchesSubject.value].sort((t,o)=>(o.lastUsed?.getTime()||0)-(t.lastUsed?.getTime()||0)).slice(0,e)}clearAllFavorites(){this.favoritesSubject.next([]),this.saveFavorites()}clearAllSavedSearches(){this.savedSearchesSubject.next([]),this.saveSearches()}saveSearch(e){let t={id:`search_${Date.now()}`,name:e.name||"Recherche sans nom",query:JSON.stringify(e.filters||{}),filters:e.filters||{},createdAt:new Date,lastUsed:new Date},i=[...this.savedSearchesSubject.value,t];this.savedSearchesSubject.next(i),this.saveSearches()}isFavorite(e){return this.favoritesSubject.value.some(t=>t.id===e)}toggleFavorite(e){this.isFavorite(e)?this.removeFavorite(e):console.warn("Impossible de basculer en favori sans coordonn\xE9es. Utilisez addFavorite avec les coordonn\xE9es appropri\xE9es.")}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275prov=O({token:n,factory:n.\u0275fac,providedIn:"root"})}};var G=class n{constructor(){this.data=E($);this.dialogRef=E(U)}onConfirm(){this.dialogRef.close(!0)}onCancel(){this.dialogRef.close(!1)}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=k({type:n,selectors:[["app-confirm-dialog"]],decls:12,vars:5,consts:[["mat-dialog-title",""],["align","end"],["mat-button","",3,"click"],["mat-raised-button","",3,"click","color"]],template:function(t,o){t&1&&(_(0,"h2",0)(1,"mat-icon"),S(2,"warning"),h(),S(3),h(),_(4,"mat-dialog-content")(5,"p"),S(6),h()(),_(7,"mat-dialog-actions",1)(8,"button",2),F("click",function(){return o.onCancel()}),S(9),h(),_(10,"button",3),F("click",function(){return o.onConfirm()}),S(11),h()()),t&2&&(s(3),y(" ",o.data.title," "),s(3),j(o.data.message),s(3),y(" ",o.data.cancelText||"Annuler"," "),s(),D("color",o.data.confirmColor||"warn"),s(),y(" ",o.data.confirmText||"Confirmer"," "))},dependencies:[q,J,K,R,L,I,N,B],styles:["h2[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}h2[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#ff9800}mat-dialog-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;line-height:1.6}"]})}};var x=()=>[],W=()=>[1,2,3,4];function X(n,e){if(n&1&&r(0,"div",15),n&2){let t=e.$index,o=m(2);M("width",t===o.lines-1?60:100,"%")}}function Y(n,e){if(n&1&&(c(0,"div",1)(1,"div",6),r(2,"div",5),c(3,"div",7),r(4,"div",8)(5,"div",9),d()(),r(6,"div",10),c(7,"div",11),p(8,X,1,2,"div",12,f),d(),c(10,"div",13),r(11,"div",14)(12,"div",14),d()()),n&2){let t=m();s(8),v(u(0,x).constructor(t.lines))}}function Z(n,e){n&1&&r(0,"div",5)}function ee(n,e){n&1&&r(0,"div",19)}function te(n,e){if(n&1&&(c(0,"div",16),C(1,Z,1,0,"div",5),c(2,"div",17),r(3,"div",8)(4,"div",18),d(),C(5,ee,1,0,"div",19),d()),n&2){let t=m(2);s(),b(t.withAvatar?1:-1),s(4),b(t.withAction?5:-1)}}function ne(n,e){if(n&1&&p(0,te,6,2,"div",16,f),n&2){let t=m();v(u(0,x).constructor(t.count))}}function oe(n,e){n&1&&r(0,"div",15)}function ie(n,e){n&1&&r(0,"div",15)}function ae(n,e){if(n&1&&(c(0,"div",21),p(1,ie,1,0,"div",15,f),d()),n&2){let t=m(2);s(),v(u(0,x).constructor(t.count))}}function re(n,e){if(n&1&&(c(0,"div",2)(1,"div",20),p(2,oe,1,0,"div",15,f),d(),p(4,ae,3,1,"div",21,f),d()),n&2){let t=m();s(2),v(u(0,x).constructor(t.count)),s(2),v(u(1,x).constructor(t.rows))}}function se(n,e){n&1&&(c(0,"div",25),r(1,"div",26)(2,"div",15),d())}function ce(n,e){n&1&&(c(0,"div",3),r(1,"div",22),c(2,"div",23),r(3,"div",14)(4,"div",14),d(),c(5,"div",24),p(6,se,3,0,"div",25,P),d()()),n&2&&(s(6),v(u(0,W)))}function de(n,e){if(n&1&&r(0,"div",15),n&2){let t=e.$index,o=m(2);M("width",t===o.lines-1?60:100,"%")}}function le(n,e){if(n&1&&p(0,de,1,2,"div",12,f),n&2){let t=m();v(u(0,x).constructor(t.lines))}}function me(n,e){n&1&&r(0,"div",4)}function pe(n,e){n&1&&r(0,"div",5)}var H=class n{constructor(){this.variant="card";this.count=3;this.lines=3;this.rows=5;this.withAvatar=!0;this.withAction=!1}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=k({type:n,selectors:[["app-skeleton-loader"]],inputs:{variant:"variant",count:"count",lines:"lines",rows:"rows",withAvatar:"withAvatar",withAction:"withAction"},decls:8,vars:3,consts:[[1,"skeleton-wrapper"],[1,"skeleton-card"],[1,"skeleton-table"],[1,"skeleton-map"],[1,"skeleton","skeleton-circle"],[1,"skeleton","skeleton-avatar"],[1,"skeleton-header"],[1,"skeleton-text-group"],[1,"skeleton","skeleton-text","skeleton-text-title"],[1,"skeleton","skeleton-text","skeleton-text-subtitle"],[1,"skeleton","skeleton-image"],[1,"skeleton-content"],[1,"skeleton","skeleton-text",3,"width"],[1,"skeleton-actions"],[1,"skeleton","skeleton-button"],[1,"skeleton","skeleton-text"],[1,"skeleton-list-item"],[1,"skeleton-list-content"],[1,"skeleton","skeleton-text","skeleton-text-subtitle",2,"width","70%"],[1,"skeleton","skeleton-icon"],[1,"skeleton-table-header"],[1,"skeleton-table-row"],[1,"skeleton","skeleton-map-background"],[1,"skeleton-map-controls"],[1,"skeleton-map-legend"],[1,"skeleton-legend-item"],[1,"skeleton","skeleton-color"]],template:function(t,o){if(t&1&&(c(0,"div",0),C(1,Y,13,1,"div",1)(2,ne,2,1)(3,re,6,2,"div",2)(4,ce,8,1,"div",3)(5,le,2,1)(6,me,1,0,"div",4)(7,pe,1,0,"div",5),d()),t&2){let i;T("skeleton-"+o.variant),s(),b((i=o.variant)==="card"?1:i==="list"?2:i==="table"?3:i==="map"?4:i==="text"?5:i==="circle"?6:i==="avatar"?7:-1)}},dependencies:[A],styles:[".skeleton-wrapper[_ngcontent-%COMP%]{width:100%}.skeleton[_ngcontent-%COMP%]{background:linear-gradient(90deg,#f0f0f0,#f8f8f8,#f0f0f0);background-size:200% 100%;animation:_ngcontent-%COMP%_skeleton-loading 1.5s ease-in-out infinite;border-radius:4px}@keyframes _ngcontent-%COMP%_skeleton-loading{0%{background-position:200% 0}to{background-position:-200% 0}}.skeleton-card[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:1rem;box-shadow:0 2px 4px #0000001a}.skeleton-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;margin-bottom:1rem}.skeleton-text-group[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:.5rem}.skeleton-image[_ngcontent-%COMP%]{height:200px;margin-bottom:1rem}.skeleton-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;margin-bottom:1rem}.skeleton-text[_ngcontent-%COMP%]{height:12px;width:100%}.skeleton-text-title[_ngcontent-%COMP%]{height:16px;width:70%}.skeleton-text-subtitle[_ngcontent-%COMP%]{height:12px;width:50%}.skeleton-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;padding-top:1rem;border-top:1px solid #f0f0f0}.skeleton-button[_ngcontent-%COMP%]{height:36px;width:100px}.skeleton-list-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:1rem;border-bottom:1px solid #f0f0f0}.skeleton-list-content[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:.5rem}.skeleton-avatar[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;flex-shrink:0}.skeleton-icon[_ngcontent-%COMP%]{width:24px;height:24px;border-radius:50%;flex-shrink:0}.skeleton-table[_ngcontent-%COMP%]{width:100%}.skeleton-table-header[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(100px,1fr));gap:1rem;padding:1rem;background:#fafafa;border-radius:8px 8px 0 0}.skeleton-table-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(100px,1fr));gap:1rem;padding:1rem;border-bottom:1px solid #f0f0f0}.skeleton-map[_ngcontent-%COMP%]{position:relative;height:500px;border-radius:8px;overflow:hidden}.skeleton-map-background[_ngcontent-%COMP%]{width:100%;height:100%}.skeleton-map-controls[_ngcontent-%COMP%]{position:absolute;top:1rem;right:1rem;display:flex;gap:.5rem}.skeleton-map-legend[_ngcontent-%COMP%]{position:absolute;bottom:1rem;left:1rem;background:#fff;padding:1rem;border-radius:8px;display:flex;flex-direction:column;gap:.5rem;min-width:150px}.skeleton-legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.skeleton-color[_ngcontent-%COMP%]{width:20px;height:20px;border-radius:4px}.skeleton-circle[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%}@media(prefers-color-scheme:dark){.skeleton[_ngcontent-%COMP%]{background:linear-gradient(90deg,#2a2a2a,#353535,#2a2a2a)}.skeleton-card[_ngcontent-%COMP%]{background:#1e1e1e;box-shadow:0 2px 4px #0000004d}.skeleton-list-item[_ngcontent-%COMP%]{border-bottom-color:#2a2a2a}.skeleton-table-header[_ngcontent-%COMP%]{background:#252525}.skeleton-table-row[_ngcontent-%COMP%]{border-bottom-color:#2a2a2a}.skeleton-map-legend[_ngcontent-%COMP%]{background:#1e1e1e}}"],changeDetection:0})}};export{z as a,G as b,H as c};
