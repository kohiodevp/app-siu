import{a as Y}from"./chunk-YCUC7S3C.js";import{a as w,b as V}from"./chunk-MRX5LSGG.js";import{d as B,h as H,i as X}from"./chunk-M2B5FNU7.js";import{a as $}from"./chunk-OFBHONAA.js";import{b as G,i as Q}from"./chunk-YPBVTN56.js";import{a as D,b as E}from"./chunk-3WYC6ROS.js";import"./chunk-AC4QEAXS.js";import"./chunk-QLHDTFGW.js";import"./chunk-QDNYLZKO.js";import{a as y,b as M,c as v,d as O,f as _,h as P}from"./chunk-FY6NZ6SC.js";import{t as q}from"./chunk-4TEKNYBZ.js";import{a as S,b as A}from"./chunk-UUJ2B6HP.js";import{$ as U}from"./chunk-AQZ5PN4T.js";import"./chunk-NYFRATJG.js";import{p as b}from"./chunk-3AYM6UTQ.js";import{Cb as m,Db as h,Gb as N,Hb as R,Ib as c,Ic as u,Jb as a,Kb as n,Lb as l,Wb as F,Xa as s,Yb as g,ac as z,ba as k,bc as I,cc as L,ic as W,kc as o,lb as x,lc as f,mc as j,sa as p}from"./chunk-E7AQ6X4Y.js";import"./chunk-EQDQRRRY.js";function ne(i,t){if(i&1&&(a(0,"mat-icon"),o(1),n()),i&2){let e=g(2);s(),f(e.icon())}}function ie(i,t){if(i&1&&(a(0,"mat-card-title"),m(1,ne,2,1,"mat-icon"),o(2),n()),i&2){let e=g();s(),h(e.icon()?1:-1),s(),j(" ",e.title()," ")}}function re(i,t){if(i&1&&(a(0,"mat-card-subtitle"),o(1),n()),i&2){let e=g();s(),f(e.subtitle())}}function oe(i,t){if(i&1&&(a(0,"div",1),l(1,"apx-chart",4),n()),i&2){let e=g();s(),c("series",e.chartOptions().series)("chart",e.chartOptions().chart)("xaxis",e.chartOptions().xaxis)("yaxis",e.chartOptions().yaxis)("dataLabels",e.chartOptions().dataLabels)("plotOptions",e.chartOptions().plotOptions)("legend",e.chartOptions().legend)("fill",e.chartOptions().fill)("tooltip",e.chartOptions().tooltip)("stroke",e.chartOptions().stroke)("grid",e.chartOptions().grid)("markers",e.chartOptions().markers)("colors",e.chartOptions().colors)("labels",e.chartOptions().labels)}}function de(i,t){i&1&&(a(0,"div",2),l(1,"mat-spinner",5),a(2,"p"),o(3,"Chargement des donn\xE9es..."),n()())}function se(i,t){i&1&&(a(0,"div",3)(1,"mat-icon"),o(2,"bar_chart"),n(),a(3,"p"),o(4,"Aucune donn\xE9e disponible"),n()())}var T=class i{constructor(){this.title=u();this.subtitle=u();this.icon=u();this.loading=u(!1);this.chartOptions=u()}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275cmp=x({type:i,selectors:[["app-chart-wrapper"]],viewQuery:function(e,r){if(e&1&&z(w,5),e&2){let d;I(d=L())&&(r.chart=d.first)}},inputs:{title:[1,"title"],subtitle:[1,"subtitle"],icon:[1,"icon"],loading:[1,"loading"],chartOptions:[1,"chartOptions"]},decls:8,vars:5,consts:[[1,"chart-card"],[1,"chart-container"],[1,"loading-container"],[1,"no-data"],[3,"series","chart","xaxis","yaxis","dataLabels","plotOptions","legend","fill","tooltip","stroke","grid","markers","colors","labels"],["diameter","50"]],template:function(e,r){e&1&&(a(0,"mat-card",0)(1,"mat-card-header"),m(2,ie,3,2,"mat-card-title"),m(3,re,2,1,"mat-card-subtitle"),n(),a(4,"mat-card-content"),m(5,oe,2,14,"div",1)(6,de,4,0,"div",2)(7,se,5,0,"div",3),n()()),e&2&&(W("loading",r.loading()),s(2),h(r.title()?2:-1),s(),h(r.subtitle()?3:-1),s(2),h(!r.loading()&&r.chartOptions()?5:r.loading()?6:7))},dependencies:[b,V,w,P,y,v,_,O,M,A,S,E,D],styles:[".chart-card[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}.chart-card.loading[_ngcontent-%COMP%]{opacity:.7}mat-card-header[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:1.1rem;font-weight:500}mat-card-header[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#1976d2}mat-card-content[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center;padding:1rem}.chart-container[_ngcontent-%COMP%]{width:100%;height:100%}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:1rem;color:#0000008a}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.875rem}.no-data[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:.5rem;color:#00000061}.no-data[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;opacity:.3}.no-data[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.875rem}"],changeDetection:0})}};var ce=(i,t)=>t.value;function le(i,t){if(i&1&&(a(0,"mat-option",6),o(1),n()),i&2){let e=t.$implicit;c("value",e.value),s(),f(e.label)}}function pe(i,t){i&1&&(a(0,"div",7),l(1,"mat-progress-spinner",9),a(2,"p"),o(3,"Chargement des donn\xE9es analytiques..."),n()())}function me(i,t){if(i&1&&(a(0,"div",8)(1,"mat-card",10)(2,"mat-card-header")(3,"mat-card-title"),o(4,"R\xE9partition des Parcelles par Statut"),n(),a(5,"mat-card-subtitle"),o(6,"Distribution des parcelles selon leur statut actuel"),n()(),a(7,"mat-card-content"),l(8,"app-chart-wrapper",11),n()(),a(9,"mat-card",10)(10,"mat-card-header")(11,"mat-card-title"),o(12,"Tendance des Parcelles"),n(),a(13,"mat-card-subtitle"),o(14,"\xC9volution des cr\xE9ations et modifications de parcelles"),n()(),a(15,"mat-card-content"),l(16,"app-chart-wrapper",11),n()(),a(17,"mat-card",10)(18,"mat-card-header")(19,"mat-card-title"),o(20,"Types de Documents"),n(),a(21,"mat-card-subtitle"),o(22,"Distribution des documents par type"),n()(),a(23,"mat-card-content"),l(24,"app-chart-wrapper",11),n()(),a(25,"mat-card",10)(26,"mat-card-header")(27,"mat-card-title"),o(28,"Activit\xE9 Utilisateur"),n(),a(29,"mat-card-subtitle"),o(30,"Activit\xE9 moyenne par jour de la semaine"),n()(),a(31,"mat-card-content"),l(32,"app-chart-wrapper",11),n()(),a(33,"mat-card",10)(34,"mat-card-header")(35,"mat-card-title"),o(36,"Distribution G\xE9ographique"),n(),a(37,"mat-card-subtitle"),o(38,"R\xE9partition des parcelles par zone g\xE9ographique"),n()(),a(39,"mat-card-content"),l(40,"app-chart-wrapper",11),n()()()),i&2){let e=g();s(8),c("chartOptions",e.parcelStatusChart()),s(8),c("chartOptions",e.parcelTrendChart()),s(8),c("chartOptions",e.documentTypesChart()),s(8),c("chartOptions",e.userActivityChart()),s(8),c("chartOptions",e.geographicChart())}}var J=class i{constructor(){this.analyticsService=k(Y);this.loading=p(!1);this.timeRange=p("30");this.parcelStatusChart=p(void 0);this.parcelTrendChart=p(void 0);this.documentTypesChart=p(void 0);this.userActivityChart=p(void 0);this.geographicChart=p(void 0);this.timeRanges=[{value:"7",label:"7 derniers jours"},{value:"30",label:"30 derniers jours"},{value:"90",label:"90 derniers jours"},{value:"365",label:"1 an"}]}ngOnInit(){this.loadAnalytics()}onTimeRangeChange(){this.loadAnalytics()}loadAnalytics(){this.loading.set(!0),this.analyticsService.getAnalytics(this.timeRange()).subscribe({next:t=>{if(t&&t.length>0){let e=t[0];this.updateParcelStatusChart(e.parcelStatus),this.updateParcelTrendChart(e.parcelTrends),this.updateDocumentTypesChart(e.documentTypes),this.updateUserActivityChart(e.userActivity),this.updateGeographicChart(e.geographicDistribution)}else this.loadMockData();this.loading.set(!1)},error:t=>{console.error("Erreur lors du chargement des donn\xE9es analytiques:",t),this.loading.set(!1),this.loadMockData()}})}updateParcelStatusChart(t){let e=["Disponible","Occup\xE9","Contest\xE9","R\xE9serv\xE9"],r=[t.available||0,t.occupied||0,t.disputed||0,t.reserved||0];this.parcelStatusChart.set({series:r,chart:{type:"donut",height:320,fontFamily:"Roboto, sans-serif"},labels:e,colors:["#4caf50","#2196f3","#f44336","#ff9800"],legend:{position:"bottom"},dataLabels:{enabled:!0,formatter:d=>`${d.toFixed(1)}%`},tooltip:{y:{formatter:d=>`${d} parcelles`}}})}updateParcelTrendChart(t){let e=[],r=[],d=[];t.forEach(C=>{e.push(new Date(C.date).toLocaleDateString("fr-FR",{day:"numeric",month:"short"})),r.push(C.created||0),d.push(C.updated||0)}),this.parcelTrendChart.set({series:[{name:"Cr\xE9\xE9es",data:r},{name:"Modifi\xE9es",data:d}],chart:{type:"area",height:350,fontFamily:"Roboto, sans-serif",toolbar:{show:!0},zoom:{enabled:!0}},xaxis:{categories:e,labels:{rotate:-45}},yaxis:{title:{text:"Nombre de parcelles"}},dataLabels:{enabled:!1},stroke:{curve:"smooth",width:2},colors:["#4caf50","#2196f3"],fill:{type:"gradient",gradient:{shadeIntensity:1,opacityFrom:.7,opacityTo:.2}},legend:{position:"top"},grid:{borderColor:"#e0e0e0"}})}updateDocumentTypesChart(t){let e=t.map(d=>d.type),r=t.map(d=>d.count);this.documentTypesChart.set({series:[{name:"Documents",data:r}],chart:{type:"bar",height:350,fontFamily:"Roboto, sans-serif",toolbar:{show:!1}},xaxis:{categories:e,labels:{style:{fontSize:"12px"}}},yaxis:{title:{text:"Nombre de documents"}},plotOptions:{bar:{borderRadius:4,horizontal:!1,distributed:!0}},dataLabels:{enabled:!0,style:{colors:["#fff"]}},colors:["#2196f3","#4caf50","#ff9800","#f44336","#9c27b0","#607d8b"],legend:{show:!1},grid:{borderColor:"#e0e0e0"}})}updateUserActivityChart(t){let e=t.map(d=>d.day),r=t.map(d=>d.activity);this.userActivityChart.set({series:[{name:"Activit\xE9",data:r}],chart:{type:"line",height:280,fontFamily:"Roboto, sans-serif",toolbar:{show:!1}},xaxis:{categories:e},yaxis:{title:{text:"Actions utilisateur"}},stroke:{curve:"smooth",width:3},colors:["#1976d2"],dataLabels:{enabled:!1},markers:{size:5,hover:{size:7}},grid:{borderColor:"#e0e0e0"}})}updateGeographicChart(t){let e=t.map(d=>d.zone),r=t.map(d=>d.count);this.geographicChart.set({series:[{name:"Parcelles",data:r}],chart:{type:"radar",height:350,fontFamily:"Roboto, sans-serif",toolbar:{show:!1}},xaxis:{categories:e},colors:["#1976d2"],stroke:{width:2},fill:{opacity:.3},markers:{size:4},yaxis:{show:!0}})}loadMockData(){let t={available:42,occupied:28,disputed:8,reserved:22};this.updateParcelStatusChart(t)}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275cmp=x({type:i,selectors:[["app-analytics-dashboard"]],decls:16,vars:3,consts:[[1,"analytics-dashboard"],[1,"dashboard-header"],[1,"dashboard-title"],[1,"header-actions"],["appearance","outline",1,"time-range-select"],[3,"selectionChange","value"],[3,"value"],[1,"loading-container"],[1,"charts-grid"],["mode","indeterminate"],[1,"chart-card"],[3,"chartOptions"]],template:function(e,r){e&1&&(a(0,"div",0)(1,"header",1)(2,"h1",2)(3,"mat-icon"),o(4,"analytics"),n(),a(5,"span"),o(6,"Tableau de Bord Analytique"),n()(),a(7,"div",3)(8,"mat-form-field",4)(9,"mat-label"),o(10,"Plage de temps"),n(),a(11,"mat-select",5),F("selectionChange",function(C){return r.timeRange.set(C.value)}),N(12,le,2,2,"mat-option",6,ce),n()()()(),m(14,pe,4,0,"div",7),m(15,me,41,5,"div",8),n()),e&2&&(s(11),c("value",r.timeRange()),s(),R(r.timeRanges),s(2),h(r.loading()?14:-1),s(),h(r.loading()?-1:15))},dependencies:[b,P,y,v,_,O,M,U,A,S,X,Q,G,H,B,$,E,D,q,T],styles:[".analytics-dashboard[_ngcontent-%COMP%]{padding:24px;min-height:100vh;background-color:var(--mdc-theme-background, #f5f5f5)}.dashboard-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px;padding-bottom:16px;border-bottom:1px solid rgba(0,0,0,.12)}.dashboard-header[_ngcontent-%COMP%]   .dashboard-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin:0;font-size:24px;font-weight:500;color:var(--mdc-theme-on-surface, #000)}.dashboard-header[_ngcontent-%COMP%]   .dashboard-title[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--mdc-theme-primary, #1976d2)}.dashboard-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:center}.dashboard-header[_ngcontent-%COMP%]   .time-range-select[_ngcontent-%COMP%]{min-width:200px}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:48px 0}.loading-container[_ngcontent-%COMP%]   mat-progress-spinner[_ngcontent-%COMP%]{margin-bottom:16px}.charts-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(500px,1fr));gap:24px}@media(max-width:1200px){.charts-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.chart-card[_ngcontent-%COMP%]{box-shadow:0 2px 10px #0000000d;border-radius:8px;overflow:hidden}.chart-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{padding-bottom:8px}.chart-card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{font-size:18px;font-weight:500;color:var(--mdc-theme-on-surface, #000)}.chart-card[_ngcontent-%COMP%]   mat-card-subtitle[_ngcontent-%COMP%]{font-size:14px;color:var(--mdc-theme-on-surface-variant, #666)}.chart-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:0 16px 16px}@media(max-width:768px){.analytics-dashboard[_ngcontent-%COMP%]{padding:16px}.dashboard-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:16px}.dashboard-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{width:100%;justify-content:flex-end}.dashboard-header[_ngcontent-%COMP%]   .time-range-select[_ngcontent-%COMP%]{min-width:150px}.charts-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:16px}.chart-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:0 12px 12px}}"],changeDetection:0})}};export{J as AnalyticsDashboardComponent};
