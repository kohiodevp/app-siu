import{f as Lt}from"./chunk-5RY525K3.js";import{a as de}from"./chunk-ZQX6GPNJ.js";import{a as $t,b as qt,c as jt,d as Gt}from"./chunk-JRV6D33A.js";import{a as Vt,b as Bt,c as zt,d as At}from"./chunk-YHXWWA2F.js";import{a as me,b as Rt}from"./chunk-IN5CGMY2.js";import{a as Nt}from"./chunk-6Q4QUX6Y.js";import{a as mt,b as dt,c as st,d as pt,e as ut,g as _t}from"./chunk-X6CIBPON.js";import{c as vt}from"./chunk-HZBF5Z2J.js";import"./chunk-JO4DRFJG.js";import{b as Ot}from"./chunk-RHXYTOW7.js";import"./chunk-3I4VER4M.js";import{a as kt,b as ce,c as Ft}from"./chunk-YSK4XEVS.js";import{a as yt,b as Et,c as re,d as St,e as Dt,f as Tt,g as le}from"./chunk-ODKAJW66.js";import{a as It}from"./chunk-Q6MIBXXU.js";import{a as gt,b as ft}from"./chunk-TJHQUM2E.js";import{a as lt,b as ct}from"./chunk-EJWNUG5D.js";import{a as bt}from"./chunk-JFPH4BJU.js";import{d as xt,h as ht,i as Mt}from"./chunk-474YFGF3.js";import{b as ae,c as Pt,e as wt,f as N}from"./chunk-QVMFGACW.js";import"./chunk-CVA3OUYK.js";import{b as tt,c as nt}from"./chunk-JBX6OC6U.js";import{a as et}from"./chunk-V6MGZ35S.js";import{b as Je,c as Ke,d as Ye,e as Ze,f as Qe,i as Xe}from"./chunk-DEKAXLAX.js";import{a as it,b as ot}from"./chunk-GWNY4E3S.js";import{a as ee,b as te,c as ne,d as ie}from"./chunk-R265V6BS.js";import"./chunk-MXRZJWAE.js";import"./chunk-3FMCGYQ4.js";import{a as L}from"./chunk-ISPOGFK5.js";import{a as oe}from"./chunk-NQ5JYPMZ.js";import{a as Ct}from"./chunk-PY62MJCA.js";import{a as at,b as rt}from"./chunk-FJY5KO7T.js";import"./chunk-L64YGAYQ.js";import{a as W,b as J,c as K,d as He,e as Y,f as Z,g as We,h as Q}from"./chunk-HFRGPHGK.js";import{b as Ve,d as b,g as Be,h as ze,k as Ae,l as Le,m as Ne,n as Re,o as $e,p as qe,q as je,s as Ge,u as Ue}from"./chunk-M2VBT7VT.js";import{a as I,b as k}from"./chunk-STMJJCCP.js";import{a as Fe}from"./chunk-IE4XPFBV.js";import{$ as T,W as X,Y as D}from"./chunk-ZNVG5ZVS.js";import{a as Te,c as Ie,d as ke}from"./chunk-LMV7XNWS.js";import"./chunk-FBCHPQNP.js";import{n as De,p as S}from"./chunk-YGREV7VD.js";import{Cb as d,Db as s,Ec as E,Gb as w,Hb as O,Ib as C,Jb as i,Kb as n,Lb as h,Sb as M,Ua as be,Wb as g,Xa as l,Yb as m,ba as v,ga as u,gc as B,ha as _,hc as z,ic as A,kc as r,lb as y,lc as f,mc as x,nc as G,oa as R,oc as ye,pc as Ee,qc as Se,rb as $,sa as P,v as Oe,wc as U,yc as H}from"./chunk-E7AQ6X4Y.js";import{a as Pe,b as we}from"./chunk-EQDQRRRY.js";var Yt=(a,e)=>e.value,Zt=(a,e)=>e.id;function Qt(a,e){if(a&1){let t=M();i(0,"button",12),g("click",function(){u(t);let c=m();return _(c.requestUpload())}),i(1,"mat-icon"),r(2,"add"),n(),r(3," Ajouter des documents "),n()}}function Xt(a,e){if(a&1&&(i(0,"mat-chip-option",8),r(1),n()),a&2){let t=m().$implicit,o=m();C("value",t.value),l(),G(" ",t.label," (",o.documentCounts()[t.value],") ")}}function en(a,e){if(a&1&&d(0,Xt,2,3,"mat-chip-option",8),a&2){let t=e.$implicit,o=m();s(o.documentCounts()[t.value]>0?0:-1)}}function tn(a,e){a&1&&(i(0,"div",9),h(1,"mat-spinner",13),i(2,"p"),r(3,"Chargement des documents..."),n()())}function nn(a,e){if(a&1&&r(0),a&2){let t=m(2);x(' Aucun document de type "',t.getTypeLabel(t.selectedType()),'" ')}}function on(a,e){a&1&&r(0," Aucun document n'a \xE9t\xE9 ajout\xE9 pour cette parcelle ")}function an(a,e){if(a&1){let t=M();i(0,"button",12),g("click",function(){u(t);let c=m(2);return _(c.requestUpload())}),i(1,"mat-icon"),r(2,"add"),n(),r(3," Ajouter le premier document "),n()}}function rn(a,e){if(a&1&&(i(0,"div",10)(1,"mat-icon"),r(2,"folder_open"),n(),i(3,"h3"),r(4,"Aucun document"),n(),i(5,"p"),d(6,nn,1,1)(7,on,1,0),n(),d(8,an,4,0,"button",4),n()),a&2){let t=m();l(6),s(t.selectedType()?6:7),l(2),s(t.showUploadButton&&!t.selectedType()?8:-1)}}function ln(a,e){if(a&1&&h(0,"img",17),a&2){let t=m().$implicit;C("src","/api/documents/"+t.id+"/download",be)("alt",t.filename)}}function cn(a,e){if(a&1&&(i(0,"div",18)(1,"mat-icon",34),r(2),n()()),a&2){let t=m().$implicit,o=m(2);l(2),x(" ",o.getDocumentIcon(t)," ")}}function mn(a,e){if(a&1&&(i(0,"p",26),r(1),n()),a&2){let t=m().$implicit,o=m(2);l(),f(o.getDocumentDescription(t))}}function dn(a,e){if(a&1){let t=M();i(0,"mat-card",15)(1,"div",16),g("click",function(){let c=u(t).$implicit,p=m(2);return _(p.previewDocument(c))}),d(2,ln,1,2,"img",17)(3,cn,3,1,"div",18),i(4,"div",19)(5,"mat-icon"),r(6,"visibility"),n(),i(7,"span"),r(8,"Pr\xE9visualiser"),n()()(),i(9,"mat-card-content")(10,"div",20)(11,"h4",21),r(12),n(),i(13,"div",22)(14,"mat-chip",23)(15,"mat-icon"),r(16),n(),r(17),n(),i(18,"span",24)(19,"mat-icon"),r(20,"storage"),n(),r(21),n(),i(22,"span",25)(23,"mat-icon"),r(24,"calendar_today"),n(),r(25),n()(),d(26,mn,2,1,"p",26),n()(),i(27,"mat-card-actions")(28,"button",27),g("click",function(){let c=u(t).$implicit,p=m(2);return _(p.previewDocument(c))}),i(29,"mat-icon"),r(30,"visibility"),n()(),i(31,"button",28),g("click",function(){let c=u(t).$implicit,p=m(2);return _(p.downloadDocument(c))}),i(32,"mat-icon"),r(33,"download"),n()(),i(34,"button",29)(35,"mat-icon"),r(36,"more_vert"),n()(),i(37,"mat-menu",null,0)(39,"button",30),g("click",function(){let c=u(t).$implicit,p=m(2);return _(p.downloadDocument(c))}),i(40,"mat-icon"),r(41,"download"),n(),i(42,"span"),r(43,"T\xE9l\xE9charger"),n()(),i(44,"button",30),g("click",function(){let c=u(t).$implicit,p=m(2);return _(p.previewDocument(c))}),i(45,"mat-icon"),r(46,"visibility"),n(),i(47,"span"),r(48,"Pr\xE9visualiser"),n()(),h(49,"hr",31),i(50,"button",32),g("click",function(){let c=u(t).$implicit,p=m(2);return _(p.deleteDocument(c))}),i(51,"mat-icon",33),r(52,"delete"),n(),i(53,"span"),r(54,"Supprimer"),n()()()()()}if(a&2){let t=e.$implicit,o=B(38),c=m(2);A("is-image",c.documentService.isImage(t.mime_type)),l(2),s(c.documentService.isImage(t.mime_type)?2:3),l(9),C("matTooltip",t.filename),l(),x(" ",t.filename," "),l(2),C("color",c.getChipColor(t.document_type)),l(2),f(c.documentService.getDocumentIcon(t.document_type)),l(),x(" ",c.getTypeLabel(t.document_type)," "),l(4),x(" ",c.getFileSize(t.file_size)," "),l(4),x(" ",c.formatDate(t.uploaded_at)," "),l(),s(c.getDocumentDescription(t)?26:-1),l(8),C("matMenuTriggerFor",o)}}function sn(a,e){if(a&1&&(i(0,"div",11),w(1,dn,55,12,"mat-card",14,Zt),n()),a&2){let t=m();l(),O(t.filteredDocuments())}}var se=class a{constructor(){this.documentService=v(me);this.notificationService=v(Ct);this.dialog=v(re);this.showUploadButton=!0;this.uploadRequested=new R;this.documentDeleted=new R;this.documents=P([]);this.loading=P(!1);this.selectedType=P(null);this.documentTypes=[{value:"title_deed",label:"Titre de propri\xE9t\xE9"},{value:"survey_plan",label:"Plan cadastral"},{value:"building_permit",label:"Permis de construire"},{value:"tax_certificate",label:"Certificat fiscal"},{value:"photo",label:"Photo"},{value:"other",label:"Autre"}];this.filteredDocuments=E(()=>{let e=this.documents(),t=this.selectedType();return t?e.filter(o=>o.document_type===t):e});this.documentCounts=E(()=>{let e=this.documents();return{all:e.length,title_deed:e.filter(o=>o.document_type==="title_deed").length,survey_plan:e.filter(o=>o.document_type==="survey_plan").length,building_permit:e.filter(o=>o.document_type==="building_permit").length,tax_certificate:e.filter(o=>o.document_type==="tax_certificate").length,photo:e.filter(o=>o.document_type==="photo").length,other:e.filter(o=>o.document_type==="other").length}})}ngOnInit(){this.parcelId&&this.loadDocuments()}loadDocuments(){this.parcelId&&(this.loading.set(!0),this.documentService.getParcelDocuments(this.parcelId).subscribe({next:e=>{this.documents.set(e.items),this.loading.set(!1)},error:e=>{this.notificationService.error("Erreur lors du chargement des documents"),this.loading.set(!1),console.error("Error loading documents:",e)}}))}filterByType(e){this.selectedType.set(e)}downloadDocument(e){this.documentService.downloadDocument(e.id).subscribe({next:t=>{this.documentService.triggerDownload(t,e.filename),this.notificationService.success(`${e.filename} t\xE9l\xE9charg\xE9 avec succ\xE8s`)},error:t=>{this.notificationService.error("Erreur lors du t\xE9l\xE9chargement"),console.error("Error downloading document:",t)}})}previewDocument(e){this.dialog.open(de,{data:{documentId:e.id,filename:e.filename,mimeType:e.mime_type},width:"90vw",height:"90vh",maxWidth:"1400px",maxHeight:"900px",panelClass:"document-viewer-dialog"})}deleteDocument(e){confirm(`\xCAtes-vous s\xFBr de vouloir supprimer "${e.filename}" ?`)&&this.documentService.deleteDocument(e.id).subscribe({next:()=>{let t=this.documents().filter(o=>o.id!==e.id);this.documents.set(t),this.notificationService.success("Document supprim\xE9 avec succ\xE8s"),this.documentDeleted.emit(e.id)},error:t=>{this.notificationService.error("Erreur lors de la suppression"),console.error("Error deleting document:",t)}})}getDocumentIcon(e){return this.documentService.isImage(e.mime_type)?"image":this.documentService.isPdf(e.mime_type)?"picture_as_pdf":this.documentService.getDocumentIcon(e.document_type)}getChipColor(e){return{title_deed:"primary",survey_plan:"accent",building_permit:"warn",tax_certificate:"primary",photo:"accent",other:""}[e]||""}getFileSize(e){return this.documentService.formatFileSize(e)}formatDate(e){return new Date(e).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"})}getDocumentDescription(e){if("description"in e)return e.description}getTypeLabel(e){let t=this.documentTypes.find(o=>o.value===e);return t?t.label:e}requestUpload(){this.uploadRequested.emit()}getDocumentCount(e){return e?this.documentCounts()[e]||0:this.documentCounts().all}static{this.\u0275fac=function(t){return new(t||a)}}static{this.\u0275cmp=y({type:a,selectors:[["app-document-gallery"]],inputs:{parcelId:"parcelId",showUploadButton:"showUploadButton"},outputs:{uploadRequested:"uploadRequested",documentDeleted:"documentDeleted"},decls:23,vars:6,consts:[["menu","matMenu"],[1,"gallery-card"],[1,"doc-count"],[1,"header-actions"],["mat-raised-button","","color","primary"],["mat-icon-button","","matTooltip","Actualiser",3,"click"],[1,"filters"],[3,"change","value"],[3,"value"],[1,"loading-container"],[1,"empty-state"],[1,"documents-grid"],["mat-raised-button","","color","primary",3,"click"],["diameter","50"],[1,"document-card",3,"is-image"],[1,"document-card"],[1,"document-preview",3,"click"],["loading","lazy",3,"src","alt"],[1,"document-icon-container"],[1,"preview-overlay"],[1,"document-info"],[1,"document-title",3,"matTooltip"],[1,"document-meta"],[3,"color"],[1,"file-size"],[1,"upload-date"],[1,"document-description"],["mat-icon-button","","matTooltip","Pr\xE9visualiser",3,"click"],["mat-icon-button","","color","primary","matTooltip","T\xE9l\xE9charger",3,"click"],["mat-icon-button","","matTooltip","Plus d'actions",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],[2,"margin","16px 0","border","0","border-top","1px solid #e0e0e0"],["mat-menu-item","",1,"delete-action",3,"click"],["color","warn"],[1,"document-icon-large"]],template:function(t,o){t&1&&(i(0,"mat-card",1)(1,"mat-card-header")(2,"mat-card-title")(3,"mat-icon"),r(4,"folder"),n(),r(5," Documents de la parcelle "),i(6,"span",2),r(7),n()(),i(8,"div",3),d(9,Qt,4,0,"button",4),i(10,"button",5),g("click",function(){return o.loadDocuments()}),i(11,"mat-icon"),r(12,"refresh"),n()()()(),i(13,"mat-card-content")(14,"div",6)(15,"mat-chip-listbox",7),g("change",function(p){return o.filterByType(p.value)}),i(16,"mat-chip-option",8),r(17),n(),w(18,en,1,1,null,null,Yt),n()(),d(20,tn,4,0,"div",9)(21,rn,9,2,"div",10)(22,sn,3,0,"div",11),n()()),t&2&&(l(7),x("(",o.documentCounts().all,")"),l(2),s(o.showUploadButton?9:-1),l(6),C("value",o.selectedType()),l(),C("value",null),l(),x(" Tous (",o.documentCounts().all,") "),l(),O(o.documentTypes),l(2),s(o.loading()?20:o.filteredDocuments().length===0?21:22))},dependencies:[S,Q,W,Y,K,Z,J,T,D,X,k,I,N,ae,wt,Pt,ie,te,ee,ne,L,oe,le,ot,it],styles:[".gallery-card[_ngcontent-%COMP%]{margin:1rem 0}.gallery-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.gallery-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:1.25rem;font-weight:500}.gallery-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]   .doc-count[_ngcontent-%COMP%]{font-size:.9rem;color:#666;font-weight:400}.gallery-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.gallery-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:.25rem}.filters[_ngcontent-%COMP%]{margin-bottom:1.5rem}.filters[_ngcontent-%COMP%]   mat-chip-listbox[_ngcontent-%COMP%]   mat-chip-option[_ngcontent-%COMP%]{margin-right:.5rem;margin-bottom:.5rem}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:3rem;gap:1rem}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;margin:0}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:3rem;text-align:center;color:#666}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:4rem;width:4rem;height:4rem;color:#ccc;margin-bottom:1rem}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.25rem;margin:.5rem 0;color:#333}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.5rem 0 1.5rem;color:#666}.documents-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:1.5rem;padding:1rem 0}.document-card[_ngcontent-%COMP%]{position:relative;overflow:hidden;transition:all .3s ease;cursor:pointer}.document-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 8px 16px #00000026}.document-card[_ngcontent-%COMP%]:hover   .preview-overlay[_ngcontent-%COMP%]{opacity:1}.document-card[_ngcontent-%COMP%]   .document-preview[_ngcontent-%COMP%]{position:relative;width:100%;height:200px;overflow:hidden;background:linear-gradient(135deg,#667eea,#764ba2);display:flex;align-items:center;justify-content:center}.document-card[_ngcontent-%COMP%]   .document-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.document-card[_ngcontent-%COMP%]   .document-preview[_ngcontent-%COMP%]   .document-icon-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;height:100%}.document-card[_ngcontent-%COMP%]   .document-preview[_ngcontent-%COMP%]   .document-icon-container[_ngcontent-%COMP%]   .document-icon-large[_ngcontent-%COMP%]{font-size:5rem;width:5rem;height:5rem;color:#ffffffe6}.document-card[_ngcontent-%COMP%]   .document-preview[_ngcontent-%COMP%]   .preview-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:#000000b3;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:.5rem;opacity:0;transition:opacity .3s ease;color:#fff}.document-card[_ngcontent-%COMP%]   .document-preview[_ngcontent-%COMP%]   .preview-overlay[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:3rem;width:3rem;height:3rem}.document-card[_ngcontent-%COMP%]   .document-preview[_ngcontent-%COMP%]   .preview-overlay[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1rem;font-weight:500}.document-card.is-image[_ngcontent-%COMP%]   .document-preview[_ngcontent-%COMP%]{background:#000}.document-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:1rem}.document-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .document-info[_ngcontent-%COMP%]   .document-title[_ngcontent-%COMP%]{font-size:1rem;font-weight:500;margin:0 0 .75rem;color:#333;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.document-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .document-info[_ngcontent-%COMP%]   .document-meta[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;font-size:.85rem;color:#666}.document-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .document-info[_ngcontent-%COMP%]   .document-meta[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]{width:fit-content}.document-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .document-info[_ngcontent-%COMP%]   .document-meta[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1rem;width:1rem;height:1rem;margin-right:.25rem}.document-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .document-info[_ngcontent-%COMP%]   .document-meta[_ngcontent-%COMP%]   .file-size[_ngcontent-%COMP%], .document-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .document-info[_ngcontent-%COMP%]   .document-meta[_ngcontent-%COMP%]   .upload-date[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem}.document-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .document-info[_ngcontent-%COMP%]   .document-meta[_ngcontent-%COMP%]   .file-size[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .document-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .document-info[_ngcontent-%COMP%]   .document-meta[_ngcontent-%COMP%]   .upload-date[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1rem;width:1rem;height:1rem}.document-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .document-info[_ngcontent-%COMP%]   .document-description[_ngcontent-%COMP%]{margin-top:.75rem;font-size:.9rem;color:#666;line-height:1.4;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.document-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:.5rem;border-top:1px solid #e0e0e0}.document-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:last-child{margin-left:auto}.delete-action[_ngcontent-%COMP%]{color:#f44336}.delete-action[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#f44336}@media(max-width:768px){.documents-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.gallery-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:1rem}.gallery-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{width:100%;justify-content:space-between}.filters[_ngcontent-%COMP%]   mat-chip-listbox[_ngcontent-%COMP%]{flex-wrap:wrap}}@media(min-width:769px)and (max-width:1024px){.documents-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(250px,1fr))}}"],changeDetection:0})}};var pn=(a,e)=>e.value;function un(a,e){a&1&&(i(0,"mat-error"),r(1,"Le nom est requis"),n())}function _n(a,e){a&1&&(i(0,"mat-error"),r(1,"Le nom doit contenir au moins 3 caract\xE8res"),n())}function gn(a,e){a&1&&(i(0,"mat-error"),r(1,"Email invalide"),n())}function fn(a,e){if(a&1&&(i(0,"mat-option",9),r(1),n()),a&2){let t=e.$implicit;C("value",t.value),l(),f(t.label)}}function Cn(a,e){a&1&&(i(0,"mat-error"),r(1,"Le type de propri\xE9t\xE9 est requis"),n())}function xn(a,e){a&1&&(i(0,"mat-error"),r(1,"Le pourcentage est requis"),n())}function hn(a,e){a&1&&(i(0,"mat-error"),r(1,"Le pourcentage doit \xEAtre au moins 1%"),n())}function Mn(a,e){a&1&&(i(0,"mat-error"),r(1,"Le pourcentage ne peut pas d\xE9passer 100%"),n())}function vn(a,e){a&1&&(i(0,"mat-hint"),r(1,"Propri\xE9t\xE9 compl\xE8te = 100%"),n())}function Pn(a,e){a&1&&(i(0,"mat-error"),r(1,"La date de d\xE9but est requise"),n())}var q=class a{constructor(){this.dialogRef=v(yt);this.fb=v(Ge);this.data=v(Et);this.isEdit=P(!!this.data.owner);this.ownershipTypes=[{value:"full",label:"Propri\xE9t\xE9 compl\xE8te"},{value:"partial",label:"Propri\xE9t\xE9 partielle"},{value:"temporary",label:"Propri\xE9t\xE9 temporaire"}];let e=this.data.owner;this.ownerForm=this.fb.group({name:[e?.name||"",[b.required,b.minLength(3)]],contact:[e?.contact||"",[b.email]],ownership_type:[e?.ownership_type||"full",b.required],ownership_percentage:[e?.ownership_percentage||100,[b.required,b.min(1),b.max(100)]],start_date:[e?.start_date?new Date(e.start_date):new Date,b.required],end_date:[e?.end_date?new Date(e.end_date):null]}),this.ownerForm.get("ownership_type")?.valueChanges.subscribe(t=>{t==="full"&&this.ownerForm.patchValue({ownership_percentage:100})})}isFullOwnership(){return this.ownerForm.get("ownership_type")?.value==="full"}onSubmit(){if(this.ownerForm.valid){let e=this.ownerForm.value,t=we(Pe({},e),{start_date:e.start_date?.toISOString?.()||e.start_date,end_date:e.end_date?.toISOString?.()||e.end_date||null});this.dialogRef.close(t)}}onCancel(){this.dialogRef.close()}static{this.\u0275fac=function(t){return new(t||a)}}static{this.\u0275cmp=y({type:a,selectors:[["app-owner-dialog"]],decls:70,vars:20,consts:[["startPicker",""],["endPicker",""],["mat-dialog-title",""],[1,"owner-form",3,"formGroup"],["appearance","outline",1,"full-width"],["matInput","","formControlName","name","placeholder","Ex: Jean Dupont","required",""],["matPrefix",""],["matInput","","formControlName","contact","type","email","placeholder","email@exemple.com"],["formControlName","ownership_type","required",""],[3,"value"],["matInput","","formControlName","ownership_percentage","type","number","min","1","max","100","required","",3,"readonly"],["matSuffix",""],["matInput","","formControlName","start_date","required","",3,"matDatepicker"],["matSuffix","",3,"for"],["matInput","","formControlName","end_date",3,"matDatepicker"],["align","end"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click","disabled"]],template:function(t,o){if(t&1){let c=M();i(0,"h2",2)(1,"mat-icon"),r(2),n(),r(3),n(),i(4,"mat-dialog-content")(5,"form",3)(6,"mat-form-field",4)(7,"mat-label"),r(8,"Nom complet"),n(),h(9,"input",5),i(10,"mat-icon",6),r(11,"person"),n(),d(12,un,2,0,"mat-error"),d(13,_n,2,0,"mat-error"),n(),i(14,"mat-form-field",4)(15,"mat-label"),r(16,"Email (optionnel)"),n(),h(17,"input",7),i(18,"mat-icon",6),r(19,"email"),n(),d(20,gn,2,0,"mat-error"),n(),i(21,"mat-form-field",4)(22,"mat-label"),r(23,"Type de propri\xE9t\xE9"),n(),i(24,"mat-select",8),w(25,fn,2,2,"mat-option",9,pn),n(),i(27,"mat-icon",6),r(28,"home"),n(),d(29,Cn,2,0,"mat-error"),n(),i(30,"mat-form-field",4)(31,"mat-label"),r(32,"Pourcentage de propri\xE9t\xE9"),n(),h(33,"input",10),i(34,"mat-icon",6),r(35,"percent"),n(),i(36,"span",11),r(37,"%"),n(),d(38,xn,2,0,"mat-error"),d(39,hn,2,0,"mat-error"),d(40,Mn,2,0,"mat-error"),d(41,vn,2,0,"mat-hint"),n(),i(42,"mat-form-field",4)(43,"mat-label"),r(44,"Date de d\xE9but"),n(),h(45,"input",12)(46,"mat-datepicker-toggle",13)(47,"mat-datepicker",null,0),i(49,"mat-icon",6),r(50,"event"),n(),d(51,Pn,2,0,"mat-error"),n(),i(52,"mat-form-field",4)(53,"mat-label"),r(54,"Date de fin (optionnelle)"),n(),h(55,"input",14)(56,"mat-datepicker-toggle",13)(57,"mat-datepicker",null,1),i(59,"mat-icon",6),r(60,"event"),n(),i(61,"mat-hint"),r(62,"Laisser vide pour une propri\xE9t\xE9 sans date de fin"),n()()()(),i(63,"mat-dialog-actions",15)(64,"button",16),g("click",function(){return u(c),_(o.onCancel())}),r(65," Annuler "),n(),i(66,"button",17),g("click",function(){return u(c),_(o.onSubmit())}),i(67,"mat-icon"),r(68),n(),r(69),n()()}if(t&2){let c,p,F,V,Ce,xe,he,j,Me=B(48),ve=B(58);l(2),f(o.isEdit()?"edit":"person_add"),l(),x(" ",o.isEdit()?"Modifier":"Ajouter",` un propri\xE9taire
`),l(2),C("formGroup",o.ownerForm),l(7),s((c=o.ownerForm.get("name"))!=null&&c.hasError("required")&&((c=o.ownerForm.get("name"))!=null&&c.touched)?12:-1),l(),s((p=o.ownerForm.get("name"))!=null&&p.hasError("minlength")?13:-1),l(7),s((F=o.ownerForm.get("contact"))!=null&&F.hasError("email")&&((F=o.ownerForm.get("contact"))!=null&&F.touched)?20:-1),l(5),O(o.ownershipTypes),l(4),s((V=o.ownerForm.get("ownership_type"))!=null&&V.hasError("required")&&((V=o.ownerForm.get("ownership_type"))!=null&&V.touched)?29:-1),l(4),C("readonly",o.isFullOwnership()),l(5),s((Ce=o.ownerForm.get("ownership_percentage"))!=null&&Ce.hasError("required")?38:-1),l(),s((xe=o.ownerForm.get("ownership_percentage"))!=null&&xe.hasError("min")?39:-1),l(),s((he=o.ownerForm.get("ownership_percentage"))!=null&&he.hasError("max")?40:-1),l(),s(o.isFullOwnership()?41:-1),l(4),C("matDatepicker",Me),l(),C("for",Me),l(5),s((j=o.ownerForm.get("start_date"))!=null&&j.hasError("required")&&((j=o.ownerForm.get("start_date"))!=null&&j.touched)?51:-1),l(4),C("matDatepicker",ve),l(),C("for",ve),l(10),C("disabled",o.ownerForm.invalid),l(2),f(o.isEdit()?"save":"add"),l(),x(" ",o.isEdit()?"Enregistrer":"Ajouter"," ")}},dependencies:[S,Ue,Ae,Ve,Le,Be,ze,je,qe,$e,Re,Ne,le,St,Tt,Dt,T,D,et,Xe,Je,Ye,Ke,Ze,Qe,nt,tt,Mt,ht,xt,k,I,Gt,$t,qt,jt,vt],styles:["h2[mat-dialog-title][_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}h2[mat-dialog-title][_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:28px;width:28px;height:28px}mat-dialog-content[_ngcontent-%COMP%]{min-width:500px;max-width:600px;padding:1.5rem}.owner-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.full-width[_ngcontent-%COMP%]{width:100%}mat-dialog-actions[_ngcontent-%COMP%]{padding:1rem 1.5rem;gap:.5rem}mat-dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:.25rem}@media(max-width:600px){mat-dialog-content[_ngcontent-%COMP%]{min-width:auto;max-width:100%}}"],changeDetection:0})}};var wn=(a,e)=>e.id,On=(a,e)=>e.field,bn=(a,e)=>e.key;function yn(a,e){if(a&1&&(i(0,"div",1)(1,"mat-icon"),r(2,"history"),n(),i(3,"p"),r(4),n()()),a&2){let t=m();l(4),f(t.emptyMessage)}}function En(a,e){if(a&1&&(i(0,"p",12),r(1),n()),a&2){let t=m().$implicit;l(),f(t.description)}}function Sn(a,e){if(a&1&&(i(0,"mat-chip",13),r(1),n()),a&2){let t=m().$implicit;l(),f(t.type)}}function Dn(a,e){if(a&1&&(i(0,"div",18)(1,"span",19),r(2),n(),i(3,"div",20)(4,"span",21),r(5),n(),i(6,"mat-icon",22),r(7,"arrow_forward"),n(),i(8,"span",23),r(9),n()()()),a&2){let t=e.$implicit,o=m(5);l(2),x("",t.field,":"),l(3),f(o.formatValue(t.old)),l(4),f(o.formatValue(t.new))}}function Tn(a,e){if(a&1&&(i(0,"div",17),w(1,Dn,10,3,"div",18,On),n()),a&2){let t=m(2).$implicit,o=m(2);l(),O(o.getChangesArray(t.changes))}}function In(a,e){if(a&1){let t=M();i(0,"div",14)(1,"button",16),g("click",function(){u(t);let c=m().$implicit,p=m(2);return _(p.toggleChanges(c.id))}),i(2,"mat-icon"),r(3),n(),r(4," Voir les modifications "),n(),d(5,Tn,3,0,"div",17),n()}if(a&2){let t=m().$implicit,o=m(2);l(3),f(o.expandedItems.has(t.id)?"expand_less":"expand_more"),l(2),s(o.expandedItems.has(t.id)?5:-1)}}function kn(a,e){if(a&1&&(i(0,"span",24)(1,"strong"),r(2),n(),r(3),n()),a&2){let t=e.$implicit;l(2),x("",t.key,":"),l(),x(" ",t.value," ")}}function Fn(a,e){if(a&1&&(i(0,"div",15),w(1,kn,4,2,"span",24,bn),n()),a&2){let t=m().$implicit,o=m(2);l(),O(o.getMetadataArray(t.metadata))}}function Vn(a,e){if(a&1&&(i(0,"div",5),h(1,"div",6),i(2,"div",7)(3,"mat-icon"),r(4),n()(),i(5,"div",8)(6,"div",9)(7,"h4",10),r(8),n(),i(9,"span",11),r(10),n()(),d(11,En,2,1,"p",12),d(12,Sn,2,1,"mat-chip",13),d(13,In,6,2,"div",14),d(14,Fn,3,0,"div",15),n()()),a&2){let t=e.$implicit,o=e.$index,c=m(2);A("last",o===c.items.length-1),l(2),z("background-color",t.color||c.defaultColor),l(2),f(t.icon||c.defaultIcon),l(4),f(t.title),l(2),f(c.formatTime(t.timestamp)),l(),s(t.description?11:-1),l(),s(t.type?12:-1),l(),s(t.changes&&c.showChanges?13:-1),l(),s(t.metadata&&c.showMetadata?14:-1)}}function Bn(a,e){if(a&1){let t=M();i(0,"div",4)(1,"button",25),g("click",function(){u(t);let c=m(2);return _(c.onLoadMore())}),i(2,"mat-icon"),r(3,"expand_more"),n(),r(4," Charger plus "),n()()}}function zn(a,e){if(a&1&&(i(0,"div",2),w(1,Vn,15,11,"div",3,wn),n(),d(3,Bn,5,0,"div",4)),a&2){let t=m();l(),O(t.items),l(2),s(t.showLoadMore&&t.items.length>=t.pageSize?3:-1)}}var pe=class a{constructor(){this.items=[];this.defaultIcon="circle";this.defaultColor="#673ab7";this.emptyMessage="Aucun historique disponible";this.showChanges=!0;this.showMetadata=!1;this.showLoadMore=!1;this.pageSize=20;this.loadMore=new R;this.expandedItems=new Set}toggleChanges(e){this.expandedItems.has(e)?this.expandedItems.delete(e):this.expandedItems.add(e)}getChangesArray(e){return Object.entries(e).map(([t,o])=>({field:t,old:o.old,new:o.new}))}getMetadataArray(e){return!e||typeof e!="object"?[]:Object.entries(e).map(([t,o])=>({key:t,value:o}))}formatValue(e){return e==null?"N/A":typeof e=="object"?JSON.stringify(e):String(e)}formatTime(e){let t=new Date,o=new Date(e),c=t.getTime()-o.getTime(),p=Math.floor(c/6e4),F=Math.floor(c/36e5),V=Math.floor(c/864e5);return p<1?"\xC0 l'instant":p<60?`Il y a ${p} min`:F<24?`Il y a ${F}h`:V<7?`Il y a ${V}j`:o.toLocaleDateString("fr-FR",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}onLoadMore(){this.loadMore.emit()}static{this.\u0275fac=function(t){return new(t||a)}}static{this.\u0275cmp=y({type:a,selectors:[["app-timeline"]],inputs:{items:"items",defaultIcon:"defaultIcon",defaultColor:"defaultColor",emptyMessage:"emptyMessage",showChanges:"showChanges",showMetadata:"showMetadata",showLoadMore:"showLoadMore",pageSize:"pageSize"},outputs:{loadMore:"loadMore"},decls:3,vars:1,consts:[[1,"timeline-container"],[1,"empty-state"],[1,"timeline"],[1,"timeline-item",3,"last"],[1,"load-more"],[1,"timeline-item"],[1,"timeline-line"],[1,"timeline-dot"],[1,"timeline-content"],[1,"timeline-header"],[1,"timeline-title"],[1,"timeline-time"],[1,"timeline-description"],[1,"timeline-chip"],[1,"timeline-changes"],[1,"timeline-metadata"],["mat-button","",3,"click"],[1,"changes-list"],[1,"change-item"],[1,"field-name"],[1,"change-values"],[1,"old-value"],[1,"arrow"],[1,"new-value"],[1,"metadata-item"],["mat-button","","color","primary",3,"click"]],template:function(t,o){t&1&&(i(0,"div",0),d(1,yn,5,1,"div",1)(2,zn,4,1),n()),t&2&&(l(),s(o.items.length===0?1:2))},dependencies:[S,k,I,T,D,L,N,ae],styles:[".timeline-container[_ngcontent-%COMP%]{width:100%;padding:1rem 0}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:3rem;color:var(--text-secondary)}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;opacity:.3;margin-bottom:1rem}.timeline[_ngcontent-%COMP%]{position:relative;padding-left:3rem}.timeline-item[_ngcontent-%COMP%]{position:relative;padding-bottom:2rem}.timeline-item.last[_ngcontent-%COMP%]{padding-bottom:0}.timeline-line[_ngcontent-%COMP%]{position:absolute;left:-2.5rem;top:2rem;bottom:0;width:2px;background:var(--border-color)}.timeline-item.last[_ngcontent-%COMP%]   .timeline-line[_ngcontent-%COMP%]{display:none}.timeline-dot[_ngcontent-%COMP%]{position:absolute;left:-3rem;top:0;width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:#673ab7;box-shadow:0 2px 8px #0003;z-index:1}.timeline-dot[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#fff;font-size:20px;width:20px;height:20px}.timeline-content[_ngcontent-%COMP%]{background:var(--bg-primary);border:1px solid var(--border-color);border-radius:8px;padding:1rem;box-shadow:0 2px 4px #0000001a;transition:box-shadow .3s}.timeline-content[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #00000026}.timeline-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem;gap:1rem}.timeline-title[_ngcontent-%COMP%]{margin:0;font-size:1rem;font-weight:600;color:var(--text-primary)}.timeline-time[_ngcontent-%COMP%]{font-size:.75rem;color:var(--text-secondary);white-space:nowrap}.timeline-description[_ngcontent-%COMP%]{margin:.5rem 0;font-size:.875rem;color:var(--text-secondary);line-height:1.5}.timeline-chip[_ngcontent-%COMP%]{font-size:.75rem;height:24px;margin-top:.5rem}.timeline-changes[_ngcontent-%COMP%]{margin-top:1rem;border-top:1px solid var(--border-color);padding-top:1rem}.changes-list[_ngcontent-%COMP%]{margin-top:.5rem;padding:.5rem;background:var(--bg-secondary);border-radius:4px}.change-item[_ngcontent-%COMP%]{padding:.5rem;margin-bottom:.5rem}.change-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}.field-name[_ngcontent-%COMP%]{font-weight:600;color:var(--text-primary);display:block;margin-bottom:.25rem}.change-values[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;flex-wrap:wrap}.old-value[_ngcontent-%COMP%]{padding:.25rem .5rem;background:#f443361a;color:#f44336;border-radius:4px;font-size:.875rem;text-decoration:line-through}.new-value[_ngcontent-%COMP%]{padding:.25rem .5rem;background:#4caf501a;color:#4caf50;border-radius:4px;font-size:.875rem;font-weight:600}.arrow[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px;color:var(--text-secondary)}.timeline-metadata[_ngcontent-%COMP%]{margin-top:.5rem;padding:.5rem;background:var(--bg-tertiary);border-radius:4px;font-size:.75rem;display:flex;flex-wrap:wrap;gap:.5rem}.metadata-item[_ngcontent-%COMP%]{color:var(--text-secondary)}.load-more[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:1rem}@media(max-width:768px){.timeline[_ngcontent-%COMP%]{padding-left:2rem}.timeline-dot[_ngcontent-%COMP%]{left:-2.5rem;width:32px;height:32px}.timeline-dot[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.timeline-line[_ngcontent-%COMP%]{left:-2rem}.timeline-header[_ngcontent-%COMP%], .change-values[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}}"],changeDetection:0})}};var An=(a,e)=>e.id;function Ln(a,e){a&1&&(i(0,"div",2),h(1,"app-skeleton-loader",4)(2,"app-skeleton-loader",5)(3,"app-skeleton-loader",6),n()),a&2&&(l(2),C("count",2),l(),C("lines",3))}function Nn(a,e){if(a&1){let t=M();i(0,"button",46),g("click",function(){u(t);let c=m(2);return _(c.viewOnMap())}),i(1,"mat-icon"),r(2,"map"),n(),r(3," Voir sur la carte "),n()}}function Rn(a,e){if(a&1){let t=M();i(0,"button",47),g("click",function(){u(t);let c=m(2);return _(c.editParcel())}),i(1,"mat-icon"),r(2,"edit"),n(),r(3," Modifier "),n(),i(4,"button",48)(5,"mat-icon"),r(6,"more_vert"),n()(),i(7,"mat-menu",null,0)(9,"button",49),g("click",function(){u(t);let c=m(2);return _(c.deleteParcel())}),i(10,"mat-icon",50),r(11,"delete"),n(),i(12,"span"),r(13,"Supprimer la parcelle"),n()()()}if(a&2){let t=B(8);l(4),C("matMenuTriggerFor",t)}}function $n(a,e){a&1&&(i(0,"mat-icon"),r(1,"info"),n(),r(2," Informations "))}function qn(a,e){if(a&1&&(h(0,"mat-divider"),i(1,"mat-list-item")(2,"mat-icon",32),r(3,"map"),n(),i(4,"div",33),r(5,"Plan cadastral"),n(),i(6,"div",34),r(7),n()()),a&2){let t=m(2);l(7),f(t.parcel().cadastral_plan_ref)}}function jn(a,e){if(a&1&&(i(0,"mat-list-item")(1,"mat-icon",32),r(2,"my_location"),n(),i(3,"div",33),r(4,"Coordonn\xE9es GPS"),n(),i(5,"div",34),r(6),U(7,"number"),U(8,"number"),n()()),a&2){let t=m(2);l(6),G(" ",H(7,2,t.parcel().coordinates.lat,"1.6-6"),", ",H(8,5,t.parcel().coordinates.lng,"1.6-6")," ")}}function Gn(a,e){a&1&&(i(0,"mat-list-item")(1,"mat-icon",32),r(2,"location_off"),n(),i(3,"div",33),r(4,"Coordonn\xE9es GPS"),n(),i(5,"div",34),r(6,"Non renseign\xE9es"),n()())}function Un(a,e){if(a&1&&(h(0,"mat-divider"),i(1,"mat-list-item")(2,"mat-icon",32),r(3,"polygon"),n(),i(4,"div",33),r(5,"G\xE9om\xE9trie"),n(),i(6,"div",34),r(7),n()()),a&2){let t=m(2);l(7),f(t.parcel().geometry.type)}}function Hn(a,e){if(a&1&&(i(0,"div",36)(1,"h3"),r(2,"Description"),n(),i(3,"p",51),r(4),n()()),a&2){let t=m(2);l(4),f(t.parcel().description)}}function Wn(a,e){if(a&1&&(i(0,"mat-icon",52),r(1,"people"),n(),r(2," Propri\xE9taires ")),a&2){let t=m(2);C("matBadge",t.stats().totalOwners)}}function Jn(a,e){if(a&1){let t=M();i(0,"button",53),g("click",function(){u(t);let c=m(2);return _(c.addOwner())}),i(1,"mat-icon"),r(2,"person_add"),n(),r(3," Ajouter un propri\xE9taire "),n()}}function Kn(a,e){a&1&&h(0,"app-loading-spinner",39)}function Yn(a,e){if(a&1&&(i(0,"p",57)(1,"mat-icon"),r(2,"phone"),n(),r(3),n()),a&2){let t=m().$implicit;l(3),x(" ",t.contact," ")}}function Zn(a,e){if(a&1&&(i(0,"p",58)(1,"mat-icon"),r(2,"percent"),n(),r(3),n()),a&2){let t=m().$implicit;l(3),x(" ",t.ownership_percentage,"% de propri\xE9t\xE9 ")}}function Qn(a,e){if(a&1&&(h(0,"br"),r(1)),a&2){let t=m().$implicit,o=m(3);l(),x("Jusqu'au ",o.formatDate(t.end_date)," ")}}function Xn(a,e){if(a&1){let t=M();i(0,"mat-card-actions",60)(1,"button",61),g("click",function(){u(t);let c=m().$implicit,p=m(3);return _(p.editOwner(c))}),i(2,"mat-icon"),r(3,"edit"),n()(),i(4,"button",62),g("click",function(){u(t);let c=m().$implicit,p=m(3);return _(p.removeOwner(c))}),i(5,"mat-icon"),r(6,"person_remove"),n()()()}}function ei(a,e){if(a&1&&(i(0,"mat-card",54)(1,"mat-card-header")(2,"div",55)(3,"mat-icon"),r(4,"person"),n()(),i(5,"mat-card-title"),r(6),n(),i(7,"mat-card-subtitle")(8,"span",56),r(9),n()()(),i(10,"mat-card-content"),d(11,Yn,4,1,"p",57),d(12,Zn,4,1,"p",58),i(13,"p",59)(14,"mat-icon"),r(15,"event"),n(),r(16),d(17,Qn,2,1),n()(),d(18,Xn,7,0,"mat-card-actions",60),n()),a&2){let t=e.$implicit,o=m(3);l(6),f(t.name),l(2),z("background-color",o.getOwnershipTypeColor(t.ownership_type)),l(),x(" ",o.getOwnershipTypeLabel(t.ownership_type)," "),l(2),s(t.contact?11:-1),l(),s(t.ownership_percentage?12:-1),l(4),x(" Depuis le ",o.formatDate(t.start_date)," "),l(),s(t.end_date?17:-1),l(),s(o.isAdmin()?18:-1)}}function ti(a,e){if(a&1&&(i(0,"div",40),w(1,ei,19,9,"mat-card",54,An),n()),a&2){let t=m(2);l(),O(t.owners())}}function ni(a,e){if(a&1){let t=M();i(0,"button",53),g("click",function(){u(t);let c=m(3);return _(c.addOwner())}),r(1," Ajouter un propri\xE9taire "),n()}}function ii(a,e){if(a&1&&(i(0,"div",41)(1,"mat-icon"),r(2,"person_off"),n(),i(3,"p"),r(4,"Aucun propri\xE9taire enregistr\xE9 pour cette parcelle"),n(),d(5,ni,2,0,"button",38),n()),a&2){let t=m(2);l(5),s(t.isAdmin()?5:-1)}}function oi(a,e){if(a&1&&(i(0,"mat-icon",63),r(1,"description"),n(),r(2," Documents ")),a&2){let t=m(2);C("matBadge",t.stats().totalDocuments)}}function ai(a,e){if(a&1){let t=M();i(0,"button",53),g("click",function(){u(t);let c=m(2);return _(c.uploadDocument())}),i(1,"mat-icon"),r(2,"cloud_upload"),n(),r(3," T\xE9l\xE9charger un document "),n()}}function ri(a,e){a&1&&h(0,"app-loading-spinner",42)}function li(a,e){if(a&1){let t=M();i(0,"app-document-gallery",64),g("uploadRequested",function(){u(t);let c=m(2);return _(c.uploadDocument())})("documentDeleted",function(){u(t);let c=m(2);return _(c.loadDocuments(c.parcelId))}),n()}if(a&2){let t=m(2);C("parcelId",t.parcelId)("showUploadButton",t.isAdmin())}}function ci(a,e){if(a&1){let t=M();i(0,"button",53),g("click",function(){u(t);let c=m(3);return _(c.uploadDocument())}),r(1," T\xE9l\xE9charger un document "),n()}}function mi(a,e){if(a&1&&(i(0,"div",41)(1,"mat-icon"),r(2,"folder_open"),n(),i(3,"p"),r(4,"Aucun document associ\xE9 \xE0 cette parcelle"),n(),d(5,ci,2,0,"button",38),n()),a&2){let t=m(2);l(5),s(t.isAdmin()?5:-1)}}function di(a,e){if(a&1&&(i(0,"mat-icon",65),r(1,"history"),n(),r(2," Historique ")),a&2){let t=m(2);C("matBadge",t.stats().totalHistoryEvents)}}function si(a,e){a&1&&h(0,"app-loading-spinner",44)}function pi(a,e){if(a&1&&h(0,"app-timeline",45),a&2){let t=m(2);C("items",t.getTimelineItems())}}function ui(a,e){a&1&&(i(0,"div",41)(1,"mat-icon"),r(2,"history"),n(),i(3,"p"),r(4,"Aucun \xE9v\xE9nement dans l'historique"),n()())}function _i(a,e){if(a&1){let t=M();i(0,"div",7)(1,"div",8)(2,"button",9)(3,"mat-icon"),r(4,"arrow_back"),n()(),i(5,"div",10)(6,"div",11)(7,"h1"),r(8),n(),i(9,"button",12),g("click",function(){u(t);let c=m();return _(c.toggleFavorite())}),i(10,"mat-icon"),r(11),n()()(),i(12,"div",13)(13,"span",14)(14,"mat-icon"),r(15,"place"),n(),r(16),n()()()(),i(17,"div",15)(18,"button",16),g("click",function(){u(t);let c=m();return _(c.refreshParcel())}),i(19,"mat-icon"),r(20,"refresh"),n()(),i(21,"button",17),g("click",function(){u(t);let c=m();return _(c.shareParcel())}),i(22,"mat-icon"),r(23,"share"),n()(),i(24,"button",18),g("click",function(){u(t);let c=m();return _(c.printParcel())}),i(25,"mat-icon"),r(26,"print"),n()(),d(27,Nn,4,0,"button",19),d(28,Rn,14,1),n()(),i(29,"div",20)(30,"mat-card",21)(31,"mat-card-content")(32,"div",22)(33,"mat-icon"),r(34),n()(),i(35,"div",23)(36,"span",24),r(37,"Statut"),n(),i(38,"span",25),r(39),n()()()(),i(40,"mat-card",21)(41,"mat-card-content")(42,"div",22)(43,"mat-icon"),r(44,"square_foot"),n()(),i(45,"div",23)(46,"span",24),r(47,"Superficie"),n(),i(48,"span",25),r(49),U(50,"number"),n()()()(),i(51,"mat-card",21)(52,"mat-card-content")(53,"div",22)(54,"mat-icon"),r(55),n()(),i(56,"div",23)(57,"span",24),r(58,"Propri\xE9t\xE9"),n(),i(59,"span",25),r(60),n()()()(),i(61,"mat-card",21)(62,"mat-card-content")(63,"div",22)(64,"mat-icon"),r(65,"description"),n()(),i(66,"div",23)(67,"span",24),r(68,"Documents"),n(),i(69,"span",25),r(70),n()()()()(),i(71,"mat-card",26)(72,"mat-tab-group",27),Se("selectedIndexChange",function(c){u(t);let p=m();return Ee(p.selectedTab,c)||(p.selectedTab=c),_(c)}),g("selectedIndexChange",function(c){u(t);let p=m();return _(p.onTabChange(c))}),i(73,"mat-tab"),$(74,$n,3,0,"ng-template",28),i(75,"div",29)(76,"div",30)(77,"div",31)(78,"h3"),r(79,"Informations cadastrales"),n(),i(80,"mat-list")(81,"mat-list-item")(82,"mat-icon",32),r(83,"tag"),n(),i(84,"div",33),r(85,"R\xE9f\xE9rence cadastrale"),n(),i(86,"div",34),r(87),n()(),h(88,"mat-divider"),i(89,"mat-list-item")(90,"mat-icon",32),r(91,"location_city"),n(),i(92,"div",33),r(93,"Zone"),n(),i(94,"div",34),r(95),n()(),h(96,"mat-divider"),i(97,"mat-list-item")(98,"mat-icon",32),r(99,"category"),n(),i(100,"div",33),r(101,"Cat\xE9gorie"),n(),i(102,"div",34)(103,"span",35),r(104),n()()(),d(105,qn,8,1),n()(),i(106,"div",31)(107,"h3"),r(108,"Localisation"),n(),i(109,"mat-list"),d(110,jn,9,8,"mat-list-item")(111,Gn,7,0,"mat-list-item"),d(112,Un,8,1),n()(),d(113,Hn,5,1,"div",36),i(114,"div",36)(115,"h3"),r(116,"M\xE9tadonn\xE9es"),n(),i(117,"mat-list")(118,"mat-list-item")(119,"mat-icon",32),r(120,"schedule"),n(),i(121,"div",33),r(122,"Date de cr\xE9ation"),n(),i(123,"div",34),r(124),n()(),h(125,"mat-divider"),i(126,"mat-list-item")(127,"mat-icon",32),r(128,"update"),n(),i(129,"div",33),r(130,"Derni\xE8re modification"),n(),i(131,"div",34),r(132),n()()()()()()(),i(133,"mat-tab"),$(134,Wn,3,1,"ng-template",28),i(135,"div",29)(136,"div",37)(137,"h3"),r(138,"Liste des propri\xE9taires"),n(),d(139,Jn,4,0,"button",38),n(),d(140,Kn,1,0,"app-loading-spinner",39)(141,ti,3,0,"div",40)(142,ii,6,1,"div",41),n()(),i(143,"mat-tab"),$(144,oi,3,1,"ng-template",28),i(145,"div",29)(146,"div",37)(147,"h3"),r(148,"Documents associ\xE9s"),n(),d(149,ai,4,0,"button",38),n(),d(150,ri,1,0,"app-loading-spinner",42)(151,li,1,2,"app-document-gallery",43)(152,mi,6,1,"div",41),n()(),i(153,"mat-tab"),$(154,di,3,1,"ng-template",28),i(155,"div",29)(156,"h3"),r(157,"Historique des modifications"),n(),d(158,si,1,0,"app-loading-spinner",44)(159,pi,1,1,"app-timeline",45)(160,ui,5,0,"div",41),n()()()()}if(a&2){let t,o=m();l(8),f(o.parcel().reference),l(),A("active",o.isFavorite()),C("matTooltip",o.isFavorite()?"Retirer des favoris":"Ajouter aux favoris"),l(2),f(o.isFavorite()?"star":"star_border"),l(5),x(" ",o.parcel().address||"Adresse non renseign\xE9e"," "),l(11),s(o.hasCoordinates()||o.hasGeometry()?27:-1),l(),s(o.isAdmin()?28:-1),l(5),z("color",o.getStatusColor(o.parcel().status)),l(),x(" ",o.getStatusIcon(o.parcel().status)," "),l(5),f(o.getStatusLabel(o.parcel().status)),l(10),x(" ",o.parcel().area?H(50,35,o.parcel().area,"1.0-0")+" m\xB2":"N/A"," "),l(5),z("color",o.ownershipStatus().color),l(),f(o.ownershipStatus().icon),l(5),f(o.ownershipStatus().label),l(10),f(o.stats().totalDocuments),l(2),ye("selectedIndex",o.selectedTab),l(15),f(o.parcel().reference),l(8),f(o.parcel().zone||"Non d\xE9finie"),l(8),z("background-color",o.getCategoryColor(o.parcel().category)),l(),x(" ",o.getCategoryLabel(o.parcel().category)," "),l(),s(o.parcel().cadastral_plan_ref?105:-1),l(5),s((t=o.parcel().coordinates)!=null&&t.lat&&((t=o.parcel().coordinates)!=null&&t.lng)?110:111),l(2),s(o.hasGeometry()?112:-1),l(),s(o.parcel().description?113:-1),l(11),f(o.formatDate(o.parcel().created_at)),l(8),f(o.formatDate(o.parcel().updated_at)),l(7),s(o.isAdmin()?139:-1),l(),s(o.loadingOwners()?140:o.owners().length>0?141:142),l(9),s(o.isAdmin()?149:-1),l(),s(o.loadingDocuments()?150:o.documents().length>0?151:152),l(8),s(o.loadingHistory()?158:o.history().length>0?159:160)}}function gi(a,e){a&1&&(i(0,"div",3)(1,"mat-icon"),r(2,"error_outline"),n(),i(3,"h2"),r(4,"Parcelle introuvable"),n(),i(5,"p"),r(6,"La parcelle demand\xE9e n'existe pas ou a \xE9t\xE9 supprim\xE9e."),n(),i(7,"button",66),r(8," Retour \xE0 la liste "),n()())}var Ut=class a{constructor(){this.route=v(Te);this.router=v(Ie);this.parcelService=v(It);this.documentService=v(me);this.mapService=v(Nt);this.authService=v(Fe);this.favoritesService=v(kt);this.snackBar=v(at);this.dialog=v(re);this.isAdmin=this.authService.isAdmin;this.loading=P(!0);this.loadingDocuments=P(!1);this.loadingHistory=P(!1);this.loadingOwners=P(!1);this.parcel=P(null);this.documents=P([]);this.history=P([]);this.owners=P([]);this.showUploadForm=P(!1);this.isFavorite=P(!1);this.selectedTab=P(0);this.stats=E(()=>{let e=this.parcel();return{totalDocuments:this.documents().length,totalOwners:this.owners().length,totalHistoryEvents:this.history().length,lastModified:e?.updated_at||"",createdBy:"Admin"}});this.hasCoordinates=E(()=>{let e=this.parcel();return e&&e.coordinates&&e.coordinates.lat&&e.coordinates.lng});this.hasGeometry=E(()=>{let e=this.parcel();return e&&e.geometry});this.ownershipStatus=E(()=>{let e=this.owners().length;return e===0?{label:"Sans propri\xE9taire",color:"#9e9e9e",icon:"person_off"}:e===1?{label:"1 propri\xE9taire",color:"#4caf50",icon:"person"}:{label:`${e} propri\xE9taires`,color:"#2196f3",icon:"people"}});this.parcelId=null}ngOnInit(){let e=this.route.snapshot.paramMap.get("id");this.parcelId=e,this.loadParcelData(e),this.checkFavoriteStatus()}loadParcelData(e,t=0){this.loading.set(!0),Oe({parcel:this.parcelService.getParcel(e),documents:this.documentService.getParcelDocuments(e),history:this.parcelService.getParcelHistory(e)}).subscribe({next:o=>{this.parcel.set(o.parcel),this.documents.set(o.documents.items||[]),this.history.set(o.history.history||[]),o.parcel.owners?this.owners.set(o.parcel.owners):this.loadOwners(e),this.loading.set(!1)},error:o=>{this.loading.set(!1),console.error("Error loading parcel data:",o),t<2?(setTimeout(()=>{this.loadParcelData(e,t+1)},1e3*(t+1)),this.snackBar.open(`Erreur de chargement. Nouvelle tentative (${t+1}/2)...`,"Fermer",{duration:2e3})):(this.snackBar.open("Impossible de charger la parcelle. V\xE9rifiez votre connexion.","R\xE9essayer",{duration:5e3}).onAction().subscribe(()=>{this.loadParcelData(e,0)}),setTimeout(()=>{this.router.navigate(["/parcels"])},5e3))}})}loadOwners(e){this.loadingOwners.set(!0),this.parcelService.getOwners(e).subscribe({next:t=>{this.owners.set(t),this.loadingOwners.set(!1)},error:()=>{this.loadingOwners.set(!1),this.snackBar.open("Erreur lors du chargement des propri\xE9taires","Fermer",{duration:3e3})}})}checkFavoriteStatus(){this.parcelId&&this.isFavorite.set(this.favoritesService.isFavorite(`parcel_${this.parcelId}`))}addOwner(){if(!this.parcelId)return;this.dialog.open(q,{width:"600px",data:{parcelId:this.parcelId}}).afterClosed().subscribe(t=>{t&&this.parcelId&&this.parcelService.assignOwner(this.parcelId,t).subscribe({next:()=>{this.snackBar.open("Propri\xE9taire ajout\xE9 avec succ\xE8s","Fermer",{duration:3e3}),this.loadOwners(this.parcelId)},error:()=>{this.snackBar.open("Erreur lors de l'ajout du propri\xE9taire","Fermer",{duration:3e3})}})})}editOwner(e){if(!this.parcelId)return;this.dialog.open(q,{width:"600px",data:{owner:e,parcelId:this.parcelId}}).afterClosed().subscribe(o=>{o&&this.parcelId&&this.parcelService.updateOwner(this.parcelId,e.id,o).subscribe({next:()=>{this.snackBar.open("Propri\xE9taire modifi\xE9 avec succ\xE8s","Fermer",{duration:3e3}),this.loadOwners(this.parcelId)},error:c=>{console.error("Erreur lors de la modification:",c),this.snackBar.open("Erreur lors de la modification du propri\xE9taire","Fermer",{duration:3e3})}})})}removeOwner(e){if(!this.parcelId)return;this.dialog.open(ce,{data:{title:"Supprimer le propri\xE9taire",message:`\xCAtes-vous s\xFBr de vouloir retirer ${e.name} de la liste des propri\xE9taires ?`,confirmText:"Supprimer",cancelText:"Annuler"}}).afterClosed().subscribe(o=>{o&&this.parcelId&&this.parcelService.removeOwner(this.parcelId,e.id).subscribe({next:()=>{this.snackBar.open("Propri\xE9taire retir\xE9 avec succ\xE8s","Fermer",{duration:3e3}),this.loadOwners(this.parcelId)},error:()=>{this.snackBar.open("Erreur lors de la suppression du propri\xE9taire","Fermer",{duration:3e3})}})})}uploadDocument(){if(!this.parcelId)return;this.dialog.open(Rt,{width:"600px",data:{parcelId:this.parcelId}}).afterClosed().subscribe(t=>{t&&this.parcelId&&(this.snackBar.open("Document t\xE9l\xE9charg\xE9 avec succ\xE8s","Fermer",{duration:3e3}),this.loadDocuments(this.parcelId))})}loadDocuments(e){this.loadingDocuments.set(!0),this.documentService.getParcelDocuments(e).subscribe({next:t=>{this.documents.set(t.items),this.loadingDocuments.set(!1)},error:()=>{this.loadingDocuments.set(!1)}})}viewDocument(e){let t="application/octet-stream",o=e.filename.split(".").pop()?.toLowerCase();o==="pdf"?t="application/pdf":["jpg","jpeg","png","gif","bmp","webp"].includes(o||"")?t=`image/${o==="jpg"?"jpeg":o}`:(o==="tif"||o==="tiff")&&(t="image/tiff"),this.dialog.open(de,{width:"90vw",height:"90vh",maxWidth:"1400px",maxHeight:"900px",data:{documentId:e.id,filename:e.filename,mimeType:t}})}downloadDocument(e){this.documentService.downloadDocument(e.id).subscribe({next:t=>{this.documentService.triggerDownload(t,e.filename),this.snackBar.open("T\xE9l\xE9chargement d\xE9marr\xE9","Fermer",{duration:2e3})},error:()=>{this.snackBar.open("Erreur lors du t\xE9l\xE9chargement","Fermer",{duration:3e3})}})}deleteDocument(e){this.dialog.open(ce,{data:{title:"Supprimer le document",message:`\xCAtes-vous s\xFBr de vouloir supprimer "${e.filename}" ?`,confirmText:"Supprimer",confirmColor:"warn"}}).afterClosed().subscribe(o=>{o&&this.parcelId&&this.documentService.deleteDocument(e.id).subscribe({next:()=>{this.snackBar.open("Document supprim\xE9","Fermer",{duration:2e3}),this.loadDocuments(this.parcelId)},error:()=>{this.snackBar.open("Erreur lors de la suppression","Fermer",{duration:3e3})}})})}viewOnMap(){let e=this.parcel();e&&(e.coordinates?.lat&&e.coordinates?.lng?this.router.navigate(["/map"],{queryParams:{parcelId:e.id,lat:e.coordinates.lat,lng:e.coordinates.lng,zoom:16}}):(this.router.navigate(["/map"],{queryParams:{parcelId:e.id}}),this.snackBar.open("Cette parcelle n'a pas de coordonn\xE9es GPS","OK",{duration:3e3})))}editParcel(){this.parcelId&&this.router.navigate(["/parcels",this.parcelId,"edit"])}deleteParcel(){let e=this.parcel();if(!e)return;this.dialog.open(ce,{data:{title:"Supprimer la parcelle",message:`\xCAtes-vous s\xFBr de vouloir supprimer la parcelle ${e.reference} ?

Cette action est irr\xE9versible et supprimera \xE9galement tous les documents et l'historique associ\xE9s.`,confirmText:"Supprimer",cancelText:"Annuler",confirmColor:"warn"}}).afterClosed().subscribe(o=>{o&&this.parcelId&&this.parcelService.deleteParcel(this.parcelId).subscribe({next:()=>{this.snackBar.open("Parcelle supprim\xE9e avec succ\xE8s","Fermer",{duration:3e3}),this.router.navigate(["/parcels"])},error:c=>{console.error("Error deleting parcel:",c),this.snackBar.open("Erreur lors de la suppression de la parcelle","Fermer",{duration:3e3})}})})}refreshParcel(){this.parcelId&&(this.loadParcelData(this.parcelId),this.snackBar.open("Actualisation...","",{duration:1e3}))}toggleFavorite(){if(!this.parcelId)return;let e=`parcel_${this.parcelId}`;this.favoritesService.toggleFavorite(e);let t=this.favoritesService.isFavorite(e);this.isFavorite.set(t);let o=t?"Ajout\xE9 aux favoris":"Retir\xE9 des favoris";this.snackBar.open(o,"Fermer",{duration:2e3})}shareParcel(){let e=this.parcel();if(!e)return;let t=window.location.href;navigator.share?navigator.share({title:`Parcelle ${e.reference}`,text:`Consultez les d\xE9tails de la parcelle ${e.reference}`,url:t}).catch(()=>{this.copyToClipboard(t)}):this.copyToClipboard(t)}copyToClipboard(e){navigator.clipboard.writeText(e).then(()=>{this.snackBar.open("Lien copi\xE9 dans le presse-papier","Fermer",{duration:2e3})}).catch(()=>{this.snackBar.open("Erreur lors de la copie","Fermer",{duration:3e3})})}printParcel(){window.print()}getStatusLabel(e){return e?{available:"Disponible",occupied:"Occup\xE9",disputed:"Contest\xE9",reserved:"R\xE9serv\xE9"}[e]||e:"Non d\xE9fini"}getStatusColor(e){return e&&{available:"#4caf50",occupied:"#2196f3",disputed:"#f44336",reserved:"#ff9800"}[e]||"#9e9e9e"}getStatusIcon(e){return e&&{available:"check_circle",occupied:"home",disputed:"warning",reserved:"lock"}[e]||"help_outline"}getCategoryLabel(e){return e||"Non d\xE9fini"}getCategoryColor(e){return e&&{residential:"#3887be",commercial:"#bc3de3",industrial:"#ff8100",agricultural:"#8fa900","mixed-use":"#99008a","public-space":"#007d79",Habitation:"#3887be",CTOM:"#bc3de3"}[e]||"#9e9e9e"}getOwnershipTypeLabel(e){return{full:"Propri\xE9t\xE9 compl\xE8te",partial:"Propri\xE9t\xE9 partielle",temporary:"Propri\xE9t\xE9 temporaire"}[e]||e}getOwnershipTypeColor(e){return{full:"#4caf50",partial:"#ff9800",temporary:"#2196f3"}[e]||"#757575"}formatDate(e){return new Date(e).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}onTabChange(e){this.selectedTab.set(e)}toggleUploadForm(){this.showUploadForm.set(!this.showUploadForm())}onUploadComplete(){this.showUploadForm.set(!1),this.parcelId&&this.loadDocuments(this.parcelId)}getTimelineItems(){return this.history().map(e=>({id:e.id,timestamp:e.created_at,title:e.action_label||e.action,description:"",icon:this.getActionIcon(e.action),color:this.getActionColor(e.action),type:e.action,metadata:{user:e.user_name},changes:e.changes?this.convertChanges(e.changes):void 0}))}convertChanges(e){let t={};return e.forEach(o=>{t[o.field]={old:o.old_value,new:o.new_value}}),t}getActionIcon(e){return{created:"add_circle",updated:"edit",deleted:"delete",owner_added:"person_add",owner_removed:"person_remove"}[e]||"circle"}getActionColor(e){return{created:"#4caf50",updated:"#2196f3",deleted:"#f44336",owner_added:"#9c27b0",owner_removed:"#ff5722"}[e]||"#673ab7"}static{this.\u0275fac=function(t){return new(t||a)}}static{this.\u0275cmp=y({type:a,selectors:[["app-parcel-detail"]],decls:4,vars:1,consts:[["actionMenu","matMenu"],[1,"parcel-detail-container"],[1,"skeleton-container"],[1,"error-state"],["variant","card"],["variant","list",3,"count"],["variant","text",3,"lines"],[1,"detail-header"],[1,"header-content"],["mat-icon-button","","routerLink","/parcels",1,"back-button"],[1,"header-info"],[1,"title-row"],["mat-icon-button","",1,"favorite-btn",3,"click","matTooltip"],[1,"subtitle-info"],[1,"address"],[1,"header-actions"],["mat-icon-button","","matTooltip","Actualiser",3,"click"],["mat-icon-button","","matTooltip","Partager",3,"click"],["mat-icon-button","","matTooltip","Imprimer",3,"click"],["mat-button",""],[1,"quick-info-cards"],[1,"info-card"],[1,"info-icon"],[1,"info-details"],[1,"info-label"],[1,"info-value"],[1,"main-content"],["animationDuration","300ms",3,"selectedIndexChange","selectedIndex"],["mat-tab-label",""],[1,"tab-content"],[1,"info-grid"],[1,"info-section"],["matListItemIcon",""],["matListItemTitle",""],["matListItemLine",""],[1,"category-chip"],[1,"info-section","full-width"],[1,"section-header"],["mat-raised-button","","color","primary"],["message","Chargement des propri\xE9taires..."],[1,"owners-grid"],[1,"empty-state"],["message","Chargement des documents..."],[3,"parcelId","showUploadButton"],["message","Chargement de l'historique..."],[3,"items"],["mat-button","",3,"click"],["mat-button","","color","primary",3,"click"],["mat-icon-button","","color","warn",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["color","warn"],[1,"description-text"],["matBadgeColor","primary",3,"matBadge"],["mat-raised-button","","color","primary",3,"click"],[1,"owner-card"],["mat-card-avatar","",1,"owner-avatar"],[1,"ownership-badge"],[1,"owner-contact"],[1,"owner-percentage"],[1,"owner-dates"],["align","end"],["mat-icon-button","","matTooltip","Modifier",3,"click"],["mat-icon-button","","matTooltip","Retirer","color","warn",3,"click"],["matBadgeColor","accent",3,"matBadge"],[3,"uploadRequested","documentDeleted","parcelId","showUploadButton"],["matBadgeColor","warn",3,"matBadge"],["mat-raised-button","","color","primary","routerLink","/parcels"]],template:function(t,o){t&1&&(i(0,"div",1),d(1,Ln,4,2,"div",2)(2,_i,161,38)(3,gi,9,0,"div",3),n()),t&2&&(l(),s(o.loading()?1:o.parcel()?2:3))},dependencies:[S,ke,Q,W,Y,We,K,Z,He,J,T,D,X,k,I,At,Vt,Bt,zt,N,L,oe,rt,ct,lt,Ot,Lt,_t,pt,ut,st,dt,mt,ft,gt,ie,te,ee,ne,bt,se,pe,Ft,De],styles:[".parcel-detail-container[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto;padding:1rem}@media(max-width:768px){.parcel-detail-container[_ngcontent-%COMP%]{padding:.5rem}}.skeleton-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;padding:2rem}.detail-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:2rem;gap:1rem;flex-wrap:wrap}.detail-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:1rem;flex:1}.detail-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]{margin-top:.5rem}.detail-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-info[_ngcontent-%COMP%]{flex:1}.detail-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-info[_ngcontent-%COMP%]   .title-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-bottom:.5rem}.detail-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-info[_ngcontent-%COMP%]   .title-row[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:2rem;font-weight:500}.detail-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-info[_ngcontent-%COMP%]   .title-row[_ngcontent-%COMP%]   .favorite-btn[_ngcontent-%COMP%]{color:#9e9e9e;transition:color .2s}.detail-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-info[_ngcontent-%COMP%]   .title-row[_ngcontent-%COMP%]   .favorite-btn.active[_ngcontent-%COMP%], .detail-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-info[_ngcontent-%COMP%]   .title-row[_ngcontent-%COMP%]   .favorite-btn[_ngcontent-%COMP%]:hover{color:#ffc107}.detail-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-info[_ngcontent-%COMP%]   .subtitle-info[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem;color:#0009}.detail-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-info[_ngcontent-%COMP%]   .subtitle-info[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem}.detail-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-info[_ngcontent-%COMP%]   .subtitle-info[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.detail-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center;flex-wrap:wrap}.detail-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}@media(max-width:768px){.detail-header[_ngcontent-%COMP%]{flex-direction:column}.detail-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{width:100%}.detail-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{width:100%;justify-content:flex-start}}.quick-info-cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;margin-bottom:2rem}.quick-info-cards[_ngcontent-%COMP%]   .info-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:1rem!important}.quick-info-cards[_ngcontent-%COMP%]   .info-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .info-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:48px;height:48px;border-radius:50%;background-color:#673ab71a}.quick-info-cards[_ngcontent-%COMP%]   .info-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .info-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px;color:#673ab7}.quick-info-cards[_ngcontent-%COMP%]   .info-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .info-details[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:.25rem}.quick-info-cards[_ngcontent-%COMP%]   .info-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .info-details[_ngcontent-%COMP%]   .info-label[_ngcontent-%COMP%]{font-size:.75rem;color:#0009;text-transform:uppercase;letter-spacing:.5px}.quick-info-cards[_ngcontent-%COMP%]   .info-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .info-details[_ngcontent-%COMP%]   .info-value[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:500;color:#000000de}@media(max-width:768px){.quick-info-cards[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media(max-width:480px){.quick-info-cards[_ngcontent-%COMP%]{grid-template-columns:1fr}}.main-content[_ngcontent-%COMP%]{min-height:500px}.main-content[_ngcontent-%COMP%]   mat-tab-group[_ngcontent-%COMP%]     .mat-mdc-tab-label{min-width:120px}.main-content[_ngcontent-%COMP%]   mat-tab-group[_ngcontent-%COMP%]     .mat-mdc-tab-label mat-icon{margin-right:.5rem}.tab-content[_ngcontent-%COMP%]{padding:2rem}@media(max-width:768px){.tab-content[_ngcontent-%COMP%]{padding:1rem}}.tab-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1.5rem;font-size:1.25rem;font-weight:500}.section-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem;flex-wrap:wrap;gap:1rem}.section-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0}.info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:2rem}.info-grid[_ngcontent-%COMP%]   .info-section.full-width[_ngcontent-%COMP%]{grid-column:1/-1}.info-grid[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1rem;font-size:1rem;font-weight:500;color:#0009;text-transform:uppercase;letter-spacing:.5px}.info-grid[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   mat-list[_ngcontent-%COMP%]{padding:0}.info-grid[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]{height:auto!important;min-height:56px}.info-grid[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]   mat-icon[matListItemIcon][_ngcontent-%COMP%]{color:#673ab7}.info-grid[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .category-chip[_ngcontent-%COMP%]{display:inline-block;padding:.25rem .75rem;border-radius:12px;color:#fff;font-size:.75rem;font-weight:500}.info-grid[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .description-text[_ngcontent-%COMP%]{margin:0;line-height:1.6;color:#000000de}.owners-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:1.5rem}.owners-grid[_ngcontent-%COMP%]   .owner-card[_ngcontent-%COMP%]   .owner-avatar[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;background-color:#673ab7;color:#fff}.owners-grid[_ngcontent-%COMP%]   .owner-card[_ngcontent-%COMP%]   .owner-avatar[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px}.owners-grid[_ngcontent-%COMP%]   .owner-card[_ngcontent-%COMP%]   .ownership-badge[_ngcontent-%COMP%]{display:inline-block;padding:.25rem .5rem;border-radius:8px;color:#fff;font-size:.7rem;font-weight:500}.owners-grid[_ngcontent-%COMP%]   .owner-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding-top:1rem}.owners-grid[_ngcontent-%COMP%]   .owner-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin:.5rem 0;font-size:.9rem}.owners-grid[_ngcontent-%COMP%]   .owner-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;color:#0009}@media(max-width:768px){.owners-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4rem 2rem;text-align:center}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:5rem;width:5rem;height:5rem;color:#00000042;margin-bottom:1.5rem}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 2rem;color:#0009;max-width:400px}.empty-state[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.error-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4rem 2rem;text-align:center;min-height:400px}.error-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:6rem;width:6rem;height:6rem;color:#f44336;margin-bottom:1.5rem}.error-state[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:2rem;font-weight:400}.error-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 2rem;color:#0009;max-width:400px}@media print{.detail-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:none!important}.quick-info-cards[_ngcontent-%COMP%]{page-break-after:avoid}.main-content[_ngcontent-%COMP%]{box-shadow:none!important}.main-content[_ngcontent-%COMP%]     .mat-mdc-tab-header{display:none!important}.main-content[_ngcontent-%COMP%]     .mat-mdc-tab-body-wrapper{margin-top:0!important}.section-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], mat-card-actions[_ngcontent-%COMP%]{display:none!important}}@media(prefers-color-scheme:dark){.subtitle-info[_ngcontent-%COMP%], .info-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#ffffffb3!important}.info-section[_ngcontent-%COMP%]   .description-text[_ngcontent-%COMP%]{color:#ffffffde!important}.info-details[_ngcontent-%COMP%]   .info-label[_ngcontent-%COMP%]{color:#fff9!important}.info-details[_ngcontent-%COMP%]   .info-value[_ngcontent-%COMP%]{color:#ffffffde!important}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#ffffff4d!important}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#ffffffb3!important}}"],changeDetection:0})}};export{Ut as ParcelDetailComponent};
