import{a as F}from"./chunk-VUQ35JGS.js";import{b as N,f as R}from"./chunk-TC4NHXKF.js";import"./chunk-YPBVTN56.js";import{a as T,b as D}from"./chunk-3WYC6ROS.js";import{a as A}from"./chunk-4PMYLZD4.js";import"./chunk-XMY2MG46.js";import"./chunk-QDNYLZKO.js";import{a as E,h as S}from"./chunk-FY6NZ6SC.js";import"./chunk-4TEKNYBZ.js";import{a as H,b as z}from"./chunk-UUJ2B6HP.js";import{$ as k,W as I}from"./chunk-AQZ5PN4T.js";import{a as b,c as w}from"./chunk-JWWLDGKM.js";import"./chunk-NYFRATJG.js";import{k as v}from"./chunk-3AYM6UTQ.js";import{Cb as s,Db as p,Eb as O,Gb as _,Hb as C,Jb as i,Kb as n,Lb as h,Wb as x,Xa as c,Yb as g,ba as m,jc as u,kc as r,lb as P,lc as a,mc as M,sa as d,wc as f,yc as y}from"./chunk-E7AQ6X4Y.js";import"./chunk-EQDQRRRY.js";var $=(o,e)=>e.id;function j(o,e){o&1&&(i(0,"div",5),h(1,"mat-spinner"),i(2,"p"),r(3,"Chargement de l'historique..."),n()())}function B(o,e){o&1&&(i(0,"mat-card",6)(1,"mat-icon"),r(2,"inbox"),n(),i(3,"h3"),r(4,"Aucun historique"),n(),i(5,"p"),r(6,"Cette parcelle n'a pas encore d'historique d'\xE9v\xE9nements."),n()())}function G(o,e){if(o&1&&(i(0,"div",14)(1,"mat-icon"),r(2,"info"),n(),i(3,"span"),r(4),n()()),o&2){let t=g().$implicit;c(4),a(t.details)}}function J(o,e){if(o&1&&(i(0,"div",16)(1,"span",17),r(2),n(),i(3,"span",18),r(4),n(),i(5,"mat-icon"),r(6,"arrow_forward"),n(),i(7,"span",19),r(8),n()()),o&2){let t=e.$implicit;c(2),M("",t.field,":"),c(2),a(t.old_value||"Aucune"),c(4),a(t.new_value)}}function K(o,e){if(o&1&&(i(0,"div",15)(1,"h4"),r(2,"Modifications:"),n(),_(3,J,9,3,"div",16,O),n()),o&2){let t=g().$implicit;c(3),C(t.changes)}}function L(o,e){if(o&1&&(i(0,"div",9)(1,"div",10)(2,"mat-icon"),r(3),n()(),i(4,"mat-card",11)(5,"div",12)(6,"h3"),r(7),n(),i(8,"mat-chip"),r(9),f(10,"date"),n()(),i(11,"div",13)(12,"div",14)(13,"mat-icon"),r(14,"person"),n(),i(15,"span"),r(16),n()(),s(17,G,5,1,"div",14),n(),s(18,K,5,0,"div",15),n()()),o&2){let t=e.$implicit,l=g(2);u("color-"+l.getActionColor(t.action)),c(3),a(l.getActionIcon(t.action)),c(4),a(t.action_label),c(2),a(y(10,8,t.created_at,"dd/MM/yyyy HH:mm")),c(7),a(t.user_name),c(),p(t.details?17:-1),c(),p(t.changes&&t.changes.length>0?18:-1)}}function Q(o,e){if(o&1&&(i(0,"div",7),_(1,L,19,11,"div",8,$),n()),o&2){let t=g();c(),C(t.history())}}var q=class o{constructor(){this.parcelService=m(F);this.route=m(b);this.router=m(w);this.notificationService=m(A);this.loading=d(!1);this.parcelId=d("");this.history=d([]);this.parcelReference=d("")}ngOnInit(){let e=this.route.snapshot.paramMap.get("id");e&&(this.parcelId.set(e),this.loadHistory(e),this.loadParcelInfo(e))}loadParcelInfo(e){this.parcelService.getParcel(e).subscribe({next:t=>{this.parcelReference.set(t.reference_cadastrale)},error:t=>console.error("Error loading parcel:",t)})}loadHistory(e){this.loading.set(!0),this.parcelService.getParcelHistory(e).subscribe({next:t=>{this.history.set(t.history),this.loading.set(!1)},error:t=>{console.error("Error loading parcel history:",t),this.notificationService.showError("Erreur lors du chargement de l'historique."),this.loading.set(!1)}})}getActionIcon(e){return e.includes("created")||e.includes("Cr\xE9ation")?"add_circle":e.includes("updated")||e.includes("Modification")?"edit":e.includes("deleted")||e.includes("Suppression")?"delete":e.includes("owner_added")||e.includes("Attribution")?"person_add":e.includes("document_added")||e.includes("document")?"attach_file":e.includes("status_changed")?"label":"history"}getActionColor(e){return e.includes("created")||e.includes("Cr\xE9ation")?"success":e.includes("updated")||e.includes("Modification")?"primary":e.includes("deleted")||e.includes("Suppression")?"warn":e.includes("owner_added")||e.includes("Attribution")?"accent":e.includes("document")?"info":"default"}backToParcel(){this.router.navigate(["/parcels",this.parcelId()])}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275cmp=P({type:o,selectors:[["app-parcel-history"]],decls:15,vars:2,consts:[[1,"parcel-history-container"],[1,"page-header"],["mat-icon-button","",3,"click"],[1,"header-content"],[1,"subtitle"],[1,"loading"],[1,"empty-state"],[1,"timeline"],[1,"timeline-item",3,"class"],[1,"timeline-item"],[1,"timeline-marker"],[1,"timeline-content"],[1,"event-header"],[1,"event-details"],[1,"detail-row"],[1,"changes"],[1,"change-item"],[1,"field"],[1,"old-value"],[1,"new-value"]],template:function(t,l){t&1&&(i(0,"div",0)(1,"div",1)(2,"button",2),x("click",function(){return l.backToParcel()}),i(3,"mat-icon"),r(4,"arrow_back"),n()(),i(5,"div",3)(6,"h1")(7,"mat-icon"),r(8,"history"),n(),r(9," Historique de la parcelle "),n(),i(10,"p",4),r(11),n()()(),s(12,j,4,0,"div",5)(13,B,7,0,"mat-card",6)(14,Q,3,0,"div",7),n()),t&2&&(c(11),M("R\xE9f\xE9rence: ",l.parcelReference()),c(),p(l.loading()?12:l.history().length===0?13:14))},dependencies:[S,E,k,I,z,H,R,N,D,T,v],styles:['.parcel-history-container[_ngcontent-%COMP%]{padding:24px;max-width:1000px;margin:0 auto}.parcel-history-container[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;margin-bottom:32px}.parcel-history-container[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{flex:1}.parcel-history-container[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;font-size:24px;font-weight:500;margin:0 0 4px}.parcel-history-container[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--mat-primary-color)}.parcel-history-container[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{margin:0;color:var(--mat-text-secondary);font-size:14px}.parcel-history-container[_ngcontent-%COMP%]   .loading[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:64px;gap:16px}.parcel-history-container[_ngcontent-%COMP%]   .loading[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--mat-text-secondary)}.parcel-history-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:64px;text-align:center}.parcel-history-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:96px;width:96px;height:96px;color:var(--mat-text-disabled);margin-bottom:24px}.parcel-history-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 12px;font-size:24px;font-weight:500}.parcel-history-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:var(--mat-text-secondary)}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]{position:relative;padding-left:40px}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]:before{content:"";position:absolute;left:19px;top:0;bottom:0;width:2px;background-color:var(--mat-divider-color)}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]{position:relative;margin-bottom:32px}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .timeline-marker[_ngcontent-%COMP%]{position:absolute;left:-40px;top:8px;width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;background-color:var(--mat-card-background-color);border:2px solid var(--mat-primary-color);z-index:1}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .timeline-marker[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px;color:var(--mat-primary-color)}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item.color-success[_ngcontent-%COMP%]   .timeline-marker[_ngcontent-%COMP%]{border-color:#4caf50}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item.color-success[_ngcontent-%COMP%]   .timeline-marker[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#4caf50}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item.color-warn[_ngcontent-%COMP%]   .timeline-marker[_ngcontent-%COMP%]{border-color:#f44336}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item.color-warn[_ngcontent-%COMP%]   .timeline-marker[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#f44336}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item.color-accent[_ngcontent-%COMP%]   .timeline-marker[_ngcontent-%COMP%]{border-color:var(--mat-accent-color)}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item.color-accent[_ngcontent-%COMP%]   .timeline-marker[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--mat-accent-color)}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .timeline-content[_ngcontent-%COMP%]{padding:16px}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .timeline-content[_ngcontent-%COMP%]   .event-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;padding-bottom:12px;border-bottom:1px solid var(--mat-divider-color)}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .timeline-content[_ngcontent-%COMP%]   .event-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:500}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .timeline-content[_ngcontent-%COMP%]   .event-header[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]{font-size:12px}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .timeline-content[_ngcontent-%COMP%]   .event-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .timeline-content[_ngcontent-%COMP%]   .event-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:14px;color:var(--mat-text-primary)}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .timeline-content[_ngcontent-%COMP%]   .event-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;color:var(--mat-text-secondary)}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .timeline-content[_ngcontent-%COMP%]   .changes[_ngcontent-%COMP%]{margin-top:12px;padding-top:12px;border-top:1px solid var(--mat-divider-color)}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .timeline-content[_ngcontent-%COMP%]   .changes[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 8px;font-size:13px;font-weight:500;color:var(--mat-text-secondary)}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .timeline-content[_ngcontent-%COMP%]   .changes[_ngcontent-%COMP%]   .change-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px;background-color:var(--mat-table-row-hover-background-color);border-radius:4px;margin-bottom:4px;font-size:13px}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .timeline-content[_ngcontent-%COMP%]   .changes[_ngcontent-%COMP%]   .change-item[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{font-weight:500;color:var(--mat-primary-color)}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .timeline-content[_ngcontent-%COMP%]   .changes[_ngcontent-%COMP%]   .change-item[_ngcontent-%COMP%]   .old-value[_ngcontent-%COMP%]{color:var(--mat-text-secondary);text-decoration:line-through}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .timeline-content[_ngcontent-%COMP%]   .changes[_ngcontent-%COMP%]   .change-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px;color:var(--mat-text-secondary)}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .timeline-content[_ngcontent-%COMP%]   .changes[_ngcontent-%COMP%]   .change-item[_ngcontent-%COMP%]   .new-value[_ngcontent-%COMP%]{font-weight:500;color:#4caf50}@media(max-width:768px){.parcel-history-container[_ngcontent-%COMP%]{padding:16px}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]{padding-left:32px}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]:before{left:15px}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .timeline-marker[_ngcontent-%COMP%]{left:-32px;width:32px;height:32px}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .timeline-marker[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .timeline-content[_ngcontent-%COMP%]   .event-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:8px}.parcel-history-container[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .timeline-content[_ngcontent-%COMP%]   .changes[_ngcontent-%COMP%]   .change-item[_ngcontent-%COMP%]{flex-wrap:wrap}}'],changeDetection:0})}};export{q as ParcelHistoryComponent};
