import{a as ee}from"./chunk-YCUC7S3C.js";import{c as Gt}from"./chunk-RQXWK6VS.js";import{a as ie,b as ae}from"./chunk-MRX5LSGG.js";import"./chunk-BYAQRIZS.js";import{a as ne}from"./chunk-2XBNJKWF.js";import"./chunk-HZBF5Z2J.js";import"./chunk-PQNUUMDX.js";import{a as Xt,b as te}from"./chunk-JNBWNSPZ.js";import{b as Ut}from"./chunk-GZTPAS53.js";import{a as oe}from"./chunk-U4ARKFAA.js";import{d as Jt,g as Ht,h as Yt,i as Kt}from"./chunk-M2B5FNU7.js";import{f as Qt}from"./chunk-TC4NHXKF.js";import"./chunk-CVA3OUYK.js";import{b as zt,c as At}from"./chunk-E7OICD5F.js";import{a as kt}from"./chunk-OFBHONAA.js";import{b as Et,i as Dt}from"./chunk-YPBVTN56.js";import{b as Rt}from"./chunk-3WYC6ROS.js";import{a as jt,b as Bt,c as Zt,d as Vt}from"./chunk-QECNG6W7.js";import"./chunk-AC4QEAXS.js";import"./chunk-QLHDTFGW.js";import{a as qt}from"./chunk-TAVIRTLO.js";import{a as Wt}from"./chunk-RSTPHI64.js";import{a as R}from"./chunk-4PMYLZD4.js";import{b as Nt}from"./chunk-XMY2MG46.js";import"./chunk-QDNYLZKO.js";import{a as Mt,b as Pt,c as Ot,e as yt,f as St,h as wt}from"./chunk-FY6NZ6SC.js";import{b as ut,g as bt,h as ht,k as ft,m as _t,n as Ct,s as vt,u as xt}from"./chunk-4TEKNYBZ.js";import{a as $t,b as It}from"./chunk-UUJ2B6HP.js";import{a as gt}from"./chunk-XNCRNYUB.js";import{$ as Lt,W as Tt,Y as Ft}from"./chunk-AQZ5PN4T.js";import{c as mt,d as pt}from"./chunk-JWWLDGKM.js";import"./chunk-NYFRATJG.js";import{A as I,p as lt,v as dt}from"./chunk-3AYM6UTQ.js";import{B as w,Bb as it,Cb as p,D as K,Db as g,Ec as k,Fb as at,Gb as E,H as Q,Hb as D,Ib as f,Jb as i,Kb as n,Lb as C,M as T,O as X,R as tt,S as _,Sb as B,Wb as O,Xa as s,Y as F,Yb as v,ba as h,c as H,e as z,f as Y,ga as M,gc as ot,ha as P,hc as L,ic as rt,kc as a,l as S,lb as nt,lc as u,mc as x,nc as st,sa as b,tc as $,uc as ct,v as j,va as et,w as A}from"./chunk-E7AQ6X4Y.js";import{a as G,b as J}from"./chunk-EQDQRRRY.js";var N=class r{constructor(){this.http=h(dt);this.apiUrl=`${I.apiUrl}/api/dashboard`}getStats(){return this.statsCache$||(this.statsCache$=this.http.get(`${this.apiUrl}/stats`).pipe(X({bufferSize:1,refCount:!0}))),this.statsCache$}getStatsWithAutoRefresh(t=30){return A(0,t*1e3).pipe(tt(()=>(this.invalidateCache(),this.getStats())))}getSummary(){return this.http.get(`${this.apiUrl}/summary`)}getRecentActivity(t=20){return this.http.get(`${this.apiUrl}/activity`,{params:{limit:t.toString()}})}getParcelsByZoneChart(){return this.http.get(`${this.apiUrl}/charts/parcels-by-zone`)}getParcelsByCategoryChart(){return this.http.get(`${this.apiUrl}/charts/parcels-by-category`)}getDocumentsByTypeChart(){return this.http.get(`${this.apiUrl}/charts/documents-by-type`)}getTimeSeriesChart(t="30d",e="parcels"){return this.http.get(`${this.apiUrl}/charts/time-series`,{params:{period:t,metric:e}})}getTopZones(t=5){return this.http.get(`${this.apiUrl}/top-zones`,{params:{limit:t.toString()}})}invalidateCache(){this.statsCache$=void 0}static{this.\u0275fac=function(e){return new(e||r)}}static{this.\u0275prov=F({token:r,factory:r.\u0275fac,providedIn:"root"})}};var U=class r{constructor(){this.notificationService=h(R);this.socket=null;this.messageSubject=new z;this.notificationsSubject=new Y([]);this.connectionStatus=b("disconnected");this.messages$=this.messageSubject.asObservable();this.notifications$=this.notificationsSubject.asObservable();this.connect()}connect(){if(!(this.socket&&this.socket.readyState===WebSocket.OPEN))try{let t=I.wsUrl;if(!t){console.warn("\u26A0\uFE0F WebSocket URL not configured"),this.connectionStatus.set("disconnected");return}this.socket=new WebSocket(t),this.connectionStatus.set("connecting"),this.socket.onopen=()=>{console.log("\u2705 WebSocket connect\xE9"),this.connectionStatus.set("connected"),this.notificationService.show("Connect\xE9 au serveur en temps r\xE9el","success")},this.socket.onmessage=e=>{try{let o=JSON.parse(e.data);this.handleMessage(o)}catch(o){console.error("Erreur de parsing du message WebSocket:",o)}},this.socket.onerror=e=>{console.warn("\u26A0\uFE0F WebSocket non disponible"),this.connectionStatus.set("disconnected")},this.socket.onclose=e=>{console.log("\u2139\uFE0F WebSocket d\xE9connect\xE9 (mode polling uniquement)"),this.connectionStatus.set("disconnected")}}catch(t){console.warn("\u26A0\uFE0F WebSocket non disponible, utilisation du mode polling"),this.connectionStatus.set("disconnected")}}sendMessage(t){this.socket&&this.socket.readyState===WebSocket.OPEN?this.socket.send(JSON.stringify(t)):console.warn("WebSocket non connect\xE9, message non envoy\xE9:",t)}handleMessage(t){switch(this.messageSubject.next(t),t.type){case"parcel_update":this.handleParcelUpdate(t);break;case"alert":this.handleAlert(t);break;case"notification":this.handleNotification(t);break;case"user_action":this.handleUserAction(t);break;default:console.log("Message WebSocket re\xE7u:",t)}}handleParcelUpdate(t){let e=t.data;this.notificationService.show(`Parcelle ${e.reference} mise \xE0 jour`,"info")}handleAlert(t){let e=t.data,o=e.severity==="high"||e.severity==="critical"?"error":"warning";this.notificationService.show(e.message||"Alerte syst\xE8me",o)}handleNotification(t){let e={id:t.data.id||Date.now().toString(),type:t.data.type||"info",title:t.data.title||"Notification",message:t.data.message||"",timestamp:new Date(t.timestamp),read:!1,data:t.data},o=[...this.notificationsSubject.value];o.unshift(e),o.length>50&&o.splice(50),this.notificationsSubject.next(o),this.notificationService.show(e.message,e.type)}handleUserAction(t){let e=t.data,o=`${e.user} a ${e.action} ${e.target||"une parcelle"}`;this.notificationService.show(o,"info")}subscribeToChannel(t,e){let o={type:"subscribe",data:{channel:t,userId:e},timestamp:new Date().toISOString()};this.sendMessage(o)}unsubscribeFromChannel(t){let e={type:"unsubscribe",data:{channel:t},timestamp:new Date().toISOString()};this.sendMessage(e)}markAsRead(t){let e=[...this.notificationsSubject.value],o=e.find(c=>c.id===t);o&&(o.read=!0,this.notificationsSubject.next(e))}markAllAsRead(){let t=this.notificationsSubject.value.map(e=>J(G({},e),{read:!0}));this.notificationsSubject.next(t)}removeNotification(t){let e=this.notificationsSubject.value.filter(o=>o.id!==t);this.notificationsSubject.next(e)}getUnreadCount(){return this.notificationsSubject.value.filter(t=>!t.read).length}disconnect(){this.socket&&(this.socket.close(),this.socket=null,this.connectionStatus.set("disconnected"))}on(t){return new H(e=>{let o=this.messages$.subscribe(c=>{c.type===t&&e.next(c.data)});return()=>o.unsubscribe()})}static{this.\u0275fac=function(e){return new(e||r)}}static{this.\u0275prov=F({token:r,factory:r.\u0275fac,providedIn:"root"})}};var le=()=>({status:"disputed"}),ce=()=>[],de=r=>["/parcels",r],me=(r,t)=>t.label,pe=(r,t)=>t.id,ge=(r,t)=>t.name;function ue(r,t){r&1&&(i(0,"span",8)(1,"mat-icon",32),a(2,"sync"),n(),i(3,"span"),a(4,"Temps r\xE9el"),n()())}function be(r,t){r&1&&(i(0,"span",9)(1,"mat-icon",33),a(2,"sync_problem"),n(),i(3,"span"),a(4,"Connexion..."),n()())}function he(r,t){r&1&&(i(0,"span",10)(1,"mat-icon",33),a(2,"sync_disabled"),n(),i(3,"span"),a(4,"Hors ligne"),n()())}function fe(r,t){r&1&&(i(0,"button",14)(1,"mat-icon"),a(2,"add_circle"),n(),i(3,"span"),a(4,"Nouvelle parcelle"),n()())}function _e(r,t){if(r&1&&(i(0,"mat-option",28),a(1),n()),r&2){let e=t.$implicit;f("value",e),s(),u(e)}}function Ce(r,t){if(r&1){let e=B();i(0,"mat-card",30)(1,"mat-card-content")(2,"div",34)(3,"mat-icon",35),a(4,"error_outline"),n(),i(5,"div",36)(6,"h3"),a(7,"Une erreur est survenue"),n(),i(8,"p"),a(9),n()(),i(10,"button",37),O("click",function(){M(e);let c=v();return P(c.retryLoading())}),i(11,"mat-icon"),a(12,"refresh"),n(),a(13," R\xE9essayer "),n()()()()}if(r&2){let e=v();s(9),u(e.errorState().message)}}function ve(r,t){r&1&&(i(0,"div",31),C(1,"app-loading-spinner",38),n())}function xe(r,t){if(r&1&&(i(0,"span",66),a(1),n()),r&2){let e=v(3);s(),x("+",e.stats().newParcelsThisMonth)}}function Me(r,t){r&1&&(i(0,"div",70)(1,"button",87),a(2," Voir d\xE9tails "),n()()),r&2&&(s(),f("queryParams",$(1,le)))}function Pe(r,t){if(r&1&&(i(0,"div",41)(1,"mat-card",63)(2,"mat-card-content")(3,"div",64)(4,"div",65)(5,"mat-icon"),a(6,"terrain"),n()(),p(7,xe,2,1,"span",66),n(),i(8,"div",67)(9,"h2",68),a(10),n(),i(11,"p",69),a(12,"Total parcelles"),n()(),i(13,"div",70)(14,"button",71),a(15," Voir tout "),i(16,"mat-icon"),a(17,"arrow_forward"),n()()()()(),i(18,"mat-card",72)(19,"mat-card-content")(20,"div",64)(21,"div",73)(22,"mat-icon"),a(23,"check_circle"),n()(),i(24,"span",74),a(25),n()(),i(26,"div",67)(27,"h2",68),a(28),n(),i(29,"p",69),a(30,"Disponibles"),n()(),i(31,"div",75),C(32,"mat-progress-bar",76),n()()(),i(33,"mat-card",77)(34,"mat-card-content")(35,"div",64)(36,"div",78)(37,"mat-icon"),a(38,"person"),n()(),i(39,"span",74),a(40),n()(),i(41,"div",67)(42,"h2",68),a(43),n(),i(44,"p",69),a(45,"Occup\xE9es"),n()()()(),i(46,"mat-card",79)(47,"mat-card-content")(48,"div",64)(49,"div",80)(50,"mat-icon"),a(51,"warning"),n()()(),i(52,"div",67)(53,"h2",68),a(54),n(),i(55,"p",69),a(56,"Contest\xE9es"),n()(),p(57,Me,3,2,"div",70),n()(),i(58,"mat-card",81)(59,"mat-card-content")(60,"div",64)(61,"div",82)(62,"mat-icon"),a(63,"square_foot"),n()()(),i(64,"div",67)(65,"h2",68),a(66),n(),i(67,"p",69),a(68,"Surface totale"),n()(),i(69,"div",83)(70,"small"),a(71),n()()()(),i(72,"mat-card",84)(73,"mat-card-content")(74,"div",64)(75,"div",85)(76,"mat-icon"),a(77,"folder"),n()()(),i(78,"div",67)(79,"h2",68),a(80),n(),i(81,"p",69),a(82,"Documents"),n()(),i(83,"div",70)(84,"button",86),a(85," G\xE9rer "),i(86,"mat-icon"),a(87,"arrow_forward"),n()()()()()()),r&2){let e,o,c,l,m,y,Z,V,W,q,d=v(2);s(7),g((e=d.stats())!=null&&e.newParcelsThisMonth&&d.stats().newParcelsThisMonth>0?7:-1),s(3),u(d.formatLargeNumber((o=d.stats())==null?null:o.totalParcels)),s(15),x("",d.availablePercentage(),"%"),s(3),u(d.formatLargeNumber((c=d.stats())==null?null:c.availableParcels)),s(4),f("value",d.availablePercentage()),s(8),x(" ",d.getPercentage(((l=d.stats())==null?null:l.occupiedParcels)||0,((l=d.stats())==null?null:l.totalParcels)||0),"% "),s(3),u(d.formatLargeNumber((m=d.stats())==null?null:m.occupiedParcels)),s(11),u(d.formatLargeNumber((y=d.stats())==null?null:y.disputedParcels)),s(3),g((Z=d.stats())!=null&&Z.disputedParcels&&d.stats().disputedParcels>0?57:-1),s(9),u(d.formatArea((V=d.stats())==null?null:V.totalArea)),s(5),x("Moyenne: ",d.formatArea((W=d.stats())==null?null:W.averageArea)),s(9),u(d.formatLargeNumber((q=d.stats())==null?null:q.totalDocuments))}}function Oe(r,t){if(r&1&&(i(0,"div",45)(1,"div",88),C(2,"div",89),i(3,"span",90),a(4),n()(),i(5,"div",91),a(6),n(),i(7,"div",92),C(8,"div",93),n(),i(9,"div",94),a(10),n()()),r&2){let e=t.$implicit;s(2),L("background-color",e.color),s(2),u(e.label),s(2),u(e.value),s(2),L("width",e.percentage,"%")("background-color",e.color),s(2),x("",e.percentage,"%")}}function ye(r,t){if(r&1&&(i(0,"mat-card",48)(1,"mat-card-header")(2,"mat-card-title"),a(3,"Parcelles par cat\xE9gorie"),n()(),i(4,"mat-card-content"),C(5,"apx-chart",95),n()()),r&2){let e=t;s(5),f("series",e.series)("chart",e.chart)("labels",e.labels||$(7,ce))("colors",e.colors)("dataLabels",e.dataLabels)("legend",e.legend)("tooltip",e.tooltip)}}function Se(r,t){if(r&1&&(i(0,"mat-card",48)(1,"mat-card-header")(2,"mat-card-title"),a(3,"Parcelles par statut"),n()(),i(4,"mat-card-content"),C(5,"apx-chart",96),n()()),r&2){let e=t;s(5),f("series",e.series)("chart",e.chart)("labels",e.labels||$(6,ce))("colors",e.colors)("plotOptions",e.plotOptions)("legend",e.legend)}}function we(r,t){if(r&1&&(i(0,"mat-card",49)(1,"mat-card-header")(2,"mat-card-title"),a(3,"Parcelles par zone"),n()(),i(4,"mat-card-content"),C(5,"apx-chart",97),n()()),r&2){let e=t;s(5),f("series",e.series)("chart",e.chart)("xaxis",e.xaxis)("yaxis",e.yaxis)("colors",e.colors)("plotOptions",e.plotOptions)("dataLabels",e.dataLabels)}}function Ee(r,t){if(r&1&&(i(0,"mat-card",49)(1,"mat-card-header")(2,"mat-card-title"),a(3,"Distribution des surfaces"),n()(),i(4,"mat-card-content"),C(5,"apx-chart",98),n()()),r&2){let e=t;s(5),f("series",e.series)("chart",e.chart)("xaxis",e.xaxis)("yaxis",e.yaxis)("colors",e.colors)("stroke",e.stroke)("fill",e.fill)("dataLabels",e.dataLabels)}}function De(r,t){r&1&&(i(0,"span",51)(1,"mat-icon",99),a(2,"fiber_manual_record"),n(),a(3," LIVE "),n())}function ke(r,t){if(r&1&&(i(0,"span",106),a(1),n()),r&2){let e=v().$implicit;s(),x("Parcelle #",e.parcel_id)}}function ze(r,t){if(r&1&&(i(0,"div",100)(1,"div",101)(2,"mat-icon"),a(3),n()(),i(4,"div",102)(5,"div",103),a(6),n(),i(7,"div",104)(8,"span",105),a(9),n(),p(10,ke,2,1,"span",106),n()(),i(11,"button",107)(12,"mat-icon"),a(13,"arrow_forward"),n()()()),r&2){let e=t.$implicit,o=v(3);f("@fadeIn",void 0),s(3),u(e.action==="created"?"add":e.action==="updated"?"edit":"delete"),s(3),u(e.details||e.action),s(3),u(o.formatTimeAgo(e.timestamp)),s(),g(e.parcel_id?10:-1),s(),f("routerLink",ct(6,de,e.parcel_id))}}function Ae(r,t){if(r&1&&(i(0,"div",53),E(1,ze,14,8,"div",100,pe),n()),r&2){let e=v(2);s(),D(e.recentActivities())}}function Te(r,t){r&1&&(i(0,"div",54)(1,"mat-icon"),a(2,"inbox"),n(),i(3,"p"),a(4,"Aucune activit\xE9 r\xE9cente"),n()())}function Fe(r,t){if(r&1&&(i(0,"div",110)(1,"div",111),a(2),n(),i(3,"div",112)(4,"div",113),a(5),n(),i(6,"div",114),a(7),n()(),i(8,"div",115),C(9,"div",116),n()()),r&2){let e=t.$implicit,o=t.$index,c=v(3);s(2),u(o+1),s(3),u(e.name),s(2),x("",e.parcel_count," parcelles"),s(2),L("width",e.parcel_count/c.topZones()[0].parcel_count*100,"%")}}function Le(r,t){if(r&1&&(i(0,"section",56)(1,"h2",40)(2,"mat-icon"),a(3,"location_city"),n(),a(4," Top zones "),n(),i(5,"mat-card",108)(6,"mat-card-content")(7,"div",109),E(8,Fe,10,5,"div",110,ge),n()()()()),r&2){let e=v(2);s(8),D(e.topZones())}}function $e(r,t){r&1&&(i(0,"button",62)(1,"mat-icon"),a(2,"settings"),n(),i(3,"span"),a(4,"Administration"),n()())}function Ie(r,t){if(r&1&&(i(0,"section",39)(1,"h2",40)(2,"mat-icon"),a(3,"analytics"),n(),a(4," Vue d'ensemble "),n(),p(5,Pe,88,12,"div",41),n(),i(6,"section",42)(7,"h2",40)(8,"mat-icon"),a(9,"pie_chart"),n(),a(10," Distribution des statuts "),n(),i(11,"mat-card",43)(12,"mat-card-content")(13,"div",44),E(14,Oe,11,9,"div",45,me),n()()()(),i(16,"section",46)(17,"h2",40)(18,"mat-icon"),a(19,"bar_chart"),n(),a(20," Analyses graphiques "),n(),i(21,"div",47),p(22,ye,6,8,"mat-card",48),p(23,Se,6,7,"mat-card",48),p(24,we,6,7,"mat-card",49),p(25,Ee,6,8,"mat-card",49),n()(),i(26,"section",50)(27,"h2",40)(28,"mat-icon"),a(29,"history"),n(),a(30," Activit\xE9s r\xE9centes "),p(31,De,4,0,"span",51),n(),i(32,"mat-card",52)(33,"mat-card-content"),p(34,Ae,3,0,"div",53)(35,Te,5,0,"div",54),n(),i(36,"mat-card-actions")(37,"button",55),a(38,"Voir l'historique complet"),n()()()(),p(39,Le,10,0,"section",56),i(40,"section",57)(41,"h2",40)(42,"mat-icon"),a(43,"flash_on"),n(),a(44," Actions rapides "),n(),i(45,"div",58)(46,"button",59)(47,"mat-icon"),a(48,"map"),n(),i(49,"span"),a(50,"Carte interactive"),n()(),i(51,"button",60)(52,"mat-icon"),a(53,"search"),n(),i(54,"span"),a(55,"Recherche avanc\xE9e"),n()(),i(56,"button",61)(57,"mat-icon"),a(58,"assessment"),n(),i(59,"span"),a(60,"Rapports"),n()(),p(61,$e,5,0,"button",62),n()()),r&2){let e,o,c,l,m=v();s(5),g(m.stats()?5:-1),s(9),D(m.statusDistribution()),s(8),g((e=m.getChart("category"))?22:-1,e),s(),g((o=m.getChart("status"))?23:-1,o),s(),g((c=m.getChart("zone"))?24:-1,c),s(),g((l=m.getChart("area"))?25:-1,l),s(6),g(m.wsConnectionStatus()==="connected"?31:-1),s(3),g(m.recentActivities().length>0?34:35),s(5),g(m.topZones().length>0?39:-1),s(22),g(m.isAdmin()?61:-1)}}var se=class r{constructor(){this.analyticsService=h(ee);this.dashboardService=h(N);this.notificationService=h(R);this.authService=h(gt);this.userService=h(ne);this.websocketService=h(U);this.router=h(mt);this.fb=h(vt);this.destroy$=new z;this.refreshInterval$=A(0,3e4);this.loading=b(!1);this.initialLoading=b(!0);this.errorState=b({hasError:!1,message:"",retryCount:0});this.stats=b(null);this.currentUser=b(null);this.charts=b(new Map);this.recentActivities=b([]);this.topZones=b([]);this.selectedStatus=b("all");this.selectedZone=b("all");this.selectedPeriod=b("30d");this.availableZones=b([]);this.wsConnectionStatus=k(()=>this.websocketService.connectionStatus());this.filterForm=this.fb.group({startDate:[""],endDate:[""],category:[""],zone:[""],status:[""]});this.availablePercentage=k(()=>{let t=this.stats();return!t||t.totalParcels===0?0:Math.round(t.availableParcels/t.totalParcels*100)});this.statusDistribution=k(()=>{let t=this.stats();if(!t)return[];let e=t.totalParcels;return[{label:"Disponible",value:t.availableParcels,color:"#4CAF50",percentage:this.getPercentage(t.availableParcels,e)},{label:"Occup\xE9e",value:t.occupiedParcels,color:"#2196F3",percentage:this.getPercentage(t.occupiedParcels,e)},{label:"Contest\xE9e",value:t.disputedParcels,color:"#FF9800",percentage:this.getPercentage(t.disputedParcels,e)},{label:"R\xE9serv\xE9e",value:t.reservedParcels,color:"#9C27B0",percentage:this.getPercentage(t.reservedParcels,e)}]});this.hasData=k(()=>{let t=this.stats();return t!==null&&t.totalParcels>0});et(()=>{let t=this.wsConnectionStatus();console.log("WebSocket status changed:",t)})}ngOnInit(){this.initializeDashboard(),this.setupWebSocketListeners(),this.setupFilterListeners(),this.setupAutoRefresh()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}initializeDashboard(){this.initialLoading.set(!0),this.loadCurrentUser(),this.loadAvailableZones(),this.loadAllDashboardData()}loadAvailableZones(){this.analyticsService.getParcelsByZone().pipe(_(this.destroy$)).subscribe({next:t=>{t.labels&&t.labels.length>0&&this.availableZones.set(t.labels)},error:t=>{console.error("Error loading zones:",t),this.availableZones.set(["Zone A","Zone B","Zone C"])}})}loadAllDashboardData(){this.loading.set(!0),this.errorState.set({hasError:!1,message:"",retryCount:0});let t=this.buildFilters();j({stats:this.analyticsService.getDashboardStats(t).pipe(T(2),w(e=>(console.error("Error loading stats:",e),S(null)))),activities:this.dashboardService.getRecentActivity(10).pipe(T(2),w(e=>(console.error("Error loading activities:",e),S({activities:[],total:0})))),topZones:this.dashboardService.getTopZones(5).pipe(T(2),w(e=>(console.error("Error loading zones:",e),S({zones:[],total:0}))))}).pipe(_(this.destroy$)).subscribe({next:e=>{e.stats&&this.stats.set(e.stats),this.recentActivities.set(e.activities.activities),this.topZones.set(e.topZones.zones),this.loading.set(!1),this.initialLoading.set(!1),this.loadAllCharts(t)},error:e=>{this.handleError("Erreur lors du chargement des donn\xE9es",e)}})}loadAllCharts(t){j({parcelsByCategory:this.analyticsService.getParcelsByCategory(t),parcelsByStatus:this.analyticsService.getParcelsByStatus(t),parcelsByZone:this.analyticsService.getParcelsByZone(t),areaDistribution:this.analyticsService.getAreaDistribution(t)}).pipe(_(this.destroy$),w(e=>(console.error("Error loading charts:",e),S(null)))).subscribe(e=>{if(!e)return;let o=new Map;e.parcelsByCategory&&o.set("category",this.createPieChart(e.parcelsByCategory,"Parcelles par cat\xE9gorie")),e.parcelsByStatus&&o.set("status",this.createDonutChart(e.parcelsByStatus,"Parcelles par statut")),e.parcelsByZone&&o.set("zone",this.createBarChart(e.parcelsByZone,"Parcelles par zone")),e.areaDistribution&&o.set("area",this.createAreaChart(e.areaDistribution,"Distribution des surfaces")),this.charts.set(o)})}createPieChart(t,e){return{chart:{type:"pie",height:350,animations:{enabled:!0,easing:"easeinout",speed:800}},series:t.datasets[0]?.data||[],labels:t.labels,title:e,colors:["#4CAF50","#2196F3","#FF9800","#9C27B0","#F44336","#00BCD4"],dataLabels:{enabled:!0,formatter:o=>`${o.toFixed(1)}%`},legend:{position:"bottom",horizontalAlign:"center"},tooltip:{y:{formatter:o=>`${o} parcelles`}}}}createDonutChart(t,e){return{chart:{type:"donut",height:350,animations:{enabled:!0,easing:"easeinout",speed:800}},series:t.datasets[0]?.data||[],labels:t.labels,title:e,colors:["#4CAF50","#2196F3","#FF9800","#9C27B0"],dataLabels:{enabled:!0},legend:{position:"bottom"},plotOptions:{pie:{donut:{size:"65%",labels:{show:!0,total:{show:!0,label:"Total",formatter:()=>(t.datasets[0]?.data.reduce((c,l)=>c+l,0)||0).toString()}}}}}}}createBarChart(t,e){return{chart:{type:"bar",height:350,toolbar:{show:!0,tools:{download:!0,zoom:!0,pan:!0}}},series:[{name:t.datasets[0]?.label||"Parcelles",data:t.datasets[0]?.data||[]}],title:e,colors:["#2196F3"],xaxis:{categories:t.labels,labels:{rotate:-45,rotateAlways:!0}},yaxis:{title:{text:"Nombre de parcelles"}},plotOptions:{bar:{borderRadius:4,horizontal:!1,columnWidth:"60%"}},dataLabels:{enabled:!1}}}createAreaChart(t,e){return{chart:{type:"area",height:350,zoom:{enabled:!0},toolbar:{show:!0}},series:t.datasets.map(o=>({name:o.label,data:o.data})),title:e,colors:["#00BCD4","#4CAF50","#FF9800"],xaxis:{categories:t.labels,labels:{rotate:-45}},yaxis:{title:{text:"Surface (m\xB2)"},labels:{formatter:o=>this.formatArea(o)}},dataLabels:{enabled:!1},stroke:{curve:"smooth",width:2},fill:{type:"gradient",gradient:{shadeIntensity:1,opacityFrom:.7,opacityTo:.3}}}}setupWebSocketListeners(){this.websocketService.connect(),this.websocketService.on("parcel_updated").pipe(_(this.destroy$)).subscribe(()=>{console.log("Parcel updated - refreshing stats"),this.refreshData()}),this.websocketService.on("document_uploaded").pipe(_(this.destroy$)).subscribe(()=>{console.log("Document uploaded - refreshing stats"),this.refreshData()}),this.websocketService.on("activity_created").pipe(_(this.destroy$)).subscribe(t=>{console.log("New activity:",t);let e=this.recentActivities();this.recentActivities.set([t,...e].slice(0,10))})}setupFilterListeners(){this.filterForm.valueChanges.pipe(_(this.destroy$),K(500),Q()).subscribe(()=>{this.loadAllDashboardData()})}setupAutoRefresh(){this.refreshInterval$.pipe(_(this.destroy$)).subscribe(()=>{!this.loading()&&!this.initialLoading()&&(console.log("Auto-refreshing dashboard data"),this.refreshData(!0))})}buildFilters(){let t=this.filterForm.value;return{startDate:t.startDate||void 0,endDate:t.endDate||void 0,category:t.category||void 0,zone:t.zone||void 0,status:t.status||void 0}}loadCurrentUser(){let t=this.authService.getCurrentUser();t?this.currentUser.set(t):this.userService.getCurrentUser().pipe(_(this.destroy$)).subscribe({next:e=>this.currentUser.set(e),error:e=>{console.error("Error loading user:",e),this.notificationService.show("Impossible de charger les informations utilisateur","error")}})}handleError(t,e){let c=this.errorState().retryCount+1;console.error(t,e),this.loading.set(!1),this.initialLoading.set(!1),c<3?(this.errorState.set({hasError:!0,message:`${t} (Tentative ${c}/3)`,retryCount:c}),setTimeout(()=>{console.log(`Retrying... Attempt ${c+1}`),this.loadAllDashboardData()},2e3*c)):(this.errorState.set({hasError:!0,message:`${t}. Veuillez rafra\xEEchir la page.`,retryCount:c}),this.notificationService.show(t,"error"))}refreshData(t=!1){t||this.notificationService.show("Actualisation des donn\xE9es...","info"),this.loadAllDashboardData()}resetFilters(){this.filterForm.reset(),this.selectedStatus.set("all"),this.selectedZone.set("all"),this.selectedPeriod.set("30d"),this.loadAllDashboardData(),this.notificationService.show("Filtres r\xE9initialis\xE9s","success")}exportReport(t){let e=this.buildFilters();this.analyticsService.generatePdfReport(t,e).pipe(_(this.destroy$)).subscribe({next:o=>{let c=window.URL.createObjectURL(o),l=document.createElement("a");l.href=c,l.download=`dashboard_report_${new Date().toISOString().split("T")[0]}.pdf`,l.click(),window.URL.revokeObjectURL(c),this.notificationService.show("Rapport PDF t\xE9l\xE9charg\xE9 avec succ\xE8s","success")},error:o=>{console.error("Export PDF error:",o),this.exportDataAsJson()}})}exportDataAsJson(){let t={stats:this.stats(),activities:this.recentActivities(),topZones:this.topZones(),filters:this.buildFilters(),exportDate:new Date().toISOString()},e=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),o=window.URL.createObjectURL(e),c=document.createElement("a");c.href=o,c.download=`dashboard_data_${new Date().toISOString().split("T")[0]}.json`,c.click(),window.URL.revokeObjectURL(o),this.notificationService.show("Donn\xE9es export\xE9es en JSON","info")}exportRawData(){let t=this.buildFilters();this.analyticsService.exportRawData(t).pipe(_(this.destroy$)).subscribe({next:e=>{let o=window.URL.createObjectURL(e),c=document.createElement("a");c.href=o,c.download=`dashboard_data_${new Date().toISOString().split("T")[0]}.csv`,c.click(),window.URL.revokeObjectURL(o),this.notificationService.show("Donn\xE9es CSV export\xE9es avec succ\xE8s","success")},error:e=>{console.error("Export CSV error:",e),this.exportVisibleDataAsCsv()}})}exportVisibleDataAsCsv(){let t=this.stats();if(!t){this.notificationService.show("Aucune donn\xE9e \xE0 exporter","warning");return}let e=`M\xE9trique,Valeur
`;e+=`Total Parcelles,${t.totalParcels}
`,e+=`Disponibles,${t.availableParcels}
`,e+=`Occup\xE9es,${t.occupiedParcels}
`,e+=`Contest\xE9es,${t.disputedParcels}
`,e+=`R\xE9serv\xE9es,${t.reservedParcels}
`,e+=`Surface Totale,${t.totalArea}
`,e+=`Surface Moyenne,${t.averageArea}
`,e+=`Documents,${t.totalDocuments}
`;let o=new Blob([e],{type:"text/csv;charset=utf-8;"}),c=window.URL.createObjectURL(o),l=document.createElement("a");l.href=c,l.download=`dashboard_stats_${new Date().toISOString().split("T")[0]}.csv`,l.click(),window.URL.revokeObjectURL(c),this.notificationService.show("Statistiques export\xE9es en CSV","success")}navigateTo(t){this.router.navigate([t])}isAdmin(){return this.currentUser()?.role==="administrator"}getCurrentDate(){return new Date().toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}formatTimeAgo(t){let e=new Date(t),c=new Date().getTime()-e.getTime(),l=Math.floor(c/(1e3*60*60*24)),m=Math.floor(c%(1e3*60*60*24)/(1e3*60*60)),y=Math.floor(c%(1e3*60*60)/(1e3*60));return l>0?`${l}j`:m>0?`${m}h`:y>0?`${y}m`:"maintenant"}formatLargeNumber(t){return t==null?"0":t>=1e6?(t/1e6).toFixed(1)+"M":t>=1e3?(t/1e3).toFixed(1)+"K":t.toString()}formatArea(t){return t==null?"0 m\xB2":t>=1e6?(t/1e6).toFixed(2)+" km\xB2":t>=1e4?(t/1e4).toFixed(2)+" ha":t.toFixed(2)+" m\xB2"}getPercentage(t,e){return e>0?Math.round(t/e*100):0}getStatusColor(t){return{available:"#4CAF50",occupied:"#2196F3",disputed:"#FF9800",reserved:"#9C27B0",pending:"#FFC107",approved:"#8BC34A",rejected:"#F44336",completed:"#4CAF50",cancelled:"#9E9E9E"}[t]||"#607D8B"}getStatusLabel(t){return{available:"Disponible",occupied:"Occup\xE9e",disputed:"Contest\xE9e",reserved:"R\xE9serv\xE9e",pending:"En attente",approved:"Approuv\xE9e",rejected:"Rejet\xE9e",completed:"Compl\xE9t\xE9e",cancelled:"Annul\xE9e"}[t]||t}getStatIcon(t){return{totalParcels:"map",availableParcels:"check_circle",occupiedParcels:"person",disputedParcels:"warning",reservedParcels:"lock",totalArea:"square_foot",averageArea:"straighten",totalOwners:"people",totalDocuments:"folder",recentActivities:"schedule",alertsCount:"notifications"}[t]||"info"}getStatLabel(t){return{totalParcels:"Total Parcelles",availableParcels:"Disponibles",occupiedParcels:"Occup\xE9es",disputedParcels:"Contest\xE9es",reservedParcels:"R\xE9serv\xE9es",totalArea:"Surface Totale",averageArea:"Surface Moyenne",totalOwners:"Propri\xE9taires",totalDocuments:"Documents",recentActivities:"Activit\xE9s R\xE9centes",alertsCount:"Alertes"}[t]||t}getStatColor(t,e){if(e===0)return"#9e9e9e";let o=t/e*100;return o<25?"#4caf50":o<50?"#ff9800":o<75?"#f44336":"#9c27b0"}getChart(t){return this.charts().get(t)}retryLoading(){this.errorState.set({hasError:!1,message:"",retryCount:0}),this.loadAllDashboardData()}static{this.\u0275fac=function(e){return new(e||r)}}static{this.\u0275cmp=nt({type:r,selectors:[["app-dashboard"]],decls:76,vars:14,consts:[["exportMenu","matMenu"],["role","main","aria-label","Tableau de bord principal",1,"dashboard-container"],[1,"dashboard-header"],[1,"header-content"],[1,"header-text"],[1,"subtitle"],[1,"date"],[1,"connection-status"],["matTooltip","Connect\xE9 en temps r\xE9el",1,"status-indicator","connected"],["matTooltip","Connexion en cours...",1,"status-indicator","connecting"],["matTooltip","Mode hors ligne",1,"status-indicator","disconnected"],[1,"header-actions"],["mat-icon-button","","matTooltip","Actualiser les donn\xE9es","aria-label","Actualiser les donn\xE9es",3,"click","disabled"],["mat-icon-button","","matTooltip","Exporter les donn\xE9es","aria-label","Options d'exportation",3,"matMenuTriggerFor"],["mat-raised-button","","color","primary","routerLink","/parcels/new","aria-label","Cr\xE9er une nouvelle parcelle",1,"add-button"],["mat-menu-item","",3,"click"],["role","search","aria-label","Filtres du tableau de bord",1,"filters-section"],[1,"filters-form",3,"formGroup"],["appearance","outline",1,"filter-field"],["matInput","","type","date","formControlName","startDate"],["matInput","","type","date","formControlName","endDate"],["formControlName","status"],["value",""],["value","available"],["value","occupied"],["value","disputed"],["value","reserved"],["formControlName","zone"],[3,"value"],["mat-stroked-button","","type","button","aria-label","R\xE9initialiser les filtres",1,"reset-filters-btn",3,"click"],["role","alert",1,"error-card"],[1,"initial-loading"],[1,"status-icon","animate-pulse"],[1,"status-icon"],[1,"error-content"],[1,"error-icon"],[1,"error-text"],["mat-raised-button","","color","primary",3,"click"],["message","Chargement du tableau de bord..."],["aria-label","Indicateurs cl\xE9s de performance",1,"kpi-section"],[1,"section-title"],[1,"stats-grid"],["aria-label","Distribution des statuts",1,"distribution-section"],[1,"distribution-card"],[1,"distribution-grid"],[1,"distribution-item"],["aria-label","Graphiques analytiques",1,"charts-section"],[1,"charts-grid"],[1,"chart-card"],[1,"chart-card","wide"],["aria-label","Activit\xE9s r\xE9centes",1,"activity-section"],["matTooltip","Mises \xE0 jour en temps r\xE9el",1,"live-badge"],[1,"activity-card"],[1,"activity-list"],[1,"empty-state"],["mat-button","","routerLink","/audit"],["aria-label","Top zones",1,"zones-section"],["aria-label","Actions rapides",1,"actions-section"],[1,"actions-grid"],["mat-raised-button","","routerLink","/map",1,"action-button"],["mat-raised-button","","routerLink","/search",1,"action-button"],["mat-raised-button","","routerLink","/reports",1,"action-button"],["mat-raised-button","","routerLink","/admin",1,"action-button"],[1,"stat-card","primary-stat"],[1,"stat-header"],[1,"stat-icon-wrapper","primary"],[1,"stat-badge","success"],[1,"stat-body"],[1,"stat-number"],[1,"stat-label"],[1,"stat-footer"],["mat-button","","color","primary","routerLink","/parcels"],[1,"stat-card","success-stat"],[1,"stat-icon-wrapper","success"],[1,"stat-percentage"],[1,"stat-progress"],["mode","determinate","color","primary",3,"value"],[1,"stat-card","info-stat"],[1,"stat-icon-wrapper","info"],[1,"stat-card","warning-stat"],[1,"stat-icon-wrapper","warning"],[1,"stat-card","accent-stat"],[1,"stat-icon-wrapper","accent"],[1,"stat-detail"],[1,"stat-card","secondary-stat"],[1,"stat-icon-wrapper","secondary"],["mat-button","","routerLink","/documents"],["mat-button","","color","warn","routerLink","/parcels",3,"queryParams"],[1,"distribution-header"],[1,"distribution-color"],[1,"distribution-label"],[1,"distribution-value"],[1,"distribution-bar"],[1,"distribution-fill"],[1,"distribution-percentage"],[3,"series","chart","labels","colors","dataLabels","legend","tooltip"],[3,"series","chart","labels","colors","plotOptions","legend"],[3,"series","chart","xaxis","yaxis","colors","plotOptions","dataLabels"],[3,"series","chart","xaxis","yaxis","colors","stroke","fill","dataLabels"],[1,"pulse"],[1,"activity-item"],[1,"activity-icon"],[1,"activity-content"],[1,"activity-title"],[1,"activity-meta"],[1,"activity-time"],[1,"activity-parcel"],["mat-icon-button","","matTooltip","Voir d\xE9tails","aria-label","Voir d\xE9tails de la parcelle",3,"routerLink"],[1,"zones-card"],[1,"zones-list"],[1,"zone-item"],[1,"zone-rank"],[1,"zone-info"],[1,"zone-name"],[1,"zone-count"],[1,"zone-bar"],[1,"zone-fill"]],template:function(e,o){if(e&1){let c=B();i(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"h1"),a(5,"Tableau de bord"),n(),i(6,"p",5),a(7," Bienvenue, "),i(8,"strong"),a(9),n()(),i(10,"p",6),a(11),n()(),i(12,"div",7),p(13,ue,5,0,"span",8)(14,be,5,0,"span",9)(15,he,5,0,"span",10),n()(),i(16,"div",11)(17,"button",12),O("click",function(){return M(c),P(o.refreshData())}),i(18,"mat-icon"),a(19,"refresh"),n()(),i(20,"button",13)(21,"mat-icon"),a(22,"download"),n()(),p(23,fe,5,0,"button",14),n()(),i(24,"mat-menu",null,0)(26,"button",15),O("click",function(){return M(c),P(o.exportReport("dashboard"))}),i(27,"mat-icon"),a(28,"picture_as_pdf"),n(),i(29,"span"),a(30,"Exporter en PDF"),n()(),i(31,"button",15),O("click",function(){return M(c),P(o.exportRawData())}),i(32,"mat-icon"),a(33,"table_chart"),n(),i(34,"span"),a(35,"Exporter en CSV"),n()()(),i(36,"div",16)(37,"form",17)(38,"mat-form-field",18)(39,"mat-label"),a(40,"Date de d\xE9but"),n(),C(41,"input",19),n(),i(42,"mat-form-field",18)(43,"mat-label"),a(44,"Date de fin"),n(),C(45,"input",20),n(),i(46,"mat-form-field",18)(47,"mat-label"),a(48,"Statut"),n(),i(49,"mat-select",21)(50,"mat-option",22),a(51,"Tous les statuts"),n(),i(52,"mat-option",23),a(53,"Disponible"),n(),i(54,"mat-option",24),a(55,"Occup\xE9e"),n(),i(56,"mat-option",25),a(57,"Contest\xE9e"),n(),i(58,"mat-option",26),a(59,"R\xE9serv\xE9e"),n()()(),i(60,"mat-form-field",18)(61,"mat-label"),a(62,"Zone"),n(),i(63,"mat-select",27)(64,"mat-option",22),a(65,"Toutes les zones"),n(),E(66,_e,2,2,"mat-option",28,at),n()(),i(68,"button",29),O("click",function(){return M(c),P(o.resetFilters())}),i(69,"mat-icon"),a(70,"refresh"),n(),i(71,"span"),a(72,"R\xE9initialiser"),n()()()(),p(73,Ce,14,1,"mat-card",30),p(74,ve,2,0,"div",31),p(75,Ie,62,9),n()}if(e&2){let c,l,m=ot(25);s(9),st("",(c=o.currentUser())==null?null:c.first_name," ",(c=o.currentUser())==null?null:c.last_name),s(2),u(o.getCurrentDate()),s(),it("aria-label","Statut de connexion: "+o.wsConnectionStatus()),s(),g((l=o.wsConnectionStatus())==="connected"?13:l==="connecting"?14:l==="disconnected"?15:-1),s(4),f("disabled",o.loading()),s(),rt("spin",o.loading()),s(2),f("matMenuTriggerFor",m),s(3),g(o.isAdmin()?23:-1),s(14),f("formGroup",o.filterForm),s(29),D(o.availableZones()),s(7),g(o.errorState().hasError?73:-1),s(),g(o.initialLoading()?74:-1),s(),g(!o.initialLoading()&&!o.errorState().hasError?75:-1)}},dependencies:[lt,pt,xt,ft,ut,bt,ht,Ct,_t,wt,Mt,yt,Ot,St,Pt,Lt,Ft,Tt,It,$t,Rt,Gt,Ut,Vt,Bt,jt,Zt,qt,Wt,kt,Dt,Et,At,zt,Kt,Yt,Jt,Ht,Qt,Nt,te,Xt,ae,ie,oe],styles:[".dashboard-container[_ngcontent-%COMP%]{padding:24px;max-width:1600px;margin:0 auto;min-height:100vh;background:var(--background-color, #f5f5f5)}@media(max-width:768px){.dashboard-container[_ngcontent-%COMP%]{padding:16px}}.dashboard-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:32px;gap:24px;flex-wrap:wrap}.dashboard-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{flex:1;display:flex;justify-content:space-between;align-items:center;gap:24px}.dashboard-header[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:32px;font-weight:600;color:var(--primary-text, #333)}@media(max-width:768px){.dashboard-header[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px}}.dashboard-header[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{margin:8px 0 0;font-size:16px;color:var(--secondary-text, #666)}.dashboard-header[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--primary-color, #3f51b5)}.dashboard-header[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{margin:4px 0 0;font-size:14px;color:var(--tertiary-text, #999);text-transform:capitalize}.dashboard-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center}.dashboard-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]{height:42px;padding:0 24px;font-weight:500}.dashboard-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .add-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}.connection-status[_ngcontent-%COMP%]   .status-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 16px;border-radius:20px;font-size:14px;font-weight:500;transition:all .3s ease}.connection-status[_ngcontent-%COMP%]   .status-indicator.connected[_ngcontent-%COMP%]{background:#4caf501a;color:#4caf50;border:1px solid rgba(76,175,80,.3)}.connection-status[_ngcontent-%COMP%]   .status-indicator.connected[_ngcontent-%COMP%]   .status-icon[_ngcontent-%COMP%]{color:#4caf50}.connection-status[_ngcontent-%COMP%]   .status-indicator.connecting[_ngcontent-%COMP%]{background:#ff98001a;color:#ff9800;border:1px solid rgba(255,152,0,.3)}.connection-status[_ngcontent-%COMP%]   .status-indicator.connecting[_ngcontent-%COMP%]   .status-icon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_rotate 2s linear infinite}.connection-status[_ngcontent-%COMP%]   .status-indicator.disconnected[_ngcontent-%COMP%]{background:#9e9e9e1a;color:#9e9e9e;border:1px solid rgba(158,158,158,.3)}.filters-section[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:12px;margin-bottom:32px;box-shadow:0 2px 8px #00000014}.filters-section[_ngcontent-%COMP%]   .filters-form[_ngcontent-%COMP%]{display:flex;gap:16px;flex-wrap:wrap;align-items:flex-start}.filters-section[_ngcontent-%COMP%]   .filters-form[_ngcontent-%COMP%]   .filter-field[_ngcontent-%COMP%]{flex:1;min-width:200px}@media(max-width:768px){.filters-section[_ngcontent-%COMP%]   .filters-form[_ngcontent-%COMP%]   .filter-field[_ngcontent-%COMP%]{min-width:100%}}.filters-section[_ngcontent-%COMP%]   .filters-form[_ngcontent-%COMP%]   .reset-filters-btn[_ngcontent-%COMP%]{margin-top:8px;height:56px}.filters-section[_ngcontent-%COMP%]   .filters-form[_ngcontent-%COMP%]   .reset-filters-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}.error-card[_ngcontent-%COMP%]{margin-bottom:24px;background:#ffebee;border-left:4px solid #f44336}.error-card[_ngcontent-%COMP%]   .error-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.error-card[_ngcontent-%COMP%]   .error-content[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;color:#f44336}.error-card[_ngcontent-%COMP%]   .error-content[_ngcontent-%COMP%]   .error-text[_ngcontent-%COMP%]{flex:1}.error-card[_ngcontent-%COMP%]   .error-content[_ngcontent-%COMP%]   .error-text[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;color:#f44336}.error-card[_ngcontent-%COMP%]   .error-content[_ngcontent-%COMP%]   .error-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#c62828}.initial-loading[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:400px}.section-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;font-size:24px;font-weight:600;color:var(--primary-text, #333);margin-bottom:20px}.section-title[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--primary-color, #3f51b5)}.section-title[_ngcontent-%COMP%]   .live-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:4px;font-size:12px;font-weight:700;color:#f44336;background:#f443361a;padding:4px 12px;border-radius:12px;margin-left:auto}.section-title[_ngcontent-%COMP%]   .live-badge[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:12px;width:12px;height:12px}.kpi-section[_ngcontent-%COMP%]{margin-bottom:32px}.kpi-section[_ngcontent-%COMP%]   .stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px}@media(max-width:768px){.kpi-section[_ngcontent-%COMP%]   .stats-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.stat-card[_ngcontent-%COMP%]{transition:all .3s cubic-bezier(.4,0,.2,1);overflow:hidden;position:relative}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 8px 24px #00000026}.stat-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:24px}.stat-card[_ngcontent-%COMP%]   .stat-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.stat-card[_ngcontent-%COMP%]   .stat-header[_ngcontent-%COMP%]   .stat-icon-wrapper[_ngcontent-%COMP%]{width:56px;height:56px;border-radius:12px;display:flex;align-items:center;justify-content:center;transition:all .3s ease}.stat-card[_ngcontent-%COMP%]   .stat-header[_ngcontent-%COMP%]   .stat-icon-wrapper[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:32px;width:32px;height:32px}.stat-card[_ngcontent-%COMP%]   .stat-header[_ngcontent-%COMP%]   .stat-icon-wrapper.primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}.stat-card[_ngcontent-%COMP%]   .stat-header[_ngcontent-%COMP%]   .stat-icon-wrapper.success[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4caf50,#8bc34a);color:#fff}.stat-card[_ngcontent-%COMP%]   .stat-header[_ngcontent-%COMP%]   .stat-icon-wrapper.info[_ngcontent-%COMP%]{background:linear-gradient(135deg,#2196f3,#03a9f4);color:#fff}.stat-card[_ngcontent-%COMP%]   .stat-header[_ngcontent-%COMP%]   .stat-icon-wrapper.warning[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ff9800,#ffc107);color:#fff}.stat-card[_ngcontent-%COMP%]   .stat-header[_ngcontent-%COMP%]   .stat-icon-wrapper.accent[_ngcontent-%COMP%]{background:linear-gradient(135deg,#9c27b0,#e91e63);color:#fff}.stat-card[_ngcontent-%COMP%]   .stat-header[_ngcontent-%COMP%]   .stat-icon-wrapper.secondary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#607d8b,#90a4ae);color:#fff}.stat-card[_ngcontent-%COMP%]   .stat-header[_ngcontent-%COMP%]   .stat-badge[_ngcontent-%COMP%]{padding:6px 12px;border-radius:16px;font-size:12px;font-weight:600}.stat-card[_ngcontent-%COMP%]   .stat-header[_ngcontent-%COMP%]   .stat-badge.success[_ngcontent-%COMP%]{background:#4caf501a;color:#4caf50}.stat-card[_ngcontent-%COMP%]   .stat-header[_ngcontent-%COMP%]   .stat-percentage[_ngcontent-%COMP%]{font-size:18px;font-weight:700;color:var(--primary-color, #3f51b5)}.stat-card[_ngcontent-%COMP%]   .stat-body[_ngcontent-%COMP%]{margin-bottom:16px}.stat-card[_ngcontent-%COMP%]   .stat-body[_ngcontent-%COMP%]   .stat-number[_ngcontent-%COMP%]{font-size:36px;font-weight:700;margin:0 0 8px;color:var(--primary-text, #333);line-height:1}.stat-card[_ngcontent-%COMP%]   .stat-body[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{font-size:14px;color:var(--secondary-text, #666);margin:0;text-transform:uppercase;letter-spacing:.5px}.stat-card[_ngcontent-%COMP%]   .stat-footer[_ngcontent-%COMP%]{padding-top:12px;border-top:1px solid rgba(0,0,0,.08)}.stat-card[_ngcontent-%COMP%]   .stat-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;justify-content:space-between}.stat-card[_ngcontent-%COMP%]   .stat-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-left:8px}.stat-card[_ngcontent-%COMP%]   .stat-detail[_ngcontent-%COMP%]{padding-top:8px}.stat-card[_ngcontent-%COMP%]   .stat-detail[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:var(--secondary-text, #666);font-size:13px}.stat-card[_ngcontent-%COMP%]   .stat-progress[_ngcontent-%COMP%]{margin-top:12px}.distribution-section[_ngcontent-%COMP%]{margin-bottom:32px}.distribution-section[_ngcontent-%COMP%]   .distribution-card[_ngcontent-%COMP%]   .distribution-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:24px}@media(max-width:768px){.distribution-section[_ngcontent-%COMP%]   .distribution-card[_ngcontent-%COMP%]   .distribution-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.distribution-section[_ngcontent-%COMP%]   .distribution-card[_ngcontent-%COMP%]   .distribution-item[_ngcontent-%COMP%]{padding:16px;border-radius:8px;background:var(--background-light, #fafafa);transition:all .3s ease}.distribution-section[_ngcontent-%COMP%]   .distribution-card[_ngcontent-%COMP%]   .distribution-item[_ngcontent-%COMP%]:hover{background:var(--background-hover, #f0f0f0);transform:scale(1.02)}.distribution-section[_ngcontent-%COMP%]   .distribution-card[_ngcontent-%COMP%]   .distribution-item[_ngcontent-%COMP%]   .distribution-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:12px}.distribution-section[_ngcontent-%COMP%]   .distribution-card[_ngcontent-%COMP%]   .distribution-item[_ngcontent-%COMP%]   .distribution-header[_ngcontent-%COMP%]   .distribution-color[_ngcontent-%COMP%]{width:16px;height:16px;border-radius:4px}.distribution-section[_ngcontent-%COMP%]   .distribution-card[_ngcontent-%COMP%]   .distribution-item[_ngcontent-%COMP%]   .distribution-header[_ngcontent-%COMP%]   .distribution-label[_ngcontent-%COMP%]{font-weight:500;color:var(--primary-text, #333)}.distribution-section[_ngcontent-%COMP%]   .distribution-card[_ngcontent-%COMP%]   .distribution-item[_ngcontent-%COMP%]   .distribution-value[_ngcontent-%COMP%]{font-size:28px;font-weight:700;margin-bottom:12px;color:var(--primary-text, #333)}.distribution-section[_ngcontent-%COMP%]   .distribution-card[_ngcontent-%COMP%]   .distribution-item[_ngcontent-%COMP%]   .distribution-bar[_ngcontent-%COMP%]{height:8px;background:#00000014;border-radius:4px;overflow:hidden;margin-bottom:8px}.distribution-section[_ngcontent-%COMP%]   .distribution-card[_ngcontent-%COMP%]   .distribution-item[_ngcontent-%COMP%]   .distribution-bar[_ngcontent-%COMP%]   .distribution-fill[_ngcontent-%COMP%]{height:100%;border-radius:4px;transition:width .5s cubic-bezier(.4,0,.2,1)}.distribution-section[_ngcontent-%COMP%]   .distribution-card[_ngcontent-%COMP%]   .distribution-item[_ngcontent-%COMP%]   .distribution-percentage[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:var(--secondary-text, #666)}.charts-section[_ngcontent-%COMP%]{margin-bottom:32px}.charts-section[_ngcontent-%COMP%]   .charts-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:24px}@media(max-width:1024px){.charts-section[_ngcontent-%COMP%]   .charts-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.charts-section[_ngcontent-%COMP%]   .charts-grid[_ngcontent-%COMP%]   .chart-card[_ngcontent-%COMP%]{transition:all .3s ease}.charts-section[_ngcontent-%COMP%]   .charts-grid[_ngcontent-%COMP%]   .chart-card[_ngcontent-%COMP%]:hover{box-shadow:0 8px 24px #0000001f}.charts-section[_ngcontent-%COMP%]   .charts-grid[_ngcontent-%COMP%]   .chart-card.wide[_ngcontent-%COMP%]{grid-column:span 2}@media(max-width:1024px){.charts-section[_ngcontent-%COMP%]   .charts-grid[_ngcontent-%COMP%]   .chart-card.wide[_ngcontent-%COMP%]{grid-column:span 1}}.charts-section[_ngcontent-%COMP%]   .charts-grid[_ngcontent-%COMP%]   .chart-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{padding:20px 20px 0}.charts-section[_ngcontent-%COMP%]   .charts-grid[_ngcontent-%COMP%]   .chart-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:var(--primary-text, #333)}.charts-section[_ngcontent-%COMP%]   .charts-grid[_ngcontent-%COMP%]   .chart-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:20px}.activity-section[_ngcontent-%COMP%]{margin-bottom:32px}.activity-section[_ngcontent-%COMP%]   .activity-card[_ngcontent-%COMP%]   .activity-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.activity-section[_ngcontent-%COMP%]   .activity-card[_ngcontent-%COMP%]   .activity-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:16px;border-radius:8px;background:var(--background-light, #fafafa);transition:all .3s ease}.activity-section[_ngcontent-%COMP%]   .activity-card[_ngcontent-%COMP%]   .activity-item[_ngcontent-%COMP%]:hover{background:var(--background-hover, #f0f0f0);transform:translate(4px)}.activity-section[_ngcontent-%COMP%]   .activity-card[_ngcontent-%COMP%]   .activity-item[_ngcontent-%COMP%]   .activity-icon[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:var(--primary-color, #3f51b5);color:#fff;display:flex;align-items:center;justify-content:center;flex-shrink:0}.activity-section[_ngcontent-%COMP%]   .activity-card[_ngcontent-%COMP%]   .activity-item[_ngcontent-%COMP%]   .activity-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.activity-section[_ngcontent-%COMP%]   .activity-card[_ngcontent-%COMP%]   .activity-item[_ngcontent-%COMP%]   .activity-content[_ngcontent-%COMP%]{flex:1;min-width:0}.activity-section[_ngcontent-%COMP%]   .activity-card[_ngcontent-%COMP%]   .activity-item[_ngcontent-%COMP%]   .activity-content[_ngcontent-%COMP%]   .activity-title[_ngcontent-%COMP%]{font-weight:500;color:var(--primary-text, #333);margin-bottom:4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.activity-section[_ngcontent-%COMP%]   .activity-card[_ngcontent-%COMP%]   .activity-item[_ngcontent-%COMP%]   .activity-content[_ngcontent-%COMP%]   .activity-meta[_ngcontent-%COMP%]{display:flex;gap:12px;font-size:13px;color:var(--secondary-text, #666)}.activity-section[_ngcontent-%COMP%]   .activity-card[_ngcontent-%COMP%]   .activity-item[_ngcontent-%COMP%]   .activity-content[_ngcontent-%COMP%]   .activity-meta[_ngcontent-%COMP%]   .activity-time[_ngcontent-%COMP%]{font-weight:500}.activity-section[_ngcontent-%COMP%]   .activity-card[_ngcontent-%COMP%]   .activity-item[_ngcontent-%COMP%]   .activity-content[_ngcontent-%COMP%]   .activity-meta[_ngcontent-%COMP%]   .activity-parcel[_ngcontent-%COMP%]{color:var(--primary-color, #3f51b5)}.activity-section[_ngcontent-%COMP%]   .activity-card[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{text-align:center;padding:48px 24px;color:var(--secondary-text, #666)}.activity-section[_ngcontent-%COMP%]   .activity-card[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;opacity:.3;margin-bottom:16px}.activity-section[_ngcontent-%COMP%]   .activity-card[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:16px}.zones-section[_ngcontent-%COMP%]{margin-bottom:32px}.zones-section[_ngcontent-%COMP%]   .zones-card[_ngcontent-%COMP%]   .zones-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.zones-section[_ngcontent-%COMP%]   .zones-card[_ngcontent-%COMP%]   .zone-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:16px;border-radius:8px;background:var(--background-light, #fafafa);transition:all .3s ease}.zones-section[_ngcontent-%COMP%]   .zones-card[_ngcontent-%COMP%]   .zone-item[_ngcontent-%COMP%]:hover{background:var(--background-hover, #f0f0f0)}.zones-section[_ngcontent-%COMP%]   .zones-card[_ngcontent-%COMP%]   .zone-item[_ngcontent-%COMP%]   .zone-rank[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;background:var(--primary-color, #3f51b5);color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:14px;flex-shrink:0}.zones-section[_ngcontent-%COMP%]   .zones-card[_ngcontent-%COMP%]   .zone-item[_ngcontent-%COMP%]   .zone-info[_ngcontent-%COMP%]{flex:0 0 200px}.zones-section[_ngcontent-%COMP%]   .zones-card[_ngcontent-%COMP%]   .zone-item[_ngcontent-%COMP%]   .zone-info[_ngcontent-%COMP%]   .zone-name[_ngcontent-%COMP%]{font-weight:600;color:var(--primary-text, #333);margin-bottom:4px}.zones-section[_ngcontent-%COMP%]   .zones-card[_ngcontent-%COMP%]   .zone-item[_ngcontent-%COMP%]   .zone-info[_ngcontent-%COMP%]   .zone-count[_ngcontent-%COMP%]{font-size:13px;color:var(--secondary-text, #666)}.zones-section[_ngcontent-%COMP%]   .zones-card[_ngcontent-%COMP%]   .zone-item[_ngcontent-%COMP%]   .zone-bar[_ngcontent-%COMP%]{flex:1;height:8px;background:#00000014;border-radius:4px;overflow:hidden}.zones-section[_ngcontent-%COMP%]   .zones-card[_ngcontent-%COMP%]   .zone-item[_ngcontent-%COMP%]   .zone-bar[_ngcontent-%COMP%]   .zone-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,var(--primary-color, #3f51b5),var(--accent-color, #ff4081));border-radius:4px;transition:width .5s cubic-bezier(.4,0,.2,1)}.actions-section[_ngcontent-%COMP%]{margin-bottom:32px}.actions-section[_ngcontent-%COMP%]   .actions-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px}.actions-section[_ngcontent-%COMP%]   .actions-grid[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]{height:80px;display:flex;flex-direction:column;gap:8px;font-weight:500;transition:all .3s ease}.actions-section[_ngcontent-%COMP%]   .actions-grid[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #00000026}.actions-section[_ngcontent-%COMP%]   .actions-grid[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:32px;width:32px;height:32px}.actions-section[_ngcontent-%COMP%]   .actions-grid[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px}@keyframes _ngcontent-%COMP%_rotate{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.5}}.animate-pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 2s cubic-bezier(.4,0,.6,1) infinite}.pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 1.5s ease-in-out infinite}.spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_rotate 1s linear infinite}@media(prefers-reduced-motion:reduce){*[_ngcontent-%COMP%]{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important}}@media print{.dashboard-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%], .filters-section[_ngcontent-%COMP%], .actions-section[_ngcontent-%COMP%]{display:none}.stat-card[_ngcontent-%COMP%], .chart-card[_ngcontent-%COMP%]{break-inside:avoid}}"],changeDetection:0})}};export{se as DashboardComponent};
