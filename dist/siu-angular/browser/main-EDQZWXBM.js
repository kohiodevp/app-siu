import{a as u}from"./chunk-KSJ6ZHDJ.js";import{a as oe}from"./chunk-PY62MJCA.js";import"./chunk-FJY5KO7T.js";import"./chunk-L64YGAYQ.js";import{a as M}from"./chunk-IE4XPFBV.js";import"./chunk-ZNVG5ZVS.js";import{b as re,c as I,f as ne}from"./chunk-LMV7XNWS.js";import"./chunk-FBCHPQNP.js";import{A as p,s as Q,t as q,w as ee,x as te}from"./chunk-YGREV7VD.js";import{$ as S,$a as $,B as W,E as f,Ga as H,Lb as X,Lc as J,R as b,V as d,W as V,Y as m,aa as N,ba as a,c as C,ca as A,db as z,e as w,gb as K,ka as O,la as B,lb as Z,m as x,p as g,pa as T,ta as G,xb as Y,y as h,z as _,zb as F}from"./chunk-E7AQ6X4Y.js";import{a as j}from"./chunk-EQDQRRRY.js";var me="@",fe=(()=>{class r{doc;delegate;zone;animationType;moduleImpl;_rendererFactoryPromise=null;scheduler=null;injector=a(O);loadingSchedulerFn=a(ve,{optional:!0});_engine;constructor(e,n,o,i,s){this.doc=e,this.delegate=n,this.zone=o,this.animationType=i,this.moduleImpl=s}ngOnDestroy(){this._engine?.flush()}loadImpl(){let e=()=>this.moduleImpl??import("./chunk-B4CAXBEG.js").then(o=>o),n;return this.loadingSchedulerFn?n=this.loadingSchedulerFn(e):n=e(),n.catch(o=>{throw new d(5300,!1)}).then(({\u0275createEngine:o,\u0275AnimationRendererFactory:i})=>{this._engine=o(this.animationType,this.doc);let s=new i(this.delegate,this._engine,this.zone);return this.delegate=s,s})}createRenderer(e,n){let o=this.delegate.createRenderer(e,n);if(o.\u0275type===0)return o;typeof o.throwOnSyntheticProps=="boolean"&&(o.throwOnSyntheticProps=!1);let i=new P(o);return n?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(s=>{let c=s.createRenderer(e,n);i.use(c),this.scheduler??=this.injector.get(G,null,{optional:!0}),this.scheduler?.notify(10)}).catch(s=>{i.use(o)}),i}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}componentReplaced(e){this._engine?.flush(),this.delegate.componentReplaced?.(e)}static \u0275fac=function(n){K()};static \u0275prov=m({token:r,factory:r.\u0275fac})}return r})(),P=class{delegate;replay=[];\u0275type=1;constructor(t){this.delegate=t}use(t){if(this.delegate=t,this.replay!==null){for(let e of this.replay)e(t);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}get destroyNode(){return this.delegate.destroyNode}appendChild(t,e){this.delegate.appendChild(t,e)}insertBefore(t,e,n,o){this.delegate.insertBefore(t,e,n,o)}removeChild(t,e,n,o){this.delegate.removeChild(t,e,n,o)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,n,o){this.delegate.setAttribute(t,e,n,o)}removeAttribute(t,e,n){this.delegate.removeAttribute(t,e,n)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,n,o){this.delegate.setStyle(t,e,n,o)}removeStyle(t,e,n){this.delegate.removeStyle(t,e,n)}setProperty(t,e,n){this.shouldReplay(e)&&this.replay.push(o=>o.setProperty(t,e,n)),this.delegate.setProperty(t,e,n)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,n,o){return this.shouldReplay(e)&&this.replay.push(i=>i.listen(t,e,n,o)),this.delegate.listen(t,e,n,o)}shouldReplay(t){return this.replay!==null&&t.startsWith(me)}},ve=new S("");function ie(r="animations"){return $("NgAsyncAnimations"),A([{provide:z,useFactory:()=>new fe(a(B),a(Q),a(T),r)},{provide:H,useValue:r==="noop"?"NoopAnimations":"BrowserAnimations"}])}var se=()=>{let r=a(M),t=a(I);return r.isAuthenticated()&&r.isTokenValid()?!0:(t.navigate(["/login"]),!1)};var ae=[{path:"",redirectTo:"/dashboard",pathMatch:"full"},{path:"login",loadComponent:()=>import("./chunk-CV62PXL2.js").then(r=>r.LoginComponent)},{path:"register",loadComponent:()=>import("./chunk-ZX7FFNRS.js").then(r=>r.RegisterComponent)},{path:"",loadComponent:()=>import("./chunk-3EGQBMJO.js").then(r=>r.MainLayoutComponent),canActivate:[se],children:[{path:"dashboard",loadComponent:()=>import("./chunk-LYWS3EQM.js").then(r=>r.DashboardComponent)},{path:"parcels",loadChildren:()=>import("./chunk-2YXPGKP6.js").then(r=>r.PARCEL_ROUTES)},{path:"map",loadChildren:()=>import("./chunk-FWCPX4QV.js").then(r=>r.MAP_ROUTES)},{path:"documents",loadChildren:()=>import("./chunk-5MLLNZB4.js").then(r=>r.DOCUMENT_ROUTES)},{path:"search",loadComponent:()=>import("./chunk-EE2HNWMR.js").then(r=>r.SearchComponent)},{path:"profile",loadComponent:()=>import("./chunk-3PX7F27W.js").then(r=>r.ProfileComponent)},{path:"settings",loadComponent:()=>import("./chunk-6WEONDX6.js").then(r=>r.SettingsComponent)},{path:"reports",loadChildren:()=>import("./chunk-AS3FNOMA.js").then(r=>r.REPORT_ROUTES),canActivate:[u]},{path:"users",loadChildren:()=>import("./chunk-3UEZSA3G.js").then(r=>r.USER_ROUTES),canActivate:[u]},{path:"import",loadComponent:()=>import("./chunk-BEFSL7UU.js").then(r=>r.ImportGeospatialComponent),canActivate:[u]},{path:"analytics",loadChildren:()=>import("./chunk-5HDX4MU7.js").then(r=>r.ANALYTICS_ROUTES),canActivate:[u]},{path:"monitoring",loadChildren:()=>import("./chunk-AOZPS5RL.js").then(r=>r.MONITORING_ROUTES),canActivate:[u]},{path:"audit",loadChildren:()=>import("./chunk-EE3OZHXG.js").then(r=>r.AUDIT_ROUTES),canActivate:[u]},{path:"admin",loadChildren:()=>import("./chunk-CQALS4LV.js").then(r=>r.ADMIN_ROUTES),canActivate:[u]},{path:"mutations",loadChildren:()=>import("./chunk-4NSCISVX.js").then(r=>r.MUTATION_ROUTES),canActivate:[u]}]},{path:"**",redirectTo:"/dashboard"}];var ce=(r,t)=>{let n=a(M).getToken();if(r.url.includes("/api/auth/login")||r.url.includes("/api/auth/register"))return t(r);if(n){let o=r.clone({setHeaders:{Authorization:`Bearer ${n}`}});return t(o)}return t(r)};var pe=(i=>(i[i.DEBUG=0]="DEBUG",i[i.INFO=1]="INFO",i[i.WARN=2]="WARN",i[i.ERROR=3]="ERROR",i[i.FATAL=4]="FATAL",i))(pe||{}),D=class r{constructor(){this.enableLogging=!p.production;this.logLevel=p.production?3:0}debug(t,...e){this.log(0,t,e)}info(t,...e){this.log(1,t,e)}warn(t,...e){this.log(2,t,e)}error(t,e,...n){this.log(3,t,[e,...n]),p.production&&p.errorReporting?.enabled&&this.reportError(t,e)}fatal(t,e,...n){this.log(4,t,[e,...n]),p.production&&p.errorReporting?.enabled&&this.reportError(t,e,!0)}logEvent(t,e){this.enableLogging&&console.log(`\u{1F4CA} Event: ${t}`,e),p.production&&p.analytics?.enabled&&this.trackEvent(t,e)}log(t,e,n){if(!this.enableLogging||t<this.logLevel)return;let o=new Date().toISOString(),i=pe[t],s=this.getPrefix(t),c=`[${o}] ${s} ${e}`;switch(t){case 0:console.debug(c,...n);break;case 1:console.info(c,...n);break;case 2:console.warn(c,...n);break;case 3:case 4:console.error(c,...n);break}}getPrefix(t){return{0:"\u{1F50D}",1:"\u2139\uFE0F",2:"\u26A0\uFE0F",3:"\u274C",4:"\u{1F480}"}[t]||"\u{1F4DD}"}reportError(t,e,n=!1){let o={message:t,error:e?.message||e,stack:e?.stack,timestamp:new Date().toISOString(),userAgent:navigator.userAgent,url:window.location.href,isFatal:n};p.production||(console.group("\u{1F4E4} Error Report"),console.table(o),console.groupEnd())}trackEvent(t,e){let n={name:t,properties:e,timestamp:new Date().toISOString(),url:window.location.href};p.production||console.log("\u{1F4CA} Analytics Event:",n)}static{this.\u0275fac=function(e){return new(e||r)}}static{this.\u0275prov=m({token:r,factory:r.\u0275fac,providedIn:"root"})}};var le=(r,t)=>{let e=a(I),n=a(oe),o=a(D);return t(r).pipe(W(i=>{let s="Une erreur est survenue";if(o.error(`HTTP Error: ${i.status} - ${r.url}`,i),i.error instanceof ErrorEvent)s=`Erreur: ${i.error.message}`;else switch(i.status){case 0:s="Impossible de contacter le serveur. V\xE9rifiez votre connexion.";break;case 400:s=i.error?.detail||"Requ\xEAte invalide";break;case 401:s="Session expir\xE9e. Veuillez vous reconnecter.",e.navigate(["/login"]);break;case 403:s="Acc\xE8s refus\xE9. Vous n'avez pas les permissions n\xE9cessaires.";break;case 404:s=i.error?.detail||"Ressource non trouv\xE9e";break;case 409:s=i.error?.detail||"Conflit: la ressource existe d\xE9j\xE0";break;case 422:s=i.error?.detail||"Donn\xE9es invalides";break;case 500:s="Erreur serveur interne. Veuillez r\xE9essayer plus tard.";break;case 503:s="Service temporairement indisponible";break;default:s=i.error?.detail||`Erreur ${i.status}: ${i.statusText}`}return i.status!==401&&n.error(s),x(()=>i)}))};var U="Service workers are disabled or not supported by this browser",v=class{serviceWorker;worker;registration;events;constructor(t,e){if(this.serviceWorker=t,!t)this.worker=this.events=this.registration=new C(n=>n.error(new d(5601,!1)));else{let n=null,o=new w;this.worker=new C(l=>(n!==null&&l.next(n),o.subscribe(R=>l.next(R))));let i=()=>{let{controller:l}=t;l!==null&&(n=l,o.next(n))};t.addEventListener("controllerchange",i),i(),this.registration=this.worker.pipe(b(()=>t.getRegistration().then(l=>{if(!l)throw new d(5601,!1);return l})));let s=new w;this.events=s.asObservable();let c=l=>{let{data:R}=l;R?.type&&s.next(R)};t.addEventListener("message",c),e?.get(F,null,{optional:!0})?.onDestroy(()=>{t.removeEventListener("controllerchange",i),t.removeEventListener("message",c)})}}postMessage(t,e){return new Promise(n=>{this.worker.pipe(f(1)).subscribe(o=>{o.postMessage(j({action:t},e)),n()})})}postMessageWithOperation(t,e,n){let o=this.waitForOperationCompleted(n),i=this.postMessage(t,e);return Promise.all([i,o]).then(([,s])=>s)}generateNonce(){return Math.round(Math.random()*1e7)}eventsOfType(t){let e;return typeof t=="string"?e=n=>n.type===t:e=n=>t.includes(n.type),this.events.pipe(_(e))}nextEventOfType(t){return this.eventsOfType(t).pipe(f(1))}waitForOperationCompleted(t){return new Promise((e,n)=>{this.eventsOfType("OPERATION_COMPLETED").pipe(_(o=>o.nonce===t),f(1),g(o=>{if(o.result!==void 0)return o.result;throw new Error(o.error)})).subscribe({next:e,error:n})})}get isEnabled(){return!!this.serviceWorker}},ye=(()=>{class r{sw;messages;notificationClicks;notificationCloses;pushSubscriptionChanges;subscription;get isEnabled(){return this.sw.isEnabled}pushManager=null;subscriptionChanges=new w;constructor(e){if(this.sw=e,!e.isEnabled){this.messages=h,this.notificationClicks=h,this.notificationCloses=h,this.pushSubscriptionChanges=h,this.subscription=h;return}this.messages=this.sw.eventsOfType("PUSH").pipe(g(o=>o.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(g(o=>o.data)),this.notificationCloses=this.sw.eventsOfType("NOTIFICATION_CLOSE").pipe(g(o=>o.data)),this.pushSubscriptionChanges=this.sw.eventsOfType("PUSH_SUBSCRIPTION_CHANGE").pipe(g(o=>o.data)),this.pushManager=this.sw.registration.pipe(g(o=>o.pushManager));let n=this.pushManager.pipe(b(o=>o.getSubscription()));this.subscription=new C(o=>{let i=n.subscribe(o),s=this.subscriptionChanges.subscribe(o);return()=>{i.unsubscribe(),s.unsubscribe()}})}requestSubscription(e){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(U));let n={userVisibleOnly:!0},o=this.decodeBase64(e.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),i=new Uint8Array(new ArrayBuffer(o.length));for(let s=0;s<o.length;s++)i[s]=o.charCodeAt(s);return n.applicationServerKey=i,new Promise((s,c)=>{this.pushManager.pipe(b(y=>y.subscribe(n)),f(1)).subscribe({next:y=>{this.subscriptionChanges.next(y),s(y)},error:c})})}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(U));let e=n=>{if(n===null)throw new d(5602,!1);return n.unsubscribe().then(o=>{if(!o)throw new d(5603,!1);this.subscriptionChanges.next(null)})};return new Promise((n,o)=>{this.subscription.pipe(f(1),b(e)).subscribe({next:n,error:o})})}decodeBase64(e){return atob(e)}static \u0275fac=function(n){return new(n||r)(N(v))};static \u0275prov=m({token:r,factory:r.\u0275fac})}return r})(),be=(()=>{class r{sw;versionUpdates;unrecoverable;get isEnabled(){return this.sw.isEnabled}ongoingCheckForUpdate=null;constructor(e){if(this.sw=e,!e.isEnabled){this.versionUpdates=h,this.unrecoverable=h;return}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(U));if(this.ongoingCheckForUpdate)return this.ongoingCheckForUpdate;let e=this.sw.generateNonce();return this.ongoingCheckForUpdate=this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:e},e).finally(()=>{this.ongoingCheckForUpdate=null}),this.ongoingCheckForUpdate}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new d(5601,!1));let e=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:e},e)}static \u0275fac=function(n){return new(n||r)(N(v))};static \u0275prov=m({token:r,factory:r.\u0275fac})}return r})(),ue=new S("");function Ee(){let r=a(E);if(!("serviceWorker"in navigator&&r.enabled!==!1))return;let t=a(ue),e=a(T),n=a(F);e.runOutsideAngular(()=>{let o=navigator.serviceWorker,i=()=>o.controller?.postMessage({action:"INITIALIZE"});o.addEventListener("controllerchange",i),n.onDestroy(()=>{o.removeEventListener("controllerchange",i)})}),e.runOutsideAngular(()=>{let o,{registrationStrategy:i}=r;if(typeof i=="function")o=new Promise(s=>i().subscribe(()=>s()));else{let[s,...c]=(i||"registerWhenStable:30000").split(":");switch(s){case"registerImmediately":o=Promise.resolve();break;case"registerWithDelay":o=de(+c[0]||0);break;case"registerWhenStable":o=Promise.race([n.whenStable(),de(+c[0])]);break;default:throw new d(5600,!1)}}o.then(()=>{n.destroyed||navigator.serviceWorker.register(t,{scope:r.scope,updateViaCache:r.updateViaCache,type:r.type}).catch(s=>console.error(V(5604,!1)))})})}function de(r){return new Promise(t=>setTimeout(t,r))}function Re(){let r=a(E),t=a(O),e=!0;return new v(e&&r.enabled!==!1?navigator.serviceWorker:void 0,t)}var E=class{enabled;updateViaCache;type;scope;registrationStrategy};function he(r,t={}){return A([ye,be,{provide:ue,useValue:r},{provide:E,useValue:t},{provide:v,useFactory:Re},Y(Ee)])}var ge={providers:[J({eventCoalescing:!0}),ne(ae),ee(te([ce,le])),ie(),he("ngsw-worker.js",{enabled:!1,registrationStrategy:"registerWhenStable:30000"})]};var k=class r{static{this.\u0275fac=function(e){return new(e||r)}}static{this.\u0275cmp=Z({type:r,selectors:[["app-root"]],decls:1,vars:0,template:function(e,n){e&1&&X(0,"router-outlet")},dependencies:[re],styles:["[_nghost-%COMP%]{display:block;height:100%}"]})}};q(k,ge).catch(r=>console.error(r));
